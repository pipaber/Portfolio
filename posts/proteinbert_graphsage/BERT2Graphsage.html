<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-03-06">

<title>Portfolio - Predict Protein-Protein Interactions with GraphSAGE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../piero.jpg" rel="icon" type="image/jpeg">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Data Science Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../bioinformatics.html"> 
<span class="menu-text">Bioinformatics Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html"> 
<span class="menu-text">Resume</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pipaber"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/pieropalaciosbernuy/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Predict Protein-Protein Interactions with GraphSAGE</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 6, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#creating-and-loading-the-unfolded-protein-binding-dataset" id="toc-creating-and-loading-the-unfolded-protein-binding-dataset" class="nav-link active" data-scroll-target="#creating-and-loading-the-unfolded-protein-binding-dataset">Creating and Loading the Unfolded Protein Binding Dataset</a></li>
  <li><a href="#spliting-the-data" id="toc-spliting-the-data" class="nav-link" data-scroll-target="#spliting-the-data">Spliting the Data</a></li>
  <li><a href="#define-device" id="toc-define-device" class="nav-link" data-scroll-target="#define-device">Define Device</a></li>
  <li><a href="#graph-neural-network" id="toc-graph-neural-network" class="nav-link" data-scroll-target="#graph-neural-network">Graph Neural Network</a>
  <ul class="collapse">
  <li><a href="#gnnstack" id="toc-gnnstack" class="nav-link" data-scroll-target="#gnnstack">GNNStack</a></li>
  <li><a href="#linkpredictionhead" id="toc-linkpredictionhead" class="nav-link" data-scroll-target="#linkpredictionhead">LinkPredictionHead</a></li>
  </ul></li>
  <li><a href="#training-function" id="toc-training-function" class="nav-link" data-scroll-target="#training-function">Training Function</a></li>
  <li><a href="#testing-function" id="toc-testing-function" class="nav-link" data-scroll-target="#testing-function">Testing Function</a></li>
  <li><a href="#training-the-model" id="toc-training-the-model" class="nav-link" data-scroll-target="#training-the-model">Training the Model</a></li>
  <li><a href="#evaluate-diferent-ppi-percentages" id="toc-evaluate-diferent-ppi-percentages" class="nav-link" data-scroll-target="#evaluate-diferent-ppi-percentages">Evaluate Diferent PPI Percentages</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div id="cell-1" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm.notebook <span class="im">import</span> tqdm, trange</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> model_selection, metrics, preprocessing</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> ConfusionMatrixDisplay</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch <span class="im">import</span> nn, optim, Tensor</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_sparse <span class="im">import</span> SparseTensor, matmul, set_diag</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.utils <span class="im">import</span> negative_sampling</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.data <span class="im">import</span> Dataset, download_url, extract_zip, Data</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.loader <span class="im">import</span> DataLoader</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.nn.conv.gcn_conv <span class="im">import</span> gcn_norm</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.nn.conv <span class="im">import</span> MessagePassing</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.typing <span class="im">import</span> (OptPairTensor, Adj, Size, NoneType, OptTensor)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch_geometric.nn <span class="im">as</span> pyg_nn</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch_geometric.utils <span class="im">as</span> pyg_utils</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.utils <span class="im">import</span> remove_self_loops, add_self_loops, softmax</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch_scatter</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os.path <span class="im">as</span> osp</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> proteinbert <span class="im">import</span> load_pretrained_model</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> proteinbert.conv_and_global_attention_model <span class="im">import</span> get_model_with_hidden_layers_as_outputs</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This is the second of a <em>Protein Embedding with ProteinBERT and STRING</em>. On this part, we are gonna build a graph neural network (GNN) to update the embeddings of PorteinBERT with the information about the STRING network.</p>
<p>We will keep using the <strong>Unfolded protein binding</strong> (GO:0051082) ontology which belongs to the heat shock response. As before, the reason is because this was a gene set that appears significant on my thesis (Functional analysis of transcriptomes of <em>Coffea arabica</em> L. related to thermal stress) and because I don’t have much power on my laptop.</p>
<section id="creating-and-loading-the-unfolded-protein-binding-dataset" class="level2">
<h2 class="anchored" data-anchor-id="creating-and-loading-the-unfolded-protein-binding-dataset">Creating and Loading the Unfolded Protein Binding Dataset</h2>
<p>Before creating the neural network, we need data. So, for this I downloaded 60 plant species as zip files from STRING database. The reason I chooosed only plants, is because the heat shock proteins on plants are compartmentalized. This means, that there are specific heat shock proteins for the chloroplat, nucleus, mitocondria, plastids and cytoplasm. Using only plants in this case will result in a better training for this small part of the metabolism.</p>
<p>Other important thing to mention is that due to the size of the plants networks and the capacities of my laptop, I’m only using the <strong>Unfolded protein binding</strong> for these 60 species. If you have enough computing resources, you can try using the complete network from all these 60 species to train a robust model.</p>
<p>Great! Once downloaded the data, we need to create a dataset that pytorch geometric can use. For this, we need to use the <a href="https://pytorch-geometric.readthedocs.io/en/latest/tutorial/create_dataset.html#creating-graph-datasets">Dataset</a> object from pytorch geometric.</p>
<p>See the code below:</p>
<div id="cell-6" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> UnfoldedProteinBinding(Dataset):</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, root, transform<span class="op">=</span><span class="va">None</span>, pre_transform<span class="op">=</span><span class="va">None</span>, pre_filter<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.batch_size <span class="op">=</span> <span class="dv">2</span> <span class="co"># adapt it according to your ram and gpu memmory</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(UnfoldedProteinBinding, <span class="va">self</span>).<span class="fu">__init__</span>(root, transform, pre_transform, pre_filter)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> raw_file_names(<span class="va">self</span>):</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>._get_zip_files()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_zip_files(<span class="va">self</span>):</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        files <span class="op">=</span> os.listdir(<span class="va">self</span>.raw_dir)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        zip_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> files <span class="cf">if</span> f.endswith(<span class="st">".zip"</span>)]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> zip_files</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> processed_file_names(<span class="va">self</span>):</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        num_zip_files <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.raw_file_names)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="ss">f"data_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.pt"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_zip_files)]</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> download(<span class="va">self</span>):</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Download to `self.raw_dir`.</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process(<span class="va">self</span>):</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># gpu device only on linux system</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        gpus <span class="op">=</span> tf.config.experimental.list_physical_devices(<span class="st">'GPU'</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(gpus) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> gpu <span class="kw">in</span> gpus:</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                    tf.config.experimental.set_memory_growth(gpu, <span class="va">True</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">RuntimeError</span> <span class="im">as</span> e:</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(e)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Not gpus available"</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> os.name <span class="op">==</span> <span class="st">"nt"</span>:</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Not gpus detected because you are using Windows system, Device: CPU"</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># check that we already processed the files</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(os.listdir(<span class="va">self</span>.processed_dir)) <span class="op">==</span> <span class="bu">len</span>(<span class="va">self</span>.raw_file_names)<span class="op">+</span><span class="dv">2</span>:</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> species <span class="kw">in</span> <span class="va">self</span>.raw_paths:</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(species)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>                <span class="co"># reading interactions from tsv file</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> zipfile.ZipFile(species, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>                    file_names <span class="op">=</span> z.namelist()</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>                    tsv_files <span class="op">=</span> [<span class="bu">file</span> <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> file_names <span class="cf">if</span> <span class="bu">file</span>.endswith(<span class="st">'interactions.tsv'</span>)]</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> tsv_file <span class="kw">in</span> tsv_files:</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">with</span> z.<span class="bu">open</span>(tsv_file) <span class="im">as</span> f:</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>                            df <span class="op">=</span> pd.read_csv(f, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>                <span class="co"># reading fasta file</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> zipfile.ZipFile(species, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>                    file_names <span class="op">=</span> z.namelist()</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>                    tsv_files <span class="op">=</span> [<span class="bu">file</span> <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> file_names <span class="cf">if</span> <span class="bu">file</span>.endswith(<span class="st">'protein_sequences.fa'</span>)]</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> tsv_file <span class="kw">in</span> tsv_files:</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">with</span> z.<span class="bu">open</span>(tsv_file) <span class="im">as</span> f:</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>                            f_text <span class="op">=</span> io.TextIOWrapper(f)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>                            protein_sequences_dict <span class="op">=</span> <span class="va">self</span>._read_proteins_from_fasta(f_text)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get unique proteins</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>                unique_proteins <span class="op">=</span> <span class="bu">set</span>(df[<span class="st">'node1_string_id'</span>]).union(<span class="bu">set</span>(df[<span class="st">'node2_string_id'</span>]))</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>                <span class="co"># filter unique proteins on a dict</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>                filtered_protein_dict <span class="op">=</span> {protein: seq <span class="cf">for</span> protein, seq <span class="kw">in</span> protein_sequences_dict.items() <span class="cf">if</span> protein <span class="kw">in</span> unique_proteins}</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>                <span class="co"># getting the larger sequence for the proteinbert embedding</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>                sequences <span class="op">=</span> <span class="bu">list</span>(filtered_protein_dict.values())</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>                <span class="co"># protein_names = list(filtered_protein_dict.keys())</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>                longest_sequence_length <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> sequences)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>                <span class="co"># use protein bert to get embeddings</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>                batch_size <span class="op">=</span> <span class="va">self</span>.batch_size  <span class="co"># Adjust based on your GPU memory</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>                seq_len <span class="op">=</span> longest_sequence_length<span class="op">+</span><span class="dv">2</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>                global_embeds <span class="op">=</span> []</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>                local_embeds <span class="op">=</span> []</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(sequences), batch_size):</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>                    batch_seqs <span class="op">=</span> sequences[i:i <span class="op">+</span> batch_size]</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>                    local_representation, global_representation <span class="op">=</span> <span class="va">self</span>._get_embeddings(batch_seqs, seq_len<span class="op">=</span>seq_len, batch_size<span class="op">=</span>batch_size)</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>                    global_embeds.extend(global_representation)</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>                    local_embeds.extend(local_representation)</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>                global_embeds <span class="op">=</span> np.array(global_embeds)</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>                local_embeds <span class="op">=</span> np.array(local_embeds)</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>                <span class="co"># encode the protein names</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>                lbl_protein <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>                df.node1_string_id <span class="op">=</span> lbl_protein.fit_transform(df.node1_string_id.values)</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>                df.node2_string_id <span class="op">=</span> lbl_protein.fit_transform(df.node2_string_id.values)</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>                <span class="co"># generate edge index</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>                edge_index <span class="op">=</span> <span class="va">self</span>._load_edge_csv(df<span class="op">=</span>df, src_index_col<span class="op">=</span><span class="st">"node1_string_id"</span>, dst_index_col<span class="op">=</span><span class="st">"node2_string_id"</span>, link_index_col<span class="op">=</span><span class="st">"combined_score"</span>)</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>                edge_index <span class="op">=</span> torch.LongTensor(edge_index)</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get class for the graph</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> <span class="va">self</span>._find_species_classes(<span class="va">self</span>.root<span class="op">+</span><span class="st">"/raw/species.xlsx"</span>,species).values</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>                index <span class="op">=</span> y.copy()[<span class="dv">0</span>]</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>                y <span class="op">=</span> torch.Tensor(y).to(torch.<span class="bu">long</span>)</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>                <span class="co"># create pytorch geometric data</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> Data(x<span class="op">=</span>global_embeds,edge_index<span class="op">=</span>edge_index, y<span class="op">=</span>y)</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>                <span class="co"># save as .pt file according to the index (class)</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>                torch.save(data, osp.join(<span class="va">self</span>.processed_dir,<span class="ss">f"data_</span><span class="sc">{</span>index<span class="sc">}</span><span class="ss">.pt"</span>))</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _read_proteins_from_fasta(<span class="va">self</span>, fasta_file):</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>        protein_dict <span class="op">=</span> {}</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> record <span class="kw">in</span> SeqIO.parse(fasta_file, <span class="st">"fasta"</span>):</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>            protein_dict[record.<span class="bu">id</span>] <span class="op">=</span> <span class="bu">str</span>(record.seq)</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> protein_dict</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_embeddings(<span class="va">self</span>, seq, seq_len<span class="op">=</span><span class="dv">512</span>, batch_size<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>        pretrained_model_generator, input_encoder <span class="op">=</span> load_pretrained_model()</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> get_model_with_hidden_layers_as_outputs(pretrained_model_generator.create_model(seq_len<span class="op">=</span>seq_len))</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>        encoded_x <span class="op">=</span> input_encoder.encode_X(seq, seq_len)</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>        local_representations, global_representations <span class="op">=</span> model.predict(encoded_x, batch_size<span class="op">=</span>batch_size)</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> local_representations, global_representations</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _load_edge_csv(<span class="va">self</span>, df, src_index_col, dst_index_col, link_index_col):</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>        edge_index<span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>        src <span class="op">=</span> [protein1 <span class="cf">for</span> protein1 <span class="kw">in</span> df[src_index_col]]</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>        dst <span class="op">=</span> [protein2 <span class="cf">for</span> protein2 <span class="kw">in</span> df[dst_index_col]]</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>        edge_attr <span class="op">=</span> torch.from_numpy(df[link_index_col].values).view(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>        edge_index <span class="op">=</span> [[], []]</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(edge_attr.shape[<span class="dv">0</span>]):</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge_attr[i]:</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>                edge_index[<span class="dv">0</span>].append(src[i])</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>                edge_index[<span class="dv">1</span>].append(dst[i])</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> edge_index</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _find_species_classes(<span class="va">self</span>, file_path, species_path):</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Load the Excel file into a pandas DataFrame        </span></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_excel(file_path)</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ensure the columns 'species' and 'class' exist</span></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'species'</span> <span class="kw">not</span> <span class="kw">in</span> df.columns <span class="kw">or</span> <span class="st">'class'</span> <span class="kw">not</span> <span class="kw">in</span> df.columns:</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"The input file must contain 'species' and 'class' columns."</span>)</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Identify rows where "scientific name" is present in the "species" column (case insensitive)</span></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>        extract_pattern <span class="op">=</span> [i.split(<span class="st">"</span><span class="ch">\\</span><span class="st">"</span>) <span class="cf">for</span> i <span class="kw">in</span> species_path.split(<span class="st">"_"</span>)[<span class="dv">0</span>:<span class="dv">2</span>]]</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>        extract_pattern <span class="op">=</span> [i[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> extract_pattern]</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>        extract_pattern <span class="op">=</span> <span class="st">" "</span>.join(extract_pattern)</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Extracted pattern: </span><span class="sc">{</span>extract_pattern<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>        mask <span class="op">=</span> df[<span class="st">'species'</span>].<span class="bu">str</span>.contains(extract_pattern, case<span class="op">=</span><span class="va">False</span>, na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Return the corresponding "class" values</span></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> df.loc[mask, <span class="st">'class'</span>]</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="bu">len</span>(<span class="va">self</span>):</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">len</span>(<span class="va">self</span>.processed_file_names)</span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get(<span class="va">self</span>, idx):</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> torch.load(osp.join(<span class="va">self</span>.processed_dir, <span class="ss">f'data_</span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">.pt'</span>))</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Basically what this code does, is using the .tsv and .fasta files to create a <strong>Data</strong> object that stores 3 things:</p>
<ul>
<li>The embedding of ProteinBERT as node features.</li>
<li>The edge_index which is the connections of the network.</li>
<li>A number representing the plant species.</li>
</ul>
<p>We can verifiy that the data was created and loaded:</p>
<div id="cell-9" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> UnfoldedProteinBinding(root<span class="op">=</span><span class="st">"data/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-10" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dataset[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Data(x=[158, 15599], edge_index=[2, 8578], y=[1])</code></pre>
</div>
</div>
</section>
<section id="spliting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="spliting-the-data">Spliting the Data</h2>
<p>Once we have the data loaded, we need to split it to trainning and test datasets. For this, we can use <code>random_split</code> and load these two datasets to a <code>DataLoader</code> from pytorch geometric.</p>
<p>I set batch to one because I dont have much computer resources and because if I increase the number of batches, I need to add a for loop on the GNN class due to the different number of nodes for each species. You are free to modify this for a larger scale training.</p>
<div id="cell-13" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.loader <span class="im">import</span> DataLoader</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>train_dataset, test_dataset <span class="op">=</span> torch.utils.data.random_split(dataset, [<span class="dv">50</span>, <span class="dv">10</span>])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">1</span>  <span class="co"># Adjust based on your memory capacity</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>train_loader <span class="op">=</span> DataLoader(train_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>test_loader <span class="op">=</span> DataLoader(test_dataset, batch_size<span class="op">=</span>batch_size, shuffle<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="define-device" class="level2">
<h2 class="anchored" data-anchor-id="define-device">Define Device</h2>
<p>Is important to define the device of work.</p>
<div id="cell-16" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>device <span class="op">=</span> <span class="st">'cuda'</span> <span class="cf">if</span> torch.cuda.is_available() <span class="cf">else</span> <span class="st">'cpu'</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Device: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(device))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Device: cuda</code></pre>
</div>
</div>
</section>
<section id="graph-neural-network" class="level2">
<h2 class="anchored" data-anchor-id="graph-neural-network">Graph Neural Network</h2>
<p>Okay! We are ready to create our graph neural network. We are gonna use GraphSAGE for this task because it’s easy to implement and faster to train.</p>
<section id="gnnstack" class="level3">
<h3 class="anchored" data-anchor-id="gnnstack">GNNStack</h3>
<p>The GNNStack class, takes as input the ProteinBERT embeddings and the edge index and returns the updated node embeddings. Notice that we are using a built-in GraphSAGE (<code>SAGEConv</code>) from pytorch geometric.</p>
<div id="cell-21" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch_geometric.nn <span class="im">import</span> SAGEConv</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GNNStack(torch.nn.Module):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_dim, hidden_dim, output_dim, dropout, num_layers:<span class="bu">int</span>, emb<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(GNNStack, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout <span class="op">=</span> dropout</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_layers <span class="op">=</span> num_layers</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.emb <span class="op">=</span> emb</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.convs <span class="op">=</span> nn.ModuleList()</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> layer <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_layers):</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>            in_channels <span class="op">=</span> input_dim <span class="cf">if</span> layer <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> hidden_dim</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            out_channels <span class="op">=</span> hidden_dim </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.convs.append(SAGEConv(in_channels, out_channels, normalize<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.post_mp <span class="op">=</span> nn.Sequential(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>            nn.Dropout(<span class="va">self</span>.dropout),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>            nn.Linear(hidden_dim, hidden_dim)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        ) </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x, edge_index):</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_layers):</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> <span class="va">self</span>.convs[i](x, edge_index)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> F.gelu(x)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> F.dropout(x, p<span class="op">=</span><span class="va">self</span>.dropout,training<span class="op">=</span><span class="va">self</span>.training)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.post_mp(x)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.emb <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> x</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> F.log_softmax(x, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> loss(<span class="va">self</span>, pred, label):</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> F.nll_loss(pred, label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A function to save the model:</p>
<div id="cell-23" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> save_torch_model(model,epoch,PATH:<span class="bu">str</span>,optimizer):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Saving Model in Path </span><span class="sc">{</span>PATH<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    torch.save({<span class="st">'epoch'</span>: epoch,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">'model_state_dict'</span>: model.state_dict(),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'optimizer'</span>:optimizer,      </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                }, PATH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s check the model structure:</p>
<div id="cell-25" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>input_dim <span class="op">=</span> dataset[<span class="dv">0</span>].x.shape[<span class="dv">1</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>hidden_dim <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>dropout <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>num_layers<span class="op">=</span> <span class="dv">3</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GNNStack(input_dim, hidden_dim, hidden_dim, dropout, num_layers, <span class="va">True</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>GNNStack(
  (convs): ModuleList(
    (0): SAGEConv(15599, 1024, aggr=mean)
    (1-2): 2 x SAGEConv(1024, 1024, aggr=mean)
  )
  (post_mp): Sequential(
    (0): Linear(in_features=1024, out_features=1024, bias=True)
    (1): Dropout(p=0.3, inplace=False)
    (2): Linear(in_features=1024, out_features=1024, bias=True)
  )
)</code></pre>
</div>
</div>
</section>
<section id="linkpredictionhead" class="level3">
<h3 class="anchored" data-anchor-id="linkpredictionhead">LinkPredictionHead</h3>
<p>Once we have the updated protein embeddings, we need to create a prediction head that will calculate the probability that two proteins interact.</p>
<p>The <code>LinkPredictorHead</code> takes as input two vectors that corresponds to the edge indeces from a specific network and return a estimated probability that these nodes interact.</p>
<p>Notice that to the last layer, a multi layer perceptron is applied.</p>
<div id="cell-28" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LinkPredictorHead(nn.Module):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, in_channels:<span class="bu">int</span>, hidden_channels:<span class="bu">int</span>, out_channels:<span class="bu">int</span>, n_layers:<span class="bu">int</span>,dropout_probabilty:<span class="bu">float</span><span class="op">=</span><span class="fl">0.3</span>):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>(LinkPredictorHead, <span class="va">self</span>).<span class="fu">__init__</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dropout_probabilty    <span class="op">=</span> dropout_probabilty  <span class="co"># dropout probability</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mlp_layers            <span class="op">=</span> nn.ModuleList()     <span class="co"># ModuleList: is a list of modules</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.non_linearity         <span class="op">=</span> F.relu              <span class="co"># non-linearity</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_layers <span class="op">-</span> <span class="dv">1</span>):                                 </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.mlp_layers.append(nn.Linear(in_channels, hidden_channels))          <span class="co"># input layer (in_channels, hidden_channels)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.mlp_layers.append(nn.Linear(hidden_channels, hidden_channels))      <span class="co"># hidden layers (hidden_channels, hidden_channels)</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mlp_layers.append(nn.Linear(hidden_channels, out_channels))                 <span class="co"># output layer (hidden_channels, out_channels)</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reset_parameters(<span class="va">self</span>):</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mlp_layer <span class="kw">in</span> <span class="va">self</span>.mlp_layers:</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>            mlp_layer.reset_parameters()</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x_i, x_j):</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> x_i <span class="op">*</span> x_j                                                     <span class="co"># element-wise multiplication</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mlp_layer <span class="kw">in</span> <span class="va">self</span>.mlp_layers[:<span class="op">-</span><span class="dv">1</span>]:                            <span class="co"># iterate over all layers except the last one</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> mlp_layer(x)                                              <span class="co"># apply linear transformation</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> <span class="va">self</span>.non_linearity(x)                                     <span class="co"># Apply non linear activation function</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>            x <span class="op">=</span> F.dropout(x, p<span class="op">=</span><span class="va">self</span>.dropout_probabilty,training<span class="op">=</span><span class="va">self</span>.training)      <span class="co"># Apply dropout</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.mlp_layers[<span class="op">-</span><span class="dv">1</span>](x)                                        <span class="co"># apply linear transformation to the last layer</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.sigmoid(x)                                              <span class="co"># apply sigmoid activation function to get the probability</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s check the model estructure:</p>
<div id="cell-30" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>link_model_pred <span class="op">=</span> LinkPredictorHead(hidden_dim, hidden_dim,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>link_model_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>LinkPredictorHead(
  (mlp_layers): ModuleList(
    (0-1): 2 x Linear(in_features=1024, out_features=1024, bias=True)
    (2): Linear(in_features=1024, out_features=1, bias=True)
  )
)</code></pre>
</div>
</div>
<p>Now, let’s check if our <code>GNNStack</code> and <code>LinkPredictorHead</code> works on a single graph:</p>
<div id="cell-32" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch <span class="kw">in</span> train_loader:</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(batch)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> torch.FloatTensor(batch.x[<span class="dv">0</span>])</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    emb <span class="op">=</span> model(x, batch.edge_index)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> link_model_pred(emb[batch.edge_index[<span class="dv">0</span>]], emb[batch.edge_index[<span class="dv">1</span>]])</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>DataBatch(x=[1], edge_index=[2, 6832], y=[1], batch=[136], ptr=[2])
tensor([[0.4934],
        [0.4940],
        [0.4909],
        ...,
        [0.4943],
        [0.4953],
        [0.4922]], grad_fn=&lt;SigmoidBackward0&gt;)</code></pre>
</div>
</div>
</section>
</section>
<section id="training-function" class="level2">
<h2 class="anchored" data-anchor-id="training-function">Training Function</h2>
<p>Let’s define a training function that for each batch, will get the updated embedding using GrapgSAGE and get the estimated probaiblities using the link predictor head. Now, we need to sample negatives edges so the model can learn which edges are good an which aren’t. Finally, the negative log-likelihood is calculated with the positive and negative edges.</p>
<div id="cell-34" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train(model, link_predictor, dataloader, optimizer, device:<span class="bu">str</span>):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="op">!=</span> <span class="va">None</span>:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        model.train()</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    link_predictor.train()</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    total_loss <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> batch <span class="kw">in</span> tqdm(dataloader):  </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        x, edge_index <span class="op">=</span> batch.x[<span class="dv">0</span>], batch.edge_index</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.FloatTensor(x).to(device)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        edge_index <span class="op">=</span> edge_index.to(device)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        optimizer.zero_grad()  </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model <span class="op">!=</span>  <span class="va">None</span>:</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>            node_emb <span class="op">=</span> model(x, edge_index)  <span class="co"># Embed Bert Embeddigns with graphsage (N, d)   </span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>            node_emb <span class="op">=</span> x                     <span class="co"># Else (None) use Bert Embedddings</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Predict the class probabilities on the batch of positive edges using link_predictor</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">#print(node_emb[edge_index[0]].shape)</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        pos_pred <span class="op">=</span> link_predictor(node_emb[edge_index[<span class="dv">0</span>]], node_emb[edge_index[<span class="dv">1</span>]])   <span class="co"># (B, )</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sample negative edges (same number as number of positive edges) and predict class probabilities </span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (2,N) = (2,P) = (2,|E|)</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>        neg_edge <span class="op">=</span> negative_sampling(edge_index <span class="op">=</span> edge_index,             <span class="co"># Possitve PPI's</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                                 num_nodes        <span class="op">=</span> x.shape[<span class="dv">0</span>],           <span class="co"># Total number of nodes in graph</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                                 num_neg_samples  <span class="op">=</span> edge_index.shape[<span class="dv">1</span>],  <span class="co"># Same Number of edges as in positive example</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                                 force_undirected <span class="op">=</span> <span class="va">True</span>)                 <span class="co"># Our graph is undirected</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>        neg_pred <span class="op">=</span> link_predictor(node_emb[neg_edge[<span class="dv">0</span>]], node_emb[neg_edge[<span class="dv">1</span>]])         <span class="co"># (Ne,)</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute the corresponding negative log likelihood loss on the positive and negative edges</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> <span class="op">-</span>torch.log(pos_pred <span class="op">+</span> <span class="fl">1e-15</span>).mean() <span class="op">-</span> torch.log(<span class="dv">1</span> <span class="op">-</span> neg_pred <span class="op">+</span> <span class="fl">1e-15</span>).mean()</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Backpropagate and update parameters</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>        loss.backward()</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>        optimizer.step()</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>        total_loss <span class="op">+=</span> loss.item()</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_loss <span class="op">/</span> <span class="bu">len</span>(dataloader)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="testing-function" class="level2">
<h2 class="anchored" data-anchor-id="testing-function">Testing Function</h2>
<p>For the testing function, as Perez et al.&nbsp;mention:</p>
<p>“<em>if we were to use all the PPI to embed the graph it would be practically cheating (since our embedding would have this information). Therefore (for the evaluation loop) we will randomly drop a percentage of PPIs by doing two steps: Randomly permuted the edge_index and Dropping a percentage of PPI for embedding and leaving another percentage for inference</em>”</p>
<p>Then, we use the <code>GNNStack</code> and the <code>LinkPredictorHead</code> to get the estimated probability on the permuted <code>edge_index</code>. Also, we need to get negative edges and predict the probability of their interactions. The idea is to get high accuracy for the positive and negatives edges so we are sure that the model is performing better each epoch of training.</p>
<p>An extra chunk of code is inside the function that will show the AUC/ROC plot and Confusion matrix plot.</p>
<div id="cell-37" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate(model, predictor,dataloader,device:<span class="bu">str</span>,threshold<span class="op">=</span><span class="fl">0.5</span>,ppi_:<span class="bu">int</span><span class="op">=</span><span class="fl">0.9</span>,verbose:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>,best_accuracy<span class="op">=</span><span class="dv">0</span>,show_extra_metrics:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model <span class="op">!=</span> <span class="va">None</span>:</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        model.<span class="bu">eval</span>()</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    possitive_acc  <span class="op">=</span> <span class="dv">0</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    negative_acc   <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    batches        <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_extra_metrics:</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        yhat_total     <span class="op">=</span> []</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        y_total        <span class="op">=</span> []</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> batch <span class="kw">in</span> dataloader:                              <span class="co"># Get X and Index from Dataste</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        x, edge_index <span class="op">=</span> batch.x[<span class="dv">0</span>], batch.edge_index</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.FloatTensor(x).to(device)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>        edge_index <span class="op">=</span> edge_index.to(device)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        number_of_edges <span class="op">=</span>  edge_index.size(<span class="dv">1</span>)                 <span class="co"># Retrive number of edges </span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        permutations    <span class="op">=</span>  torch.randperm(number_of_edges)     <span class="co"># Create Permutations for edge index</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        edge_index      <span class="op">=</span> edge_index[:,permutations]           <span class="co"># Run permutation</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        limit           <span class="op">=</span> <span class="bu">int</span>(ppi_<span class="op">*</span>number_of_edges)            <span class="co"># get limit  (based on ppis to embed)</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        ppi_index_embed <span class="op">=</span> edge_index[:,<span class="dv">0</span>:limit]                <span class="co"># PPI to embed with GraphSage </span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        ppi_index_infer <span class="op">=</span> edge_index[:,limit:]                 <span class="co"># PPI to make inference</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># x                    = x.squeeze(dim=1)</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># x ,ppi_index_embed   = x.to(device) , ppi_index_embed.to(device) </span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model <span class="op">!=</span>  <span class="va">None</span>:</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>            node_emb <span class="op">=</span> model(x,ppi_index_embed)             <span class="co"># Get all node embeddings</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>            node_emb <span class="op">=</span> x.cpu()                                                 <span class="co"># Else (None) use Bert Embedddings</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>limit<span class="sc">}</span><span class="ss"> Positive Protein Interactions were used to Embed a graph with </span><span class="sc">{</span>number_of_edges<span class="sc">}</span><span class="ss"> ppi's"</span>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> ppi_index_embed </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Positive PPI </span><span class="al">###</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>            positive_pairs_embeddings <span class="op">=</span> node_emb[ppi_index_infer[<span class="dv">0</span>]], node_emb[ppi_index_infer[<span class="dv">1</span>]]</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>            predictions               <span class="op">=</span> predictor(positive_pairs_embeddings[<span class="dv">0</span>], positive_pairs_embeddings[<span class="dv">1</span>]) </span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>            y                         <span class="op">=</span> torch.ones_like(<span class="bu">input</span><span class="op">=</span>predictions)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>            predictions,y             <span class="op">=</span> predictions.cpu(),y.cpu()</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>            possitive_acc            <span class="op">+=</span> accuracy_score(predictions <span class="op">&gt;</span> threshold  ,y)</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> show_extra_metrics:</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>                yhat_total.extend(predictions.tolist())</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>                y_total.extend(y.tolist())</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                <span class="kw">del</span> y, predictions , positive_pairs_embeddings,ppi_index_infer</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Negative PPI ##</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>            neg_edge <span class="op">=</span> negative_sampling(edge_index <span class="op">=</span> edge_index,        <span class="co"># Possitve PPI's</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>                                         num_nodes        <span class="op">=</span> x.shape[<span class="dv">0</span>],           <span class="co"># Total number of nodes in graph</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>                                         num_neg_samples  <span class="op">=</span> edge_index.shape[<span class="dv">1</span>],  <span class="co"># Same Number of edges as in positive example</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>                                         force_undirected <span class="op">=</span> <span class="va">True</span>)                 <span class="co"># Our graph is undirected</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>            negative_pairs_embeddings <span class="op">=</span> node_emb[neg_edge[<span class="dv">0</span>]], node_emb[neg_edge[<span class="dv">1</span>]]</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>            predictions               <span class="op">=</span> predictor(negative_pairs_embeddings[<span class="dv">0</span>], negative_pairs_embeddings[<span class="dv">1</span>])   </span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>            y                         <span class="op">=</span> torch.zeros_like(<span class="bu">input</span><span class="op">=</span>predictions)</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>            predictions,y             <span class="op">=</span> predictions.cpu(),y.cpu()</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>            negative_acc             <span class="op">+=</span> accuracy_score(predictions <span class="op">&gt;</span> threshold,y)</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> show_extra_metrics:</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>                yhat_total.extend(predictions.tolist())</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>                y_total.extend(y.tolist())</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>                <span class="kw">del</span> y,  predictions  ,negative_pairs_embeddings </span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>            batches <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>    negative_acc  <span class="op">=</span> negative_acc<span class="op">/</span>batches</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>    possitive_acc <span class="op">=</span> possitive_acc<span class="op">/</span>batches</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>    total_acc     <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>possitive_acc  <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>negative_acc</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_extra_metrics <span class="op">==</span> <span class="va">False</span>:</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Sensitivity (poss_acc):</span><span class="sc">{</span>possitive_acc<span class="sc">:.4f}</span><span class="ss"> Specificity (negative_acc):</span><span class="sc">{</span>negative_acc<span class="sc">:.4f}</span><span class="ss"> accuracy:</span><span class="sc">{</span>total_acc<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> show_extra_metrics <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">2</span>))</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>        fpr, tpr, thresholds <span class="op">=</span> metrics.roc_curve( y_total, yhat_total)</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>        sens      <span class="op">=</span>  tpr</span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>        spec      <span class="op">=</span>  <span class="dv">1</span> <span class="op">-</span> fpr</span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>        j         <span class="op">=</span> sens <span class="op">+</span> spec <span class="op">-</span><span class="dv">1</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>        opt_index <span class="op">=</span> np.where(j <span class="op">==</span> np.<span class="bu">max</span>(j))[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>        op_point  <span class="op">=</span> thresholds[opt_index]</span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Youdens  index: </span><span class="sc">{</span>op_point<span class="sc">:.4f}</span><span class="ss"> Sensitivity: </span><span class="sc">{</span><span class="bu">round</span>(sens[opt_index],<span class="dv">4</span>)<span class="sc">}</span><span class="ss"> Specificity: </span><span class="sc">{</span><span class="bu">round</span>(spec[opt_index],<span class="dv">4</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">0</span>].set_title(<span class="st">"ROC Curve"</span>)</span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">1</span>].set_title(<span class="st">"Confussion Matrix"</span>)</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model <span class="op">==</span> <span class="va">None</span>:</span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>            ax[<span class="dv">0</span>].plot(fpr,tpr,label<span class="op">=</span><span class="st">"MLP"</span>) </span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>            ax[<span class="dv">0</span>].plot(fpr,tpr,label<span class="op">=</span><span class="st">"GraphSage+MLP"</span>) </span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">0</span>].plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'k--'</span>)</span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">0</span>].set_ylabel(<span class="st">'True Positive Rate'</span>)</span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">0</span>].set_xlabel(<span class="st">'False Positive Rate'</span>)</span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">0</span>].legend()</span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a>        cfm <span class="op">=</span> metrics.confusion_matrix(y_total, np.array(yhat_total)<span class="op">&gt;</span> op_point)</span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>        cmn <span class="op">=</span> cfm.astype(<span class="st">'float'</span>) <span class="op">/</span> cfm.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)[:, np.newaxis] <span class="co"># Normalise</span></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>        disp <span class="op">=</span> ConfusionMatrixDisplay(cmn)</span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>        disp.plot(ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_acc </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="training-the-model" class="level2">
<h2 class="anchored" data-anchor-id="training-the-model">Training the Model</h2>
<p>It’s time to train the model. First, let’s define some parameters:</p>
<div id="cell-40" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>epochs        <span class="op">=</span> <span class="dv">500</span>  </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="op">=</span> <span class="fl">1e-4</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>input_dim <span class="op">=</span> dataset[<span class="dv">0</span>].x.shape[<span class="dv">1</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>hidden_dim <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>dropout <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>num_layers<span class="op">=</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Initialize the models:</p>
<div id="cell-42" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>model          <span class="op">=</span> GNNStack(input_dim, hidden_dim, hidden_dim, dropout,num_layers, emb<span class="op">=</span><span class="va">True</span>).to(device) <span class="co"># the graph neural network that takes all the node embeddings as inputs to message pass and agregate</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>link_predictor <span class="op">=</span> LinkPredictorHead(hidden_dim, hidden_dim, <span class="dv">1</span>, num_layers , dropout).to(device) <span class="co"># the MLP that takes embeddings of a pair of nodes and predicts the existence of an edge between them</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>optimizer      <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(model.parameters()) <span class="op">+</span> <span class="bu">list</span>(link_predictor.parameters() ), lr<span class="op">=</span>learning_rate)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(link_predictor)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Models Loaded to </span><span class="sc">{</span>device<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>GNNStack(
  (convs): ModuleList(
    (0): SAGEConv(15599, 1024, aggr=mean)
    (1-2): 2 x SAGEConv(1024, 1024, aggr=mean)
  )
  (post_mp): Sequential(
    (0): Linear(in_features=1024, out_features=1024, bias=True)
    (1): Dropout(p=0.3, inplace=False)
    (2): Linear(in_features=1024, out_features=1024, bias=True)
  )
)
LinkPredictorHead(
  (mlp_layers): ModuleList(
    (0-1): 2 x Linear(in_features=1024, out_features=1024, bias=True)
    (2): Linear(in_features=1024, out_features=1, bias=True)
  )
)
Models Loaded to cuda</code></pre>
</div>
</div>
<p>Check the training function:</p>
<div id="cell-44" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gc</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>torch.cuda.empty_cache()</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>gc.collect()</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>loss <span class="op">=</span> train(model, link_predictor, train_loader, optimizer, device)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>torch.cuda.empty_cache()</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>gc.collect()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c3d3bc09ec07418dab3ddfedda1e38aa","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>170</code></pre>
</div>
</div>
<p>Please, before running the training loop, take into account that on my NVIDIA GeForce RTX 1650, it took 8 hours.</p>
<div id="cell-46" class="cell" data-execution_count="190">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>train_loss                      <span class="op">=</span> []</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>train_accuracy                  <span class="op">=</span> []</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>show_metrics_every              <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>best_accuracy                   <span class="op">=</span> <span class="dv">0</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>best_graphsage_model_path       <span class="op">=</span> <span class="st">""</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>best_link_predictor_model_path  <span class="op">=</span> <span class="st">""</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,epochs):</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    torch.cuda.empty_cache()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    gc.collect()</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">### TRAIN ####</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> train(model, link_predictor,train_loader, optimizer,device) <span class="co"># Get Loss</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    train_loss.append(loss)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Epoch </span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">: loss: </span><span class="sc">{</span><span class="bu">round</span>(loss, <span class="dv">5</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">### EVALUATE </span><span class="al">###</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>) <span class="kw">or</span> (epoch <span class="op">==</span><span class="dv">1</span>):</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> evaluate(model, link_predictor ,test_loader,device<span class="op">=</span>device,best_accuracy<span class="op">=</span>best_accuracy,show_extra_metrics<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        accuracy <span class="op">=</span> evaluate(model, link_predictor ,test_loader,device<span class="op">=</span>device,best_accuracy<span class="op">=</span>best_accuracy)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    train_accuracy.append(accuracy)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">### SAVE </span><span class="al">###</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> best_accuracy <span class="op">&lt;</span> accuracy:</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(best_graphsage_model_path):</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>            os.remove(best_graphsage_model_path)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(best_link_predictor_model_path):</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>            os.remove(best_link_predictor_model_path)</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Replacing models: </span><span class="sc">{</span>best_graphsage_model_path <span class="sc">}</span><span class="ss">  </span><span class="sc">{</span>best_link_predictor_model_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        best_accuracy  <span class="op">=</span> accuracy</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        best_graphsage_model_path      <span class="op">=</span> <span class="ss">f"GraphSage_epoch_</span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">.pt"</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        best_link_predictor_model_path <span class="op">=</span>  <span class="ss">f"link_predictor_epoch_</span><span class="sc">{</span>epoch<span class="sc">}</span><span class="ss">.pt"</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"with: Best models at </span><span class="sc">{</span>best_graphsage_model_path <span class="sc">}</span><span class="ss">  </span><span class="sc">{</span>best_link_predictor_model_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        save_torch_model(model,         epoch<span class="op">=</span>epoch,PATH<span class="op">=</span>best_graphsage_model_path ,     optimizer<span class="op">=</span>optimizer)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        save_torch_model(link_predictor,epoch<span class="op">=</span>epoch,PATH<span class="op">=</span>best_link_predictor_model_path, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="co">#### Load Best Models ####</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loading best models:  </span><span class="sc">{</span>best_graphsage_model_path <span class="sc">}</span><span class="ss">  </span><span class="sc">{</span>best_link_predictor_model_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>checkpoint <span class="op">=</span> torch.load(best_graphsage_model_path)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>model.load_state_dict(checkpoint[<span class="st">'model_state_dict'</span>])</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>checkpoint <span class="op">=</span> torch.load(best_link_predictor_model_path)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>link_predictor.load_state_dict(checkpoint[<span class="st">'model_state_dict'</span>])</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> checkpoint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fd27a4543e7449d2b926a36f2353ffee","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1: loss: 1.38448
Youdens  index: 0.5037 Sensitivity: 0.3319 Specificity: 0.6824
Replacing models:   
with: Best models at GraphSage_epoch_1.pt  link_predictor_epoch_1.pt
Saving Model in Path GraphSage_epoch_1.pt
Saving Model in Path link_predictor_epoch_1.pt
Epoch 2: loss: 1.38614
Sensitivity (poss_acc):0.8252 Specificity (negative_acc):0.2117 accuracy:0.5184
Replacing models: GraphSage_epoch_1.pt  link_predictor_epoch_1.pt
with: Best models at GraphSage_epoch_2.pt  link_predictor_epoch_2.pt
Saving Model in Path GraphSage_epoch_2.pt
Saving Model in Path link_predictor_epoch_2.pt
Epoch 3: loss: 1.38463
Sensitivity (poss_acc):0.9350 Specificity (negative_acc):0.2309 accuracy:0.5829
Replacing models: GraphSage_epoch_2.pt  link_predictor_epoch_2.pt
with: Best models at GraphSage_epoch_3.pt  link_predictor_epoch_3.pt
Saving Model in Path GraphSage_epoch_3.pt
Saving Model in Path link_predictor_epoch_3.pt
Epoch 4: loss: 1.3332
Sensitivity (poss_acc):0.8810 Specificity (negative_acc):0.3632 accuracy:0.6221
Replacing models: GraphSage_epoch_3.pt  link_predictor_epoch_3.pt
with: Best models at GraphSage_epoch_4.pt  link_predictor_epoch_4.pt
Saving Model in Path GraphSage_epoch_4.pt
Saving Model in Path link_predictor_epoch_4.pt
Epoch 5: loss: 1.23284
Sensitivity (poss_acc):0.9000 Specificity (negative_acc):0.3776 accuracy:0.6388
Replacing models: GraphSage_epoch_4.pt  link_predictor_epoch_4.pt
with: Best models at GraphSage_epoch_5.pt  link_predictor_epoch_5.pt
Saving Model in Path GraphSage_epoch_5.pt
Saving Model in Path link_predictor_epoch_5.pt
Epoch 6: loss: 1.24907
Sensitivity (poss_acc):0.5224 Specificity (negative_acc):0.5986 accuracy:0.5605
Epoch 7: loss: 1.28041
Sensitivity (poss_acc):0.8782 Specificity (negative_acc):0.3660 accuracy:0.6221
Epoch 8: loss: 1.20592
Sensitivity (poss_acc):0.9635 Specificity (negative_acc):0.3077 accuracy:0.6356
Epoch 9: loss: 1.12853
Sensitivity (poss_acc):0.9092 Specificity (negative_acc):0.4707 accuracy:0.6900
Replacing models: GraphSage_epoch_5.pt  link_predictor_epoch_5.pt
with: Best models at GraphSage_epoch_9.pt  link_predictor_epoch_9.pt
Saving Model in Path GraphSage_epoch_9.pt
Saving Model in Path link_predictor_epoch_9.pt
Epoch 10: loss: 1.13204
Sensitivity (poss_acc):0.9162 Specificity (negative_acc):0.4552 accuracy:0.6857
Epoch 11: loss: 1.08384
Sensitivity (poss_acc):0.6898 Specificity (negative_acc):0.6484 accuracy:0.6691
Epoch 12: loss: 1.06029
Sensitivity (poss_acc):0.7078 Specificity (negative_acc):0.6942 accuracy:0.7010
Replacing models: GraphSage_epoch_9.pt  link_predictor_epoch_9.pt
with: Best models at GraphSage_epoch_12.pt  link_predictor_epoch_12.pt
Saving Model in Path GraphSage_epoch_12.pt
Saving Model in Path link_predictor_epoch_12.pt
Epoch 13: loss: 1.06227
Sensitivity (poss_acc):0.7683 Specificity (negative_acc):0.6015 accuracy:0.6849
Epoch 14: loss: 1.04963
Sensitivity (poss_acc):0.8731 Specificity (negative_acc):0.5512 accuracy:0.7122
Replacing models: GraphSage_epoch_12.pt  link_predictor_epoch_12.pt
with: Best models at GraphSage_epoch_14.pt  link_predictor_epoch_14.pt
Saving Model in Path GraphSage_epoch_14.pt
Saving Model in Path link_predictor_epoch_14.pt
Epoch 15: loss: 1.01064
Sensitivity (poss_acc):0.8945 Specificity (negative_acc):0.4840 accuracy:0.6893
Epoch 16: loss: 1.02564
Sensitivity (poss_acc):0.7047 Specificity (negative_acc):0.7023 accuracy:0.7035
Epoch 17: loss: 0.98034
Sensitivity (poss_acc):0.8704 Specificity (negative_acc):0.5577 accuracy:0.7140
Replacing models: GraphSage_epoch_14.pt  link_predictor_epoch_14.pt
with: Best models at GraphSage_epoch_17.pt  link_predictor_epoch_17.pt
Saving Model in Path GraphSage_epoch_17.pt
Saving Model in Path link_predictor_epoch_17.pt
Epoch 18: loss: 0.98538
Sensitivity (poss_acc):0.7756 Specificity (negative_acc):0.6488 accuracy:0.7122
Epoch 19: loss: 0.97591
Sensitivity (poss_acc):0.7789 Specificity (negative_acc):0.6861 accuracy:0.7325
Replacing models: GraphSage_epoch_17.pt  link_predictor_epoch_17.pt
with: Best models at GraphSage_epoch_19.pt  link_predictor_epoch_19.pt
Saving Model in Path GraphSage_epoch_19.pt
Saving Model in Path link_predictor_epoch_19.pt
Epoch 20: loss: 0.99183
Youdens  index: 0.6296 Sensitivity: 0.7128 Specificity: 0.7018
Epoch 21: loss: 0.94824
Sensitivity (poss_acc):0.8119 Specificity (negative_acc):0.6123 accuracy:0.7121
Epoch 22: loss: 0.95164
Sensitivity (poss_acc):0.8740 Specificity (negative_acc):0.5648 accuracy:0.7194
Epoch 23: loss: 0.92309
Sensitivity (poss_acc):0.8093 Specificity (negative_acc):0.6073 accuracy:0.7083
Epoch 24: loss: 0.90591
Sensitivity (poss_acc):0.8679 Specificity (negative_acc):0.5768 accuracy:0.7223
Epoch 25: loss: 0.89268
Sensitivity (poss_acc):0.8058 Specificity (negative_acc):0.6467 accuracy:0.7263
Epoch 26: loss: 0.90408
Sensitivity (poss_acc):0.8594 Specificity (negative_acc):0.5980 accuracy:0.7287
Epoch 27: loss: 0.88659
Sensitivity (poss_acc):0.7914 Specificity (negative_acc):0.6508 accuracy:0.7211
Epoch 28: loss: 0.86054
Sensitivity (poss_acc):0.8014 Specificity (negative_acc):0.6656 accuracy:0.7335
Replacing models: GraphSage_epoch_19.pt  link_predictor_epoch_19.pt
with: Best models at GraphSage_epoch_28.pt  link_predictor_epoch_28.pt
Saving Model in Path GraphSage_epoch_28.pt
Saving Model in Path link_predictor_epoch_28.pt
Epoch 29: loss: 0.8593
Sensitivity (poss_acc):0.8800 Specificity (negative_acc):0.6003 accuracy:0.7401
Replacing models: GraphSage_epoch_28.pt  link_predictor_epoch_28.pt
with: Best models at GraphSage_epoch_29.pt  link_predictor_epoch_29.pt
Saving Model in Path GraphSage_epoch_29.pt
Saving Model in Path link_predictor_epoch_29.pt
Epoch 30: loss: 0.84031
Sensitivity (poss_acc):0.7682 Specificity (negative_acc):0.6855 accuracy:0.7269
Epoch 31: loss: 0.82922
Sensitivity (poss_acc):0.8506 Specificity (negative_acc):0.5955 accuracy:0.7230
Epoch 32: loss: 0.89779
Sensitivity (poss_acc):0.9056 Specificity (negative_acc):0.5731 accuracy:0.7393
Epoch 33: loss: 0.81816
Sensitivity (poss_acc):0.9166 Specificity (negative_acc):0.5448 accuracy:0.7307
Epoch 34: loss: 0.83937
Sensitivity (poss_acc):0.8341 Specificity (negative_acc):0.6407 accuracy:0.7374
Epoch 35: loss: 0.80066
Sensitivity (poss_acc):0.8574 Specificity (negative_acc):0.6354 accuracy:0.7464
Replacing models: GraphSage_epoch_29.pt  link_predictor_epoch_29.pt
with: Best models at GraphSage_epoch_35.pt  link_predictor_epoch_35.pt
Saving Model in Path GraphSage_epoch_35.pt
Saving Model in Path link_predictor_epoch_35.pt
Epoch 36: loss: 0.82452
Sensitivity (poss_acc):0.8161 Specificity (negative_acc):0.6823 accuracy:0.7492
Replacing models: GraphSage_epoch_35.pt  link_predictor_epoch_35.pt
with: Best models at GraphSage_epoch_36.pt  link_predictor_epoch_36.pt
Saving Model in Path GraphSage_epoch_36.pt
Saving Model in Path link_predictor_epoch_36.pt
Epoch 37: loss: 0.795
Sensitivity (poss_acc):0.8560 Specificity (negative_acc):0.6546 accuracy:0.7553
Replacing models: GraphSage_epoch_36.pt  link_predictor_epoch_36.pt
with: Best models at GraphSage_epoch_37.pt  link_predictor_epoch_37.pt
Saving Model in Path GraphSage_epoch_37.pt
Saving Model in Path link_predictor_epoch_37.pt
Epoch 38: loss: 0.775
Sensitivity (poss_acc):0.7666 Specificity (negative_acc):0.7051 accuracy:0.7358
Epoch 39: loss: 0.77688
Sensitivity (poss_acc):0.8864 Specificity (negative_acc):0.5919 accuracy:0.7391
Epoch 40: loss: 0.77014
Youdens  index: 0.5298 Sensitivity: 0.825 Specificity: 0.6481
Epoch 41: loss: 0.77564
Sensitivity (poss_acc):0.8507 Specificity (negative_acc):0.6416 accuracy:0.7462
Epoch 42: loss: 0.76536
Sensitivity (poss_acc):0.8773 Specificity (negative_acc):0.6335 accuracy:0.7554
Replacing models: GraphSage_epoch_37.pt  link_predictor_epoch_37.pt
with: Best models at GraphSage_epoch_42.pt  link_predictor_epoch_42.pt
Saving Model in Path GraphSage_epoch_42.pt
Saving Model in Path link_predictor_epoch_42.pt
Epoch 43: loss: 0.75756
Sensitivity (poss_acc):0.8017 Specificity (negative_acc):0.6687 accuracy:0.7352
Epoch 44: loss: 0.77873
Sensitivity (poss_acc):0.8070 Specificity (negative_acc):0.7004 accuracy:0.7537
Epoch 45: loss: 0.75666
Sensitivity (poss_acc):0.8784 Specificity (negative_acc):0.6495 accuracy:0.7639
Replacing models: GraphSage_epoch_42.pt  link_predictor_epoch_42.pt
with: Best models at GraphSage_epoch_45.pt  link_predictor_epoch_45.pt
Saving Model in Path GraphSage_epoch_45.pt
Saving Model in Path link_predictor_epoch_45.pt
Epoch 46: loss: 0.73604
Sensitivity (poss_acc):0.8434 Specificity (negative_acc):0.6621 accuracy:0.7527
Epoch 47: loss: 0.71601
Sensitivity (poss_acc):0.8178 Specificity (negative_acc):0.6714 accuracy:0.7446
Epoch 48: loss: 0.73447
Sensitivity (poss_acc):0.8929 Specificity (negative_acc):0.6169 accuracy:0.7549
Epoch 49: loss: 0.70766
Sensitivity (poss_acc):0.8879 Specificity (negative_acc):0.6044 accuracy:0.7461
Epoch 50: loss: 0.721
Sensitivity (poss_acc):0.7702 Specificity (negative_acc):0.7172 accuracy:0.7437
Epoch 51: loss: 0.70365
Sensitivity (poss_acc):0.8941 Specificity (negative_acc):0.5911 accuracy:0.7426
Epoch 52: loss: 0.71855
Sensitivity (poss_acc):0.8371 Specificity (negative_acc):0.6921 accuracy:0.7646
Replacing models: GraphSage_epoch_45.pt  link_predictor_epoch_45.pt
with: Best models at GraphSage_epoch_52.pt  link_predictor_epoch_52.pt
Saving Model in Path GraphSage_epoch_52.pt
Saving Model in Path link_predictor_epoch_52.pt
Epoch 53: loss: 0.70317
Sensitivity (poss_acc):0.8851 Specificity (negative_acc):0.6400 accuracy:0.7626
Epoch 54: loss: 0.68315
Sensitivity (poss_acc):0.8620 Specificity (negative_acc):0.6639 accuracy:0.7629
Epoch 55: loss: 0.68344
Sensitivity (poss_acc):0.9168 Specificity (negative_acc):0.6041 accuracy:0.7605
Epoch 56: loss: 0.72247
Sensitivity (poss_acc):0.8332 Specificity (negative_acc):0.6505 accuracy:0.7419
Epoch 57: loss: 0.68305
Sensitivity (poss_acc):0.7903 Specificity (negative_acc):0.6858 accuracy:0.7380
Epoch 58: loss: 0.72189
Sensitivity (poss_acc):0.8622 Specificity (negative_acc):0.6615 accuracy:0.7618
Epoch 59: loss: 0.71029
Sensitivity (poss_acc):0.8834 Specificity (negative_acc):0.6440 accuracy:0.7637
Epoch 60: loss: 0.68376
Youdens  index: 0.6426 Sensitivity: 0.7956 Specificity: 0.7022
Epoch 61: loss: 0.66578
Sensitivity (poss_acc):0.8348 Specificity (negative_acc):0.7032 accuracy:0.7690
Replacing models: GraphSage_epoch_52.pt  link_predictor_epoch_52.pt
with: Best models at GraphSage_epoch_61.pt  link_predictor_epoch_61.pt
Saving Model in Path GraphSage_epoch_61.pt
Saving Model in Path link_predictor_epoch_61.pt
Epoch 62: loss: 0.6673
Sensitivity (poss_acc):0.8208 Specificity (negative_acc):0.7111 accuracy:0.7659
Epoch 63: loss: 0.68062
Sensitivity (poss_acc):0.8707 Specificity (negative_acc):0.6446 accuracy:0.7576
Epoch 64: loss: 0.6795
Sensitivity (poss_acc):0.8385 Specificity (negative_acc):0.6963 accuracy:0.7674
Epoch 65: loss: 0.66361
Sensitivity (poss_acc):0.8480 Specificity (negative_acc):0.6889 accuracy:0.7684
Epoch 66: loss: 0.62076
Sensitivity (poss_acc):0.8800 Specificity (negative_acc):0.6549 accuracy:0.7674
Epoch 67: loss: 0.65321
Sensitivity (poss_acc):0.8725 Specificity (negative_acc):0.6989 accuracy:0.7857
Replacing models: GraphSage_epoch_61.pt  link_predictor_epoch_61.pt
with: Best models at GraphSage_epoch_67.pt  link_predictor_epoch_67.pt
Saving Model in Path GraphSage_epoch_67.pt
Saving Model in Path link_predictor_epoch_67.pt
Epoch 68: loss: 0.65814
Sensitivity (poss_acc):0.8510 Specificity (negative_acc):0.6696 accuracy:0.7603
Epoch 69: loss: 0.61733
Sensitivity (poss_acc):0.8883 Specificity (negative_acc):0.6437 accuracy:0.7660
Epoch 70: loss: 0.62729
Sensitivity (poss_acc):0.8375 Specificity (negative_acc):0.6697 accuracy:0.7536
Epoch 71: loss: 0.63786
Sensitivity (poss_acc):0.8540 Specificity (negative_acc):0.6948 accuracy:0.7744
Epoch 72: loss: 0.61542
Sensitivity (poss_acc):0.8660 Specificity (negative_acc):0.6844 accuracy:0.7752
Epoch 73: loss: 0.63899
Sensitivity (poss_acc):0.9172 Specificity (negative_acc):0.6451 accuracy:0.7812
Epoch 74: loss: 0.62225
Sensitivity (poss_acc):0.9224 Specificity (negative_acc):0.6045 accuracy:0.7634
Epoch 75: loss: 0.61122
Sensitivity (poss_acc):0.8573 Specificity (negative_acc):0.6775 accuracy:0.7674
Epoch 76: loss: 0.63183
Sensitivity (poss_acc):0.8417 Specificity (negative_acc):0.6718 accuracy:0.7568
Epoch 77: loss: 0.60156
Sensitivity (poss_acc):0.8331 Specificity (negative_acc):0.7251 accuracy:0.7791
Epoch 78: loss: 0.60803
Sensitivity (poss_acc):0.8507 Specificity (negative_acc):0.6427 accuracy:0.7467
Epoch 79: loss: 0.62981
Sensitivity (poss_acc):0.8813 Specificity (negative_acc):0.6210 accuracy:0.7512
Epoch 80: loss: 0.62121
Youdens  index: 0.5663 Sensitivity: 0.8471 Specificity: 0.6592
Replacing models: GraphSage_epoch_67.pt  link_predictor_epoch_67.pt
with: Best models at GraphSage_epoch_80.pt  link_predictor_epoch_80.pt
Saving Model in Path GraphSage_epoch_80.pt
Saving Model in Path link_predictor_epoch_80.pt
Epoch 81: loss: 0.60267
Sensitivity (poss_acc):0.9296 Specificity (negative_acc):0.6217 accuracy:0.7756
Epoch 82: loss: 0.59262
Sensitivity (poss_acc):0.9133 Specificity (negative_acc):0.6490 accuracy:0.7811
Epoch 83: loss: 0.57688
Sensitivity (poss_acc):0.8874 Specificity (negative_acc):0.6519 accuracy:0.7697
Epoch 84: loss: 0.61293
Sensitivity (poss_acc):0.9245 Specificity (negative_acc):0.6087 accuracy:0.7666
Epoch 85: loss: 0.60371
Sensitivity (poss_acc):0.8326 Specificity (negative_acc):0.7372 accuracy:0.7849
Epoch 86: loss: 0.58238
Sensitivity (poss_acc):0.8584 Specificity (negative_acc):0.7173 accuracy:0.7879
Epoch 87: loss: 0.57882
Sensitivity (poss_acc):0.8350 Specificity (negative_acc):0.7388 accuracy:0.7869
Epoch 88: loss: 0.58094
Sensitivity (poss_acc):0.9041 Specificity (negative_acc):0.6514 accuracy:0.7778
Epoch 89: loss: 0.57736
Sensitivity (poss_acc):0.9035 Specificity (negative_acc):0.6471 accuracy:0.7753
Epoch 90: loss: 0.59027
Sensitivity (poss_acc):0.8923 Specificity (negative_acc):0.6594 accuracy:0.7759
Epoch 91: loss: 0.56539
Sensitivity (poss_acc):0.8236 Specificity (negative_acc):0.7368 accuracy:0.7802
Epoch 92: loss: 0.5552
Sensitivity (poss_acc):0.8738 Specificity (negative_acc):0.6527 accuracy:0.7633
Epoch 93: loss: 0.57432
Sensitivity (poss_acc):0.9030 Specificity (negative_acc):0.6750 accuracy:0.7890
Epoch 94: loss: 0.56306
Sensitivity (poss_acc):0.9061 Specificity (negative_acc):0.6587 accuracy:0.7824
Epoch 95: loss: 0.55674
Sensitivity (poss_acc):0.9025 Specificity (negative_acc):0.6688 accuracy:0.7857
Epoch 96: loss: 0.55312
Sensitivity (poss_acc):0.8650 Specificity (negative_acc):0.7189 accuracy:0.7920
Epoch 97: loss: 0.54806
Sensitivity (poss_acc):0.9043 Specificity (negative_acc):0.6350 accuracy:0.7697
Epoch 98: loss: 0.54841
Sensitivity (poss_acc):0.8942 Specificity (negative_acc):0.6665 accuracy:0.7803
Epoch 99: loss: 0.55615
Sensitivity (poss_acc):0.9013 Specificity (negative_acc):0.6701 accuracy:0.7857
Epoch 100: loss: 0.54454
Youdens  index: 0.4448 Sensitivity: 0.8937 Specificity: 0.6138
Epoch 101: loss: 0.54446
Sensitivity (poss_acc):0.8894 Specificity (negative_acc):0.6551 accuracy:0.7723
Epoch 102: loss: 0.5723
Sensitivity (poss_acc):0.8506 Specificity (negative_acc):0.6718 accuracy:0.7612
Epoch 103: loss: 0.56733
Sensitivity (poss_acc):0.8526 Specificity (negative_acc):0.6583 accuracy:0.7554
Epoch 104: loss: 0.58279
Sensitivity (poss_acc):0.8929 Specificity (negative_acc):0.6595 accuracy:0.7762
Epoch 105: loss: 0.55634
Sensitivity (poss_acc):0.8726 Specificity (negative_acc):0.7020 accuracy:0.7873
Epoch 106: loss: 0.52631
Sensitivity (poss_acc):0.8754 Specificity (negative_acc):0.6962 accuracy:0.7858
Epoch 107: loss: 0.53896
Sensitivity (poss_acc):0.9066 Specificity (negative_acc):0.6293 accuracy:0.7680
Epoch 108: loss: 0.54728
Sensitivity (poss_acc):0.8757 Specificity (negative_acc):0.6988 accuracy:0.7872
Epoch 109: loss: 0.54289
Sensitivity (poss_acc):0.8233 Specificity (negative_acc):0.7388 accuracy:0.7811
Epoch 110: loss: 0.57868
Sensitivity (poss_acc):0.8988 Specificity (negative_acc):0.6629 accuracy:0.7808
Epoch 111: loss: 0.54878
Sensitivity (poss_acc):0.8878 Specificity (negative_acc):0.6634 accuracy:0.7756
Epoch 112: loss: 0.52526
Sensitivity (poss_acc):0.8668 Specificity (negative_acc):0.6882 accuracy:0.7775
Epoch 113: loss: 0.50896
Sensitivity (poss_acc):0.8924 Specificity (negative_acc):0.6953 accuracy:0.7939
Replacing models: GraphSage_epoch_80.pt  link_predictor_epoch_80.pt
with: Best models at GraphSage_epoch_113.pt  link_predictor_epoch_113.pt
Saving Model in Path GraphSage_epoch_113.pt
Saving Model in Path link_predictor_epoch_113.pt
Epoch 114: loss: 0.50759
Sensitivity (poss_acc):0.8995 Specificity (negative_acc):0.6727 accuracy:0.7861
Epoch 115: loss: 0.50268
Sensitivity (poss_acc):0.8969 Specificity (negative_acc):0.6606 accuracy:0.7788
Epoch 116: loss: 0.50792
Sensitivity (poss_acc):0.9244 Specificity (negative_acc):0.6078 accuracy:0.7661
Epoch 117: loss: 0.52405
Sensitivity (poss_acc):0.9112 Specificity (negative_acc):0.6921 accuracy:0.8017
Replacing models: GraphSage_epoch_113.pt  link_predictor_epoch_113.pt
with: Best models at GraphSage_epoch_117.pt  link_predictor_epoch_117.pt
Saving Model in Path GraphSage_epoch_117.pt
Saving Model in Path link_predictor_epoch_117.pt
Epoch 118: loss: 0.51385
Sensitivity (poss_acc):0.9144 Specificity (negative_acc):0.6564 accuracy:0.7854
Epoch 119: loss: 0.50277
Sensitivity (poss_acc):0.7894 Specificity (negative_acc):0.7720 accuracy:0.7807
Epoch 120: loss: 0.55554
Youdens  index: 0.8903 Sensitivity: 0.7731 Specificity: 0.7513
Epoch 121: loss: 0.52758
Sensitivity (poss_acc):0.8491 Specificity (negative_acc):0.7034 accuracy:0.7762
Epoch 122: loss: 0.51773
Sensitivity (poss_acc):0.8961 Specificity (negative_acc):0.6889 accuracy:0.7925
Epoch 123: loss: 0.5199
Sensitivity (poss_acc):0.9011 Specificity (negative_acc):0.6201 accuracy:0.7606
Epoch 124: loss: 0.49275
Sensitivity (poss_acc):0.9145 Specificity (negative_acc):0.6465 accuracy:0.7805
Epoch 125: loss: 0.48386
Sensitivity (poss_acc):0.9110 Specificity (negative_acc):0.6463 accuracy:0.7786
Epoch 126: loss: 0.48924
Sensitivity (poss_acc):0.8364 Specificity (negative_acc):0.7269 accuracy:0.7817
Epoch 127: loss: 0.51036
Sensitivity (poss_acc):0.8763 Specificity (negative_acc):0.7330 accuracy:0.8047
Replacing models: GraphSage_epoch_117.pt  link_predictor_epoch_117.pt
with: Best models at GraphSage_epoch_127.pt  link_predictor_epoch_127.pt
Saving Model in Path GraphSage_epoch_127.pt
Saving Model in Path link_predictor_epoch_127.pt
Epoch 128: loss: 0.49851
Sensitivity (poss_acc):0.8669 Specificity (negative_acc):0.7206 accuracy:0.7937
Epoch 129: loss: 0.50085
Sensitivity (poss_acc):0.9474 Specificity (negative_acc):0.6183 accuracy:0.7829
Epoch 130: loss: 0.54889
Sensitivity (poss_acc):0.6257 Specificity (negative_acc):0.8309 accuracy:0.7283
Epoch 131: loss: 0.55055
Sensitivity (poss_acc):0.8653 Specificity (negative_acc):0.6874 accuracy:0.7763
Epoch 132: loss: 0.51206
Sensitivity (poss_acc):0.9042 Specificity (negative_acc):0.6420 accuracy:0.7731
Epoch 133: loss: 0.51192
Sensitivity (poss_acc):0.8775 Specificity (negative_acc):0.6130 accuracy:0.7452
Epoch 134: loss: 0.50242
Sensitivity (poss_acc):0.8995 Specificity (negative_acc):0.6712 accuracy:0.7854
Epoch 135: loss: 0.48485
Sensitivity (poss_acc):0.9119 Specificity (negative_acc):0.6743 accuracy:0.7931
Epoch 136: loss: 0.48699
Sensitivity (poss_acc):0.8436 Specificity (negative_acc):0.7155 accuracy:0.7796
Epoch 137: loss: 0.49194
Sensitivity (poss_acc):0.8512 Specificity (negative_acc):0.6830 accuracy:0.7671
Epoch 138: loss: 0.50101
Sensitivity (poss_acc):0.9332 Specificity (negative_acc):0.6543 accuracy:0.7938
Epoch 139: loss: 0.47573
Sensitivity (poss_acc):0.8989 Specificity (negative_acc):0.6814 accuracy:0.7901
Epoch 140: loss: 0.49843
Youdens  index: 0.8106 Sensitivity: 0.7878 Specificity: 0.7682
Epoch 141: loss: 0.49341
Sensitivity (poss_acc):0.9493 Specificity (negative_acc):0.6303 accuracy:0.7898
Epoch 142: loss: 0.49255
Sensitivity (poss_acc):0.9033 Specificity (negative_acc):0.6476 accuracy:0.7754
Epoch 143: loss: 0.50336
Sensitivity (poss_acc):0.9380 Specificity (negative_acc):0.5859 accuracy:0.7620
Epoch 144: loss: 0.50648
Sensitivity (poss_acc):0.8858 Specificity (negative_acc):0.7136 accuracy:0.7997
Epoch 145: loss: 0.47623
Sensitivity (poss_acc):0.9039 Specificity (negative_acc):0.6729 accuracy:0.7884
Epoch 146: loss: 0.4612
Sensitivity (poss_acc):0.8685 Specificity (negative_acc):0.7316 accuracy:0.8000
Epoch 147: loss: 0.4581
Sensitivity (poss_acc):0.9303 Specificity (negative_acc):0.6462 accuracy:0.7883
Epoch 148: loss: 0.48994
Sensitivity (poss_acc):0.8567 Specificity (negative_acc):0.7341 accuracy:0.7954
Epoch 149: loss: 0.48878
Sensitivity (poss_acc):0.9125 Specificity (negative_acc):0.6570 accuracy:0.7847
Epoch 150: loss: 0.53287
Sensitivity (poss_acc):0.8979 Specificity (negative_acc):0.6948 accuracy:0.7963
Epoch 151: loss: 0.49147
Sensitivity (poss_acc):0.9002 Specificity (negative_acc):0.6850 accuracy:0.7926
Epoch 152: loss: 0.46707
Sensitivity (poss_acc):0.9427 Specificity (negative_acc):0.6313 accuracy:0.7870
Epoch 153: loss: 0.48187
Sensitivity (poss_acc):0.9323 Specificity (negative_acc):0.6508 accuracy:0.7916
Epoch 154: loss: 0.47412
Sensitivity (poss_acc):0.9231 Specificity (negative_acc):0.6634 accuracy:0.7933
Epoch 155: loss: 0.46019
Sensitivity (poss_acc):0.9138 Specificity (negative_acc):0.6684 accuracy:0.7911
Epoch 156: loss: 0.45743
Sensitivity (poss_acc):0.8920 Specificity (negative_acc):0.6928 accuracy:0.7924
Epoch 157: loss: 0.46888
Sensitivity (poss_acc):0.9020 Specificity (negative_acc):0.7071 accuracy:0.8045
Epoch 158: loss: 0.45439
Sensitivity (poss_acc):0.9209 Specificity (negative_acc):0.6748 accuracy:0.7979
Epoch 159: loss: 0.45289
Sensitivity (poss_acc):0.8891 Specificity (negative_acc):0.6905 accuracy:0.7898
Epoch 160: loss: 0.44807
Youdens  index: 0.8163 Sensitivity: 0.8043 Specificity: 0.7319
Epoch 161: loss: 0.49089
Sensitivity (poss_acc):0.9219 Specificity (negative_acc):0.6560 accuracy:0.7890
Epoch 162: loss: 0.47265
Sensitivity (poss_acc):0.9236 Specificity (negative_acc):0.6515 accuracy:0.7875
Epoch 163: loss: 0.44
Sensitivity (poss_acc):0.9045 Specificity (negative_acc):0.6998 accuracy:0.8021
Epoch 164: loss: 0.44266
Sensitivity (poss_acc):0.8685 Specificity (negative_acc):0.7099 accuracy:0.7892
Epoch 165: loss: 0.45557
Sensitivity (poss_acc):0.9253 Specificity (negative_acc):0.6358 accuracy:0.7805
Epoch 166: loss: 0.44287
Sensitivity (poss_acc):0.8703 Specificity (negative_acc):0.7072 accuracy:0.7888
Epoch 167: loss: 0.48216
Sensitivity (poss_acc):0.9269 Specificity (negative_acc):0.6661 accuracy:0.7965
Epoch 168: loss: 0.47142
Sensitivity (poss_acc):0.9055 Specificity (negative_acc):0.7056 accuracy:0.8055
Replacing models: GraphSage_epoch_127.pt  link_predictor_epoch_127.pt
with: Best models at GraphSage_epoch_168.pt  link_predictor_epoch_168.pt
Saving Model in Path GraphSage_epoch_168.pt
Saving Model in Path link_predictor_epoch_168.pt
Epoch 169: loss: 0.43165
Sensitivity (poss_acc):0.9116 Specificity (negative_acc):0.6951 accuracy:0.8033
Epoch 170: loss: 0.47262
Sensitivity (poss_acc):0.8697 Specificity (negative_acc):0.6667 accuracy:0.7682
Epoch 171: loss: 0.61125
Sensitivity (poss_acc):0.9161 Specificity (negative_acc):0.6978 accuracy:0.8070
Replacing models: GraphSage_epoch_168.pt  link_predictor_epoch_168.pt
with: Best models at GraphSage_epoch_171.pt  link_predictor_epoch_171.pt
Saving Model in Path GraphSage_epoch_171.pt
Saving Model in Path link_predictor_epoch_171.pt
Epoch 172: loss: 0.46705
Sensitivity (poss_acc):0.9193 Specificity (negative_acc):0.6860 accuracy:0.8027
Epoch 173: loss: 0.44765
Sensitivity (poss_acc):0.9180 Specificity (negative_acc):0.6723 accuracy:0.7951
Epoch 174: loss: 0.43044
Sensitivity (poss_acc):0.9091 Specificity (negative_acc):0.6971 accuracy:0.8031
Epoch 175: loss: 0.45681
Sensitivity (poss_acc):0.9198 Specificity (negative_acc):0.6693 accuracy:0.7945
Epoch 176: loss: 0.466
Sensitivity (poss_acc):0.8678 Specificity (negative_acc):0.6825 accuracy:0.7752
Epoch 177: loss: 0.54062
Sensitivity (poss_acc):0.9125 Specificity (negative_acc):0.6593 accuracy:0.7859
Epoch 178: loss: 0.48161
Sensitivity (poss_acc):0.9141 Specificity (negative_acc):0.6930 accuracy:0.8036
Epoch 179: loss: 0.45612
Sensitivity (poss_acc):0.9156 Specificity (negative_acc):0.6663 accuracy:0.7910
Epoch 180: loss: 0.43715
Youdens  index: 0.8723 Sensitivity: 0.8152 Specificity: 0.728
Epoch 181: loss: 0.42755
Sensitivity (poss_acc):0.9248 Specificity (negative_acc):0.6706 accuracy:0.7977
Epoch 182: loss: 0.41749
Sensitivity (poss_acc):0.9439 Specificity (negative_acc):0.6517 accuracy:0.7978
Epoch 183: loss: 0.42708
Sensitivity (poss_acc):0.8720 Specificity (negative_acc):0.7587 accuracy:0.8154
Replacing models: GraphSage_epoch_171.pt  link_predictor_epoch_171.pt
with: Best models at GraphSage_epoch_183.pt  link_predictor_epoch_183.pt
Saving Model in Path GraphSage_epoch_183.pt
Saving Model in Path link_predictor_epoch_183.pt
Epoch 184: loss: 0.41298
Sensitivity (poss_acc):0.9118 Specificity (negative_acc):0.7048 accuracy:0.8083
Epoch 185: loss: 0.41202
Sensitivity (poss_acc):0.9100 Specificity (negative_acc):0.6900 accuracy:0.8000
Epoch 186: loss: 0.40708
Sensitivity (poss_acc):0.9198 Specificity (negative_acc):0.6820 accuracy:0.8009
Epoch 187: loss: 0.40626
Sensitivity (poss_acc):0.8890 Specificity (negative_acc):0.7266 accuracy:0.8078
Epoch 188: loss: 0.40534
Sensitivity (poss_acc):0.9348 Specificity (negative_acc):0.6586 accuracy:0.7967
Epoch 189: loss: 0.4076
Sensitivity (poss_acc):0.9150 Specificity (negative_acc):0.7113 accuracy:0.8132
Epoch 190: loss: 0.45307
Sensitivity (poss_acc):0.9209 Specificity (negative_acc):0.6623 accuracy:0.7916
Epoch 191: loss: 0.44397
Sensitivity (poss_acc):0.9187 Specificity (negative_acc):0.6886 accuracy:0.8036
Epoch 192: loss: 0.42787
Sensitivity (poss_acc):0.9268 Specificity (negative_acc):0.6716 accuracy:0.7992
Epoch 193: loss: 0.42432
Sensitivity (poss_acc):0.9124 Specificity (negative_acc):0.7081 accuracy:0.8102
Epoch 194: loss: 0.41286
Sensitivity (poss_acc):0.9431 Specificity (negative_acc):0.6466 accuracy:0.7949
Epoch 195: loss: 0.3983
Sensitivity (poss_acc):0.8974 Specificity (negative_acc):0.7192 accuracy:0.8083
Epoch 196: loss: 0.4047
Sensitivity (poss_acc):0.9017 Specificity (negative_acc):0.7000 accuracy:0.8008
Epoch 197: loss: 0.41938
Sensitivity (poss_acc):0.9122 Specificity (negative_acc):0.7020 accuracy:0.8071
Epoch 198: loss: 0.41011
Sensitivity (poss_acc):0.8877 Specificity (negative_acc):0.6849 accuracy:0.7863
Epoch 199: loss: 0.40851
Sensitivity (poss_acc):0.9508 Specificity (negative_acc):0.6040 accuracy:0.7774
Epoch 200: loss: 0.40208
Youdens  index: 0.8050 Sensitivity: 0.8685 Specificity: 0.6462
Epoch 201: loss: 0.4103
Sensitivity (poss_acc):0.9197 Specificity (negative_acc):0.6839 accuracy:0.8018
Epoch 202: loss: 0.40747
Sensitivity (poss_acc):0.8880 Specificity (negative_acc):0.7392 accuracy:0.8136
Epoch 203: loss: 0.41031
Sensitivity (poss_acc):0.9370 Specificity (negative_acc):0.6643 accuracy:0.8007
Epoch 204: loss: 0.43305
Sensitivity (poss_acc):0.8786 Specificity (negative_acc):0.7546 accuracy:0.8166
Replacing models: GraphSage_epoch_183.pt  link_predictor_epoch_183.pt
with: Best models at GraphSage_epoch_204.pt  link_predictor_epoch_204.pt
Saving Model in Path GraphSage_epoch_204.pt
Saving Model in Path link_predictor_epoch_204.pt
Epoch 205: loss: 0.42921
Sensitivity (poss_acc):0.9255 Specificity (negative_acc):0.6437 accuracy:0.7846
Epoch 206: loss: 0.40325
Sensitivity (poss_acc):0.8794 Specificity (negative_acc):0.7583 accuracy:0.8188
Replacing models: GraphSage_epoch_204.pt  link_predictor_epoch_204.pt
with: Best models at GraphSage_epoch_206.pt  link_predictor_epoch_206.pt
Saving Model in Path GraphSage_epoch_206.pt
Saving Model in Path link_predictor_epoch_206.pt
Epoch 207: loss: 0.42156
Sensitivity (poss_acc):0.9212 Specificity (negative_acc):0.6752 accuracy:0.7982
Epoch 208: loss: 0.41784
Sensitivity (poss_acc):0.9274 Specificity (negative_acc):0.6669 accuracy:0.7972
Epoch 209: loss: 0.40038
Sensitivity (poss_acc):0.9144 Specificity (negative_acc):0.7032 accuracy:0.8088
Epoch 210: loss: 0.37098
Sensitivity (poss_acc):0.9144 Specificity (negative_acc):0.6935 accuracy:0.8040
Epoch 211: loss: 0.36849
Sensitivity (poss_acc):0.9085 Specificity (negative_acc):0.6990 accuracy:0.8037
Epoch 212: loss: 0.38473
Sensitivity (poss_acc):0.9147 Specificity (negative_acc):0.7057 accuracy:0.8102
Epoch 213: loss: 0.37492
Sensitivity (poss_acc):0.9260 Specificity (negative_acc):0.6797 accuracy:0.8029
Epoch 214: loss: 0.3749
Sensitivity (poss_acc):0.9214 Specificity (negative_acc):0.6857 accuracy:0.8036
Epoch 215: loss: 0.39814
Sensitivity (poss_acc):0.9321 Specificity (negative_acc):0.6463 accuracy:0.7892
Epoch 216: loss: 0.459
Sensitivity (poss_acc):0.9046 Specificity (negative_acc):0.6838 accuracy:0.7942
Epoch 217: loss: 0.45932
Sensitivity (poss_acc):0.9157 Specificity (negative_acc):0.7072 accuracy:0.8115
Epoch 218: loss: 0.41404
Sensitivity (poss_acc):0.9352 Specificity (negative_acc):0.6760 accuracy:0.8056
Epoch 219: loss: 0.39108
Sensitivity (poss_acc):0.8974 Specificity (negative_acc):0.7331 accuracy:0.8152
Epoch 220: loss: 0.37651
Youdens  index: 0.7470 Sensitivity: 0.8334 Specificity: 0.6935
Epoch 221: loss: 0.37296
Sensitivity (poss_acc):0.9149 Specificity (negative_acc):0.6996 accuracy:0.8072
Epoch 222: loss: 0.36198
Sensitivity (poss_acc):0.8977 Specificity (negative_acc):0.7271 accuracy:0.8124
Epoch 223: loss: 0.36658
Sensitivity (poss_acc):0.9045 Specificity (negative_acc):0.7249 accuracy:0.8147
Epoch 224: loss: 0.40081
Sensitivity (poss_acc):0.9213 Specificity (negative_acc):0.6180 accuracy:0.7697
Epoch 225: loss: 0.40396
Sensitivity (poss_acc):0.8988 Specificity (negative_acc):0.7054 accuracy:0.8021
Epoch 226: loss: 0.37393
Sensitivity (poss_acc):0.9002 Specificity (negative_acc):0.7243 accuracy:0.8123
Epoch 227: loss: 0.36643
Sensitivity (poss_acc):0.9167 Specificity (negative_acc):0.7135 accuracy:0.8151
Epoch 228: loss: 0.35272
Sensitivity (poss_acc):0.9018 Specificity (negative_acc):0.6904 accuracy:0.7961
Epoch 229: loss: 0.36281
Sensitivity (poss_acc):0.9305 Specificity (negative_acc):0.6779 accuracy:0.8042
Epoch 230: loss: 0.38086
Sensitivity (poss_acc):0.9119 Specificity (negative_acc):0.7000 accuracy:0.8060
Epoch 231: loss: 0.37236
Sensitivity (poss_acc):0.9165 Specificity (negative_acc):0.7024 accuracy:0.8095
Epoch 232: loss: 0.3733
Sensitivity (poss_acc):0.9305 Specificity (negative_acc):0.6702 accuracy:0.8004
Epoch 233: loss: 0.37444
Sensitivity (poss_acc):0.8984 Specificity (negative_acc):0.6952 accuracy:0.7968
Epoch 234: loss: 0.35352
Sensitivity (poss_acc):0.9126 Specificity (negative_acc):0.6985 accuracy:0.8056
Epoch 235: loss: 0.35052
Sensitivity (poss_acc):0.9115 Specificity (negative_acc):0.7056 accuracy:0.8085
Epoch 236: loss: 0.35984
Sensitivity (poss_acc):0.9219 Specificity (negative_acc):0.7035 accuracy:0.8127
Epoch 237: loss: 0.39235
Sensitivity (poss_acc):0.9239 Specificity (negative_acc):0.6965 accuracy:0.8102
Epoch 238: loss: 0.38771
Sensitivity (poss_acc):0.8825 Specificity (negative_acc):0.7139 accuracy:0.7982
Epoch 239: loss: 0.36623
Sensitivity (poss_acc):0.9317 Specificity (negative_acc):0.6673 accuracy:0.7995
Epoch 240: loss: 0.35054
Youdens  index: 0.7685 Sensitivity: 0.8625 Specificity: 0.6838
Epoch 241: loss: 0.34954
Sensitivity (poss_acc):0.8987 Specificity (negative_acc):0.7206 accuracy:0.8096
Epoch 242: loss: 0.33929
Sensitivity (poss_acc):0.9120 Specificity (negative_acc):0.7079 accuracy:0.8100
Epoch 243: loss: 0.34533
Sensitivity (poss_acc):0.9267 Specificity (negative_acc):0.7034 accuracy:0.8151
Epoch 244: loss: 0.41143
Sensitivity (poss_acc):0.8742 Specificity (negative_acc):0.7312 accuracy:0.8027
Epoch 245: loss: 0.40834
Sensitivity (poss_acc):0.9291 Specificity (negative_acc):0.6405 accuracy:0.7848
Epoch 246: loss: 0.39436
Sensitivity (poss_acc):0.9190 Specificity (negative_acc):0.6853 accuracy:0.8022
Epoch 247: loss: 0.3475
Sensitivity (poss_acc):0.9343 Specificity (negative_acc):0.6675 accuracy:0.8009
Epoch 248: loss: 0.35281
Sensitivity (poss_acc):0.9211 Specificity (negative_acc):0.6328 accuracy:0.7769
Epoch 249: loss: 0.34568
Sensitivity (poss_acc):0.9172 Specificity (negative_acc):0.7051 accuracy:0.8112
Epoch 250: loss: 0.33825
Sensitivity (poss_acc):0.9178 Specificity (negative_acc):0.6890 accuracy:0.8034
Epoch 251: loss: 0.33479
Sensitivity (poss_acc):0.9357 Specificity (negative_acc):0.6899 accuracy:0.8128
Epoch 252: loss: 0.32778
Sensitivity (poss_acc):0.9049 Specificity (negative_acc):0.7105 accuracy:0.8077
Epoch 253: loss: 0.32766
Sensitivity (poss_acc):0.9207 Specificity (negative_acc):0.6917 accuracy:0.8062
Epoch 254: loss: 0.32788
Sensitivity (poss_acc):0.9353 Specificity (negative_acc):0.6604 accuracy:0.7979
Epoch 255: loss: 0.35386
Sensitivity (poss_acc):0.9138 Specificity (negative_acc):0.7067 accuracy:0.8103
Epoch 256: loss: 0.33551
Sensitivity (poss_acc):0.9296 Specificity (negative_acc):0.6746 accuracy:0.8021
Epoch 257: loss: 0.34903
Sensitivity (poss_acc):0.9326 Specificity (negative_acc):0.6740 accuracy:0.8033
Epoch 258: loss: 0.34495
Sensitivity (poss_acc):0.9302 Specificity (negative_acc):0.6925 accuracy:0.8113
Epoch 259: loss: 0.33097
Sensitivity (poss_acc):0.9193 Specificity (negative_acc):0.6901 accuracy:0.8047
Epoch 260: loss: 0.32369
Youdens  index: 0.8636 Sensitivity: 0.8352 Specificity: 0.7301
Epoch 261: loss: 0.34254
Sensitivity (poss_acc):0.9362 Specificity (negative_acc):0.6633 accuracy:0.7998
Epoch 262: loss: 0.33674
Sensitivity (poss_acc):0.8981 Specificity (negative_acc):0.7273 accuracy:0.8127
Epoch 263: loss: 0.38279
Sensitivity (poss_acc):0.5439 Specificity (negative_acc):0.8548 accuracy:0.6994
Epoch 264: loss: 0.48767
Sensitivity (poss_acc):0.8254 Specificity (negative_acc):0.7355 accuracy:0.7805
Epoch 265: loss: 0.36447
Sensitivity (poss_acc):0.8628 Specificity (negative_acc):0.7420 accuracy:0.8024
Epoch 266: loss: 0.34492
Sensitivity (poss_acc):0.9068 Specificity (negative_acc):0.7151 accuracy:0.8109
Epoch 267: loss: 0.32435
Sensitivity (poss_acc):0.9105 Specificity (negative_acc):0.7026 accuracy:0.8065
Epoch 268: loss: 0.32409
Sensitivity (poss_acc):0.9014 Specificity (negative_acc):0.7120 accuracy:0.8067
Epoch 269: loss: 0.32108
Sensitivity (poss_acc):0.9313 Specificity (negative_acc):0.6747 accuracy:0.8030
Epoch 270: loss: 0.3237
Sensitivity (poss_acc):0.9210 Specificity (negative_acc):0.7061 accuracy:0.8135
Epoch 271: loss: 0.32685
Sensitivity (poss_acc):0.9401 Specificity (negative_acc):0.6747 accuracy:0.8074
Epoch 272: loss: 0.32929
Sensitivity (poss_acc):0.9032 Specificity (negative_acc):0.7093 accuracy:0.8062
Epoch 273: loss: 0.31754
Sensitivity (poss_acc):0.8953 Specificity (negative_acc):0.7217 accuracy:0.8085
Epoch 274: loss: 0.31051
Sensitivity (poss_acc):0.9149 Specificity (negative_acc):0.7113 accuracy:0.8131
Epoch 275: loss: 0.30441
Sensitivity (poss_acc):0.8978 Specificity (negative_acc):0.7097 accuracy:0.8038
Epoch 276: loss: 0.31611
Sensitivity (poss_acc):0.9033 Specificity (negative_acc):0.7165 accuracy:0.8099
Epoch 277: loss: 0.339
Sensitivity (poss_acc):0.9191 Specificity (negative_acc):0.6874 accuracy:0.8032
Epoch 278: loss: 0.30854
Sensitivity (poss_acc):0.8892 Specificity (negative_acc):0.7273 accuracy:0.8083
Epoch 279: loss: 0.30588
Sensitivity (poss_acc):0.9110 Specificity (negative_acc):0.7136 accuracy:0.8123
Epoch 280: loss: 0.3044
Youdens  index: 0.8684 Sensitivity: 0.8255 Specificity: 0.7423
Epoch 281: loss: 0.31266
Sensitivity (poss_acc):0.9100 Specificity (negative_acc):0.7139 accuracy:0.8119
Epoch 282: loss: 0.34434
Sensitivity (poss_acc):0.9148 Specificity (negative_acc):0.6951 accuracy:0.8050
Epoch 283: loss: 0.356
Sensitivity (poss_acc):0.9467 Specificity (negative_acc):0.6041 accuracy:0.7754
Epoch 284: loss: 0.37104
Sensitivity (poss_acc):0.9132 Specificity (negative_acc):0.7085 accuracy:0.8109
Epoch 285: loss: 0.41003
Sensitivity (poss_acc):0.9130 Specificity (negative_acc):0.6852 accuracy:0.7991
Epoch 286: loss: 0.31963
Sensitivity (poss_acc):0.9146 Specificity (negative_acc):0.7064 accuracy:0.8105
Epoch 287: loss: 0.29864
Sensitivity (poss_acc):0.9220 Specificity (negative_acc):0.6982 accuracy:0.8101
Epoch 288: loss: 0.29035
Sensitivity (poss_acc):0.9211 Specificity (negative_acc):0.7120 accuracy:0.8166
Epoch 289: loss: 0.28872
Sensitivity (poss_acc):0.9180 Specificity (negative_acc):0.7109 accuracy:0.8144
Epoch 290: loss: 0.2885
Sensitivity (poss_acc):0.9079 Specificity (negative_acc):0.7042 accuracy:0.8061
Epoch 291: loss: 0.28131
Sensitivity (poss_acc):0.9179 Specificity (negative_acc):0.7221 accuracy:0.8200
Replacing models: GraphSage_epoch_206.pt  link_predictor_epoch_206.pt
with: Best models at GraphSage_epoch_291.pt  link_predictor_epoch_291.pt
Saving Model in Path GraphSage_epoch_291.pt
Saving Model in Path link_predictor_epoch_291.pt
Epoch 292: loss: 0.28524
Sensitivity (poss_acc):0.9307 Specificity (negative_acc):0.6792 accuracy:0.8050
Epoch 293: loss: 0.27918
Sensitivity (poss_acc):0.9019 Specificity (negative_acc):0.7214 accuracy:0.8116
Epoch 294: loss: 0.28873
Sensitivity (poss_acc):0.9255 Specificity (negative_acc):0.6810 accuracy:0.8033
Epoch 295: loss: 0.29937
Sensitivity (poss_acc):0.9420 Specificity (negative_acc):0.6690 accuracy:0.8055
Epoch 296: loss: 0.31016
Sensitivity (poss_acc):0.9117 Specificity (negative_acc):0.6966 accuracy:0.8042
Epoch 297: loss: 0.31863
Sensitivity (poss_acc):0.8969 Specificity (negative_acc):0.7367 accuracy:0.8168
Epoch 298: loss: 0.30645
Sensitivity (poss_acc):0.9004 Specificity (negative_acc):0.7192 accuracy:0.8098
Epoch 299: loss: 0.32054
Sensitivity (poss_acc):0.9291 Specificity (negative_acc):0.6969 accuracy:0.8130
Epoch 300: loss: 0.32326
Youdens  index: 0.8774 Sensitivity: 0.8498 Specificity: 0.737
Epoch 301: loss: 0.29137
Sensitivity (poss_acc):0.9161 Specificity (negative_acc):0.7305 accuracy:0.8233
Replacing models: GraphSage_epoch_291.pt  link_predictor_epoch_291.pt
with: Best models at GraphSage_epoch_301.pt  link_predictor_epoch_301.pt
Saving Model in Path GraphSage_epoch_301.pt
Saving Model in Path link_predictor_epoch_301.pt
Epoch 302: loss: 0.30295
Sensitivity (poss_acc):0.9140 Specificity (negative_acc):0.7151 accuracy:0.8146
Epoch 303: loss: 0.29503
Sensitivity (poss_acc):0.9399 Specificity (negative_acc):0.7023 accuracy:0.8211
Epoch 304: loss: 0.27937
Sensitivity (poss_acc):0.9195 Specificity (negative_acc):0.7122 accuracy:0.8159
Epoch 305: loss: 0.29081
Sensitivity (poss_acc):0.9257 Specificity (negative_acc):0.6959 accuracy:0.8108
Epoch 306: loss: 0.31621
Sensitivity (poss_acc):0.9212 Specificity (negative_acc):0.7136 accuracy:0.8174
Epoch 307: loss: 0.27997
Sensitivity (poss_acc):0.9203 Specificity (negative_acc):0.7062 accuracy:0.8133
Epoch 308: loss: 0.3185
Sensitivity (poss_acc):0.8559 Specificity (negative_acc):0.7480 accuracy:0.8020
Epoch 309: loss: 0.3216
Sensitivity (poss_acc):0.9458 Specificity (negative_acc):0.6806 accuracy:0.8132
Epoch 310: loss: 0.32574
Sensitivity (poss_acc):0.9323 Specificity (negative_acc):0.7062 accuracy:0.8193
Epoch 311: loss: 0.2875
Sensitivity (poss_acc):0.9044 Specificity (negative_acc):0.7480 accuracy:0.8262
Replacing models: GraphSage_epoch_301.pt  link_predictor_epoch_301.pt
with: Best models at GraphSage_epoch_311.pt  link_predictor_epoch_311.pt
Saving Model in Path GraphSage_epoch_311.pt
Saving Model in Path link_predictor_epoch_311.pt
Epoch 312: loss: 0.26868
Sensitivity (poss_acc):0.9264 Specificity (negative_acc):0.7044 accuracy:0.8154
Epoch 313: loss: 0.26539
Sensitivity (poss_acc):0.9263 Specificity (negative_acc):0.7039 accuracy:0.8151
Epoch 314: loss: 0.27278
Sensitivity (poss_acc):0.9304 Specificity (negative_acc):0.7035 accuracy:0.8170
Epoch 315: loss: 0.27866
Sensitivity (poss_acc):0.9092 Specificity (negative_acc):0.7336 accuracy:0.8214
Epoch 316: loss: 0.27996
Sensitivity (poss_acc):0.9247 Specificity (negative_acc):0.7157 accuracy:0.8202
Epoch 317: loss: 0.2774
Sensitivity (poss_acc):0.9422 Specificity (negative_acc):0.6833 accuracy:0.8127
Epoch 318: loss: 0.29832
Sensitivity (poss_acc):0.9286 Specificity (negative_acc):0.6972 accuracy:0.8129
Epoch 319: loss: 0.31629
Sensitivity (poss_acc):0.9385 Specificity (negative_acc):0.6817 accuracy:0.8101
Epoch 320: loss: 0.29874
Youdens  index: 0.6011 Sensitivity: 0.8919 Specificity: 0.6917
Epoch 321: loss: 0.27478
Sensitivity (poss_acc):0.9296 Specificity (negative_acc):0.7037 accuracy:0.8166
Epoch 322: loss: 0.26487
Sensitivity (poss_acc):0.9121 Specificity (negative_acc):0.7153 accuracy:0.8137
Epoch 323: loss: 0.2636
Sensitivity (poss_acc):0.9221 Specificity (negative_acc):0.7217 accuracy:0.8219
Epoch 324: loss: 0.26743
Sensitivity (poss_acc):0.9144 Specificity (negative_acc):0.7314 accuracy:0.8229
Epoch 325: loss: 0.26381
Sensitivity (poss_acc):0.9418 Specificity (negative_acc):0.6830 accuracy:0.8124
Epoch 326: loss: 0.26971
Sensitivity (poss_acc):0.9278 Specificity (negative_acc):0.7047 accuracy:0.8162
Epoch 327: loss: 0.29703
Sensitivity (poss_acc):0.8546 Specificity (negative_acc):0.7918 accuracy:0.8232
Epoch 328: loss: 0.31146
Sensitivity (poss_acc):0.8838 Specificity (negative_acc):0.7442 accuracy:0.8140
Epoch 329: loss: 0.27847
Sensitivity (poss_acc):0.9403 Specificity (negative_acc):0.6829 accuracy:0.8116
Epoch 330: loss: 0.26299
Sensitivity (poss_acc):0.9354 Specificity (negative_acc):0.7072 accuracy:0.8213
Epoch 331: loss: 0.26303
Sensitivity (poss_acc):0.9154 Specificity (negative_acc):0.7331 accuracy:0.8243
Epoch 332: loss: 0.25426
Sensitivity (poss_acc):0.9239 Specificity (negative_acc):0.7059 accuracy:0.8149
Epoch 333: loss: 0.25015
Sensitivity (poss_acc):0.9082 Specificity (negative_acc):0.7338 accuracy:0.8210
Epoch 334: loss: 0.26118
Sensitivity (poss_acc):0.9227 Specificity (negative_acc):0.7164 accuracy:0.8196
Epoch 335: loss: 0.25302
Sensitivity (poss_acc):0.9286 Specificity (negative_acc):0.7148 accuracy:0.8217
Epoch 336: loss: 0.25933
Sensitivity (poss_acc):0.9413 Specificity (negative_acc):0.6888 accuracy:0.8150
Epoch 337: loss: 0.28035
Sensitivity (poss_acc):0.9063 Specificity (negative_acc):0.7286 accuracy:0.8174
Epoch 338: loss: 0.25494
Sensitivity (poss_acc):0.9229 Specificity (negative_acc):0.7104 accuracy:0.8167
Epoch 339: loss: 0.24699
Sensitivity (poss_acc):0.9201 Specificity (negative_acc):0.7101 accuracy:0.8151
Epoch 340: loss: 0.24394
Youdens  index: 0.8950 Sensitivity: 0.8676 Specificity: 0.7121
Epoch 341: loss: 0.24413
Sensitivity (poss_acc):0.8992 Specificity (negative_acc):0.7515 accuracy:0.8254
Epoch 342: loss: 0.24053
Sensitivity (poss_acc):0.9398 Specificity (negative_acc):0.6915 accuracy:0.8157
Epoch 343: loss: 0.29209
Sensitivity (poss_acc):0.9573 Specificity (negative_acc):0.6284 accuracy:0.7929
Epoch 344: loss: 0.48287
Sensitivity (poss_acc):0.8723 Specificity (negative_acc):0.7623 accuracy:0.8173
Epoch 345: loss: 0.35241
Sensitivity (poss_acc):0.9142 Specificity (negative_acc):0.7485 accuracy:0.8313
Replacing models: GraphSage_epoch_311.pt  link_predictor_epoch_311.pt
with: Best models at GraphSage_epoch_345.pt  link_predictor_epoch_345.pt
Saving Model in Path GraphSage_epoch_345.pt
Saving Model in Path link_predictor_epoch_345.pt
Epoch 346: loss: 0.27701
Sensitivity (poss_acc):0.9462 Specificity (negative_acc):0.6819 accuracy:0.8140
Epoch 347: loss: 0.25205
Sensitivity (poss_acc):0.9063 Specificity (negative_acc):0.7409 accuracy:0.8236
Epoch 348: loss: 0.24887
Sensitivity (poss_acc):0.9463 Specificity (negative_acc):0.6827 accuracy:0.8145
Epoch 349: loss: 0.24235
Sensitivity (poss_acc):0.9327 Specificity (negative_acc):0.7253 accuracy:0.8290
Epoch 350: loss: 0.24123
Sensitivity (poss_acc):0.9439 Specificity (negative_acc):0.6913 accuracy:0.8176
Epoch 351: loss: 0.24302
Sensitivity (poss_acc):0.9240 Specificity (negative_acc):0.6951 accuracy:0.8095
Epoch 352: loss: 0.24553
Sensitivity (poss_acc):0.9193 Specificity (negative_acc):0.7285 accuracy:0.8239
Epoch 353: loss: 0.23427
Sensitivity (poss_acc):0.9197 Specificity (negative_acc):0.7387 accuracy:0.8292
Epoch 354: loss: 0.2294
Sensitivity (poss_acc):0.9341 Specificity (negative_acc):0.6866 accuracy:0.8104
Epoch 355: loss: 0.23221
Sensitivity (poss_acc):0.9356 Specificity (negative_acc):0.7092 accuracy:0.8224
Epoch 356: loss: 0.22796
Sensitivity (poss_acc):0.9188 Specificity (negative_acc):0.7202 accuracy:0.8195
Epoch 357: loss: 0.23815
Sensitivity (poss_acc):0.9420 Specificity (negative_acc):0.6986 accuracy:0.8203
Epoch 358: loss: 0.24684
Sensitivity (poss_acc):0.9355 Specificity (negative_acc):0.6995 accuracy:0.8175
Epoch 359: loss: 0.25699
Sensitivity (poss_acc):0.9266 Specificity (negative_acc):0.7014 accuracy:0.8140
Epoch 360: loss: 0.26083
Youdens  index: 0.9143 Sensitivity: 0.8573 Specificity: 0.7576
Epoch 361: loss: 0.25936
Sensitivity (poss_acc):0.9076 Specificity (negative_acc):0.7554 accuracy:0.8315
Replacing models: GraphSage_epoch_345.pt  link_predictor_epoch_345.pt
with: Best models at GraphSage_epoch_361.pt  link_predictor_epoch_361.pt
Saving Model in Path GraphSage_epoch_361.pt
Saving Model in Path link_predictor_epoch_361.pt
Epoch 362: loss: 0.24979
Sensitivity (poss_acc):0.9259 Specificity (negative_acc):0.7303 accuracy:0.8281
Epoch 363: loss: 0.23555
Sensitivity (poss_acc):0.9424 Specificity (negative_acc):0.6934 accuracy:0.8179
Epoch 364: loss: 0.24072
Sensitivity (poss_acc):0.9233 Specificity (negative_acc):0.7338 accuracy:0.8285
Epoch 365: loss: 0.24204
Sensitivity (poss_acc):0.9306 Specificity (negative_acc):0.7124 accuracy:0.8215
Epoch 366: loss: 0.23186
Sensitivity (poss_acc):0.9369 Specificity (negative_acc):0.6904 accuracy:0.8136
Epoch 367: loss: 0.22834
Sensitivity (poss_acc):0.9331 Specificity (negative_acc):0.6955 accuracy:0.8143
Epoch 368: loss: 0.22755
Sensitivity (poss_acc):0.9359 Specificity (negative_acc):0.6992 accuracy:0.8175
Epoch 369: loss: 0.22694
Sensitivity (poss_acc):0.9377 Specificity (negative_acc):0.6754 accuracy:0.8066
Epoch 370: loss: 0.26628
Sensitivity (poss_acc):0.9138 Specificity (negative_acc):0.7267 accuracy:0.8202
Epoch 371: loss: 0.23757
Sensitivity (poss_acc):0.9161 Specificity (negative_acc):0.7257 accuracy:0.8209
Epoch 372: loss: 0.23516
Sensitivity (poss_acc):0.9381 Specificity (negative_acc):0.7021 accuracy:0.8201
Epoch 373: loss: 0.23502
Sensitivity (poss_acc):0.9255 Specificity (negative_acc):0.7370 accuracy:0.8312
Epoch 374: loss: 0.23408
Sensitivity (poss_acc):0.9201 Specificity (negative_acc):0.7220 accuracy:0.8210
Epoch 375: loss: 0.24173
Sensitivity (poss_acc):0.9111 Specificity (negative_acc):0.7324 accuracy:0.8218
Epoch 376: loss: 0.24685
Sensitivity (poss_acc):0.9111 Specificity (negative_acc):0.7398 accuracy:0.8254
Epoch 377: loss: 0.24181
Sensitivity (poss_acc):0.9347 Specificity (negative_acc):0.7024 accuracy:0.8186
Epoch 378: loss: 0.25231
Sensitivity (poss_acc):0.9276 Specificity (negative_acc):0.6988 accuracy:0.8132
Epoch 379: loss: 0.24032
Sensitivity (poss_acc):0.9296 Specificity (negative_acc):0.6854 accuracy:0.8075
Epoch 380: loss: 0.2515
Youdens  index: 0.9390 Sensitivity: 0.8487 Specificity: 0.7432
Epoch 381: loss: 0.27215
Sensitivity (poss_acc):0.9264 Specificity (negative_acc):0.7043 accuracy:0.8154
Epoch 382: loss: 0.27327
Sensitivity (poss_acc):0.8217 Specificity (negative_acc):0.8156 accuracy:0.8186
Epoch 383: loss: 0.24583
Sensitivity (poss_acc):0.9425 Specificity (negative_acc):0.6963 accuracy:0.8194
Epoch 384: loss: 0.22456
Sensitivity (poss_acc):0.9361 Specificity (negative_acc):0.7006 accuracy:0.8183
Epoch 385: loss: 0.22032
Sensitivity (poss_acc):0.9157 Specificity (negative_acc):0.7279 accuracy:0.8218
Epoch 386: loss: 0.2244
Sensitivity (poss_acc):0.9160 Specificity (negative_acc):0.7137 accuracy:0.8148
Epoch 387: loss: 0.21072
Sensitivity (poss_acc):0.9096 Specificity (negative_acc):0.7449 accuracy:0.8273
Epoch 388: loss: 0.2204
Sensitivity (poss_acc):0.9345 Specificity (negative_acc):0.7072 accuracy:0.8208
Epoch 389: loss: 0.21742
Sensitivity (poss_acc):0.9376 Specificity (negative_acc):0.7054 accuracy:0.8215
Epoch 390: loss: 0.2208
Sensitivity (poss_acc):0.9231 Specificity (negative_acc):0.7287 accuracy:0.8259
Epoch 391: loss: 0.21633
Sensitivity (poss_acc):0.9181 Specificity (negative_acc):0.7176 accuracy:0.8179
Epoch 392: loss: 0.2131
Sensitivity (poss_acc):0.9095 Specificity (negative_acc):0.7374 accuracy:0.8234
Epoch 393: loss: 0.20912
Sensitivity (poss_acc):0.9370 Specificity (negative_acc):0.7129 accuracy:0.8249
Epoch 394: loss: 0.20719
Sensitivity (poss_acc):0.9170 Specificity (negative_acc):0.7373 accuracy:0.8271
Epoch 395: loss: 0.22036
Sensitivity (poss_acc):0.9067 Specificity (negative_acc):0.7465 accuracy:0.8266
Epoch 396: loss: 0.24959
Sensitivity (poss_acc):0.9254 Specificity (negative_acc):0.7150 accuracy:0.8202
Epoch 397: loss: 0.23008
Sensitivity (poss_acc):0.9188 Specificity (negative_acc):0.7329 accuracy:0.8259
Epoch 398: loss: 0.21689
Sensitivity (poss_acc):0.9142 Specificity (negative_acc):0.7152 accuracy:0.8147
Epoch 399: loss: 0.22647
Sensitivity (poss_acc):0.9370 Specificity (negative_acc):0.7086 accuracy:0.8228
Epoch 400: loss: 0.22033
Youdens  index: 0.8356 Sensitivity: 0.8722 Specificity: 0.738
Replacing models: GraphSage_epoch_361.pt  link_predictor_epoch_361.pt
with: Best models at GraphSage_epoch_400.pt  link_predictor_epoch_400.pt
Saving Model in Path GraphSage_epoch_400.pt
Saving Model in Path link_predictor_epoch_400.pt
Epoch 401: loss: 0.22417
Sensitivity (poss_acc):0.9385 Specificity (negative_acc):0.6754 accuracy:0.8070
Epoch 402: loss: 0.22036
Sensitivity (poss_acc):0.9273 Specificity (negative_acc):0.7116 accuracy:0.8195
Epoch 403: loss: 0.22335
Sensitivity (poss_acc):0.9309 Specificity (negative_acc):0.7180 accuracy:0.8244
Epoch 404: loss: 0.21484
Sensitivity (poss_acc):0.8955 Specificity (negative_acc):0.7831 accuracy:0.8393
Replacing models: GraphSage_epoch_400.pt  link_predictor_epoch_400.pt
with: Best models at GraphSage_epoch_404.pt  link_predictor_epoch_404.pt
Saving Model in Path GraphSage_epoch_404.pt
Saving Model in Path link_predictor_epoch_404.pt
Epoch 405: loss: 0.22207
Sensitivity (poss_acc):0.9363 Specificity (negative_acc):0.6996 accuracy:0.8179
Epoch 406: loss: 0.24823
Sensitivity (poss_acc):0.9283 Specificity (negative_acc):0.7215 accuracy:0.8249
Epoch 407: loss: 0.22388
Sensitivity (poss_acc):0.9247 Specificity (negative_acc):0.7464 accuracy:0.8355
Epoch 408: loss: 0.21491
Sensitivity (poss_acc):0.9214 Specificity (negative_acc):0.7454 accuracy:0.8334
Epoch 409: loss: 0.20652
Sensitivity (poss_acc):0.9119 Specificity (negative_acc):0.7507 accuracy:0.8313
Epoch 410: loss: 0.20941
Sensitivity (poss_acc):0.8952 Specificity (negative_acc):0.7374 accuracy:0.8163
Epoch 411: loss: 0.22706
Sensitivity (poss_acc):0.9301 Specificity (negative_acc):0.7208 accuracy:0.8255
Epoch 412: loss: 0.21377
Sensitivity (poss_acc):0.9152 Specificity (negative_acc):0.7346 accuracy:0.8249
Epoch 413: loss: 0.23774
Sensitivity (poss_acc):0.8829 Specificity (negative_acc):0.7607 accuracy:0.8218
Epoch 414: loss: 0.21501
Sensitivity (poss_acc):0.9251 Specificity (negative_acc):0.7199 accuracy:0.8225
Epoch 415: loss: 0.21192
Sensitivity (poss_acc):0.9258 Specificity (negative_acc):0.7120 accuracy:0.8189
Epoch 416: loss: 0.2122
Sensitivity (poss_acc):0.9350 Specificity (negative_acc):0.7126 accuracy:0.8238
Epoch 417: loss: 0.20387
Sensitivity (poss_acc):0.9221 Specificity (negative_acc):0.7249 accuracy:0.8235
Epoch 418: loss: 0.19571
Sensitivity (poss_acc):0.9287 Specificity (negative_acc):0.7219 accuracy:0.8253
Epoch 419: loss: 0.19462
Sensitivity (poss_acc):0.9441 Specificity (negative_acc):0.6975 accuracy:0.8208
Epoch 420: loss: 0.1974
Youdens  index: 0.9035 Sensitivity: 0.8457 Specificity: 0.7657
Epoch 421: loss: 0.24172
Sensitivity (poss_acc):0.9244 Specificity (negative_acc):0.7144 accuracy:0.8194
Epoch 422: loss: 0.20444
Sensitivity (poss_acc):0.9205 Specificity (negative_acc):0.7327 accuracy:0.8266
Epoch 423: loss: 0.20627
Sensitivity (poss_acc):0.9069 Specificity (negative_acc):0.7523 accuracy:0.8296
Epoch 424: loss: 0.21716
Sensitivity (poss_acc):0.9253 Specificity (negative_acc):0.7196 accuracy:0.8224
Epoch 425: loss: 0.28508
Sensitivity (poss_acc):0.8785 Specificity (negative_acc):0.7684 accuracy:0.8234
Epoch 426: loss: 0.39432
Sensitivity (poss_acc):0.9058 Specificity (negative_acc):0.7272 accuracy:0.8165
Epoch 427: loss: 0.29863
Sensitivity (poss_acc):0.9264 Specificity (negative_acc):0.7209 accuracy:0.8237
Epoch 428: loss: 0.23338
Sensitivity (poss_acc):0.9358 Specificity (negative_acc):0.6780 accuracy:0.8069
Epoch 429: loss: 0.21444
Sensitivity (poss_acc):0.9156 Specificity (negative_acc):0.7380 accuracy:0.8268
Epoch 430: loss: 0.19334
Sensitivity (poss_acc):0.9283 Specificity (negative_acc):0.7225 accuracy:0.8254
Epoch 431: loss: 0.19064
Sensitivity (poss_acc):0.9279 Specificity (negative_acc):0.7242 accuracy:0.8261
Epoch 432: loss: 0.19181
Sensitivity (poss_acc):0.9396 Specificity (negative_acc):0.7197 accuracy:0.8297
Epoch 433: loss: 0.18775
Sensitivity (poss_acc):0.9438 Specificity (negative_acc):0.6887 accuracy:0.8163
Epoch 434: loss: 0.18864
Sensitivity (poss_acc):0.9294 Specificity (negative_acc):0.7217 accuracy:0.8256
Epoch 435: loss: 0.19959
Sensitivity (poss_acc):0.9110 Specificity (negative_acc):0.7340 accuracy:0.8225
Epoch 436: loss: 0.20152
Sensitivity (poss_acc):0.9224 Specificity (negative_acc):0.7323 accuracy:0.8274
Epoch 437: loss: 0.19882
Sensitivity (poss_acc):0.9302 Specificity (negative_acc):0.7252 accuracy:0.8277
Epoch 438: loss: 0.20474
Sensitivity (poss_acc):0.9112 Specificity (negative_acc):0.7511 accuracy:0.8312
Epoch 439: loss: 0.19753
Sensitivity (poss_acc):0.9229 Specificity (negative_acc):0.7317 accuracy:0.8273
Epoch 440: loss: 0.18248
Youdens  index: 0.9178 Sensitivity: 0.8538 Specificity: 0.749
Epoch 441: loss: 0.18211
Sensitivity (poss_acc):0.9333 Specificity (negative_acc):0.7213 accuracy:0.8273
Epoch 442: loss: 0.17687
Sensitivity (poss_acc):0.9340 Specificity (negative_acc):0.7109 accuracy:0.8225
Epoch 443: loss: 0.17796
Sensitivity (poss_acc):0.9253 Specificity (negative_acc):0.7260 accuracy:0.8256
Epoch 444: loss: 0.19276
Sensitivity (poss_acc):0.9328 Specificity (negative_acc):0.7184 accuracy:0.8256
Epoch 445: loss: 0.20067
Sensitivity (poss_acc):0.9249 Specificity (negative_acc):0.7290 accuracy:0.8269
Epoch 446: loss: 0.20874
Sensitivity (poss_acc):0.9373 Specificity (negative_acc):0.6993 accuracy:0.8183
Epoch 447: loss: 0.1938
Sensitivity (poss_acc):0.9313 Specificity (negative_acc):0.7128 accuracy:0.8221
Epoch 448: loss: 0.18856
Sensitivity (poss_acc):0.9137 Specificity (negative_acc):0.7146 accuracy:0.8142
Epoch 449: loss: 0.22809
Sensitivity (poss_acc):0.9370 Specificity (negative_acc):0.6977 accuracy:0.8173
Epoch 450: loss: 0.19334
Sensitivity (poss_acc):0.9231 Specificity (negative_acc):0.7362 accuracy:0.8297
Epoch 451: loss: 0.19978
Sensitivity (poss_acc):0.9325 Specificity (negative_acc):0.7207 accuracy:0.8266
Epoch 452: loss: 0.20199
Sensitivity (poss_acc):0.9299 Specificity (negative_acc):0.7205 accuracy:0.8252
Epoch 453: loss: 0.1864
Sensitivity (poss_acc):0.9242 Specificity (negative_acc):0.7348 accuracy:0.8295
Epoch 454: loss: 0.19218
Sensitivity (poss_acc):0.9217 Specificity (negative_acc):0.7288 accuracy:0.8253
Epoch 455: loss: 0.18319
Sensitivity (poss_acc):0.9125 Specificity (negative_acc):0.7487 accuracy:0.8306
Epoch 456: loss: 0.19585
Sensitivity (poss_acc):0.9286 Specificity (negative_acc):0.7104 accuracy:0.8195
Epoch 457: loss: 0.18792
Sensitivity (poss_acc):0.9224 Specificity (negative_acc):0.7201 accuracy:0.8213
Epoch 458: loss: 0.18575
Sensitivity (poss_acc):0.9269 Specificity (negative_acc):0.7318 accuracy:0.8293
Epoch 459: loss: 0.17877
Sensitivity (poss_acc):0.9342 Specificity (negative_acc):0.7272 accuracy:0.8307
Epoch 460: loss: 0.19606
Youdens  index: 0.7920 Sensitivity: 0.8774 Specificity: 0.7214
Epoch 461: loss: 0.23033
Sensitivity (poss_acc):0.9176 Specificity (negative_acc):0.7411 accuracy:0.8293
Epoch 462: loss: 0.25767
Sensitivity (poss_acc):0.8857 Specificity (negative_acc):0.7621 accuracy:0.8239
Epoch 463: loss: 0.2143
Sensitivity (poss_acc):0.9285 Specificity (negative_acc):0.7370 accuracy:0.8328
Epoch 464: loss: 0.23429
Sensitivity (poss_acc):0.9166 Specificity (negative_acc):0.7064 accuracy:0.8115
Epoch 465: loss: 0.21986
Sensitivity (poss_acc):0.9254 Specificity (negative_acc):0.7141 accuracy:0.8197
Epoch 466: loss: 0.19238
Sensitivity (poss_acc):0.9403 Specificity (negative_acc):0.7151 accuracy:0.8277
Epoch 467: loss: 0.17515
Sensitivity (poss_acc):0.9365 Specificity (negative_acc):0.7148 accuracy:0.8257
Epoch 468: loss: 0.17223
Sensitivity (poss_acc):0.9265 Specificity (negative_acc):0.7199 accuracy:0.8232
Epoch 469: loss: 0.16581
Sensitivity (poss_acc):0.9277 Specificity (negative_acc):0.7230 accuracy:0.8254
Epoch 470: loss: 0.16664
Sensitivity (poss_acc):0.9215 Specificity (negative_acc):0.7201 accuracy:0.8208
Epoch 471: loss: 0.16958
Sensitivity (poss_acc):0.9336 Specificity (negative_acc):0.7371 accuracy:0.8354
Epoch 472: loss: 0.17501
Sensitivity (poss_acc):0.9039 Specificity (negative_acc):0.7741 accuracy:0.8390
Epoch 473: loss: 0.17548
Sensitivity (poss_acc):0.9379 Specificity (negative_acc):0.7026 accuracy:0.8203
Epoch 474: loss: 0.17472
Sensitivity (poss_acc):0.9275 Specificity (negative_acc):0.7344 accuracy:0.8310
Epoch 475: loss: 0.17299
Sensitivity (poss_acc):0.9281 Specificity (negative_acc):0.7269 accuracy:0.8275
Epoch 476: loss: 0.17259
Sensitivity (poss_acc):0.9233 Specificity (negative_acc):0.7368 accuracy:0.8300
Epoch 477: loss: 0.19387
Sensitivity (poss_acc):0.9349 Specificity (negative_acc):0.7090 accuracy:0.8219
Epoch 478: loss: 0.23573
Sensitivity (poss_acc):0.9442 Specificity (negative_acc):0.6996 accuracy:0.8219
Epoch 479: loss: 0.20471
Sensitivity (poss_acc):0.9392 Specificity (negative_acc):0.7077 accuracy:0.8235
Epoch 480: loss: 0.18789
Youdens  index: 0.9204 Sensitivity: 0.8476 Specificity: 0.7796
Epoch 481: loss: 0.174
Sensitivity (poss_acc):0.9332 Specificity (negative_acc):0.7282 accuracy:0.8307
Epoch 482: loss: 0.17244
Sensitivity (poss_acc):0.9079 Specificity (negative_acc):0.7520 accuracy:0.8299
Epoch 483: loss: 0.17065
Sensitivity (poss_acc):0.9281 Specificity (negative_acc):0.7082 accuracy:0.8181
Epoch 484: loss: 0.17275
Sensitivity (poss_acc):0.9237 Specificity (negative_acc):0.7147 accuracy:0.8192
Epoch 485: loss: 0.1662
Sensitivity (poss_acc):0.9365 Specificity (negative_acc):0.7102 accuracy:0.8233
Epoch 486: loss: 0.17545
Sensitivity (poss_acc):0.9126 Specificity (negative_acc):0.7429 accuracy:0.8277
Epoch 487: loss: 0.16983
Sensitivity (poss_acc):0.9176 Specificity (negative_acc):0.7375 accuracy:0.8275
Epoch 488: loss: 0.16665
Sensitivity (poss_acc):0.9228 Specificity (negative_acc):0.7365 accuracy:0.8297
Epoch 489: loss: 0.18032
Sensitivity (poss_acc):0.9280 Specificity (negative_acc):0.7288 accuracy:0.8284
Epoch 490: loss: 0.20371
Sensitivity (poss_acc):0.9155 Specificity (negative_acc):0.7284 accuracy:0.8220
Epoch 491: loss: 0.20601
Sensitivity (poss_acc):0.9107 Specificity (negative_acc):0.7437 accuracy:0.8272
Epoch 492: loss: 0.21267
Sensitivity (poss_acc):0.9346 Specificity (negative_acc):0.7217 accuracy:0.8282
Epoch 493: loss: 0.19111
Sensitivity (poss_acc):0.9382 Specificity (negative_acc):0.7030 accuracy:0.8206
Epoch 494: loss: 0.1703
Sensitivity (poss_acc):0.9303 Specificity (negative_acc):0.7277 accuracy:0.8290
Epoch 495: loss: 0.16025
Sensitivity (poss_acc):0.9240 Specificity (negative_acc):0.7226 accuracy:0.8233
Epoch 496: loss: 0.18236
Sensitivity (poss_acc):0.9057 Specificity (negative_acc):0.7365 accuracy:0.8211
Epoch 497: loss: 0.18573
Sensitivity (poss_acc):0.9415 Specificity (negative_acc):0.7061 accuracy:0.8238
Epoch 498: loss: 0.17085
Sensitivity (poss_acc):0.9250 Specificity (negative_acc):0.7054 accuracy:0.8152
Epoch 499: loss: 0.17554
Sensitivity (poss_acc):0.9321 Specificity (negative_acc):0.7151 accuracy:0.8236
Loading best models:  GraphSage_epoch_404.pt  link_predictor_epoch_404.pt</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="BERT2Graphsage_files/figure-html/cell-19-output-3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"935122dcd5484c67a28bb9030c1f669b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9ca62b17d882420499f67767a5c052d6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"775cfe5c772f42fea00b5d28b6f57559","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ad1337c0ad694c6ab9430082f8b72b93","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ca35ff541d914307a808eab494b03e25","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f468985d92ec4337ac6f7a14683f7f3c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f3fbc48a2c4a44c88cb3801e4d0a3f4d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"257b81720d624eaab6ae7163934fc69d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1bc0920ce9064d208d95b71baa5f26d8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"06995112b2884fbbaabf6162f8fc53f9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"62929ca289f14b5e87cc078abd7c398b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f5e9f9e3ac7a4d2795998e03478bcb0d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"203e606c3af24974a8aa77b3924995f9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"46a3b82e5a704242a46f279406adbb8e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5902335cd70b458889ee4b622c0318e8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9cb030647fc04ff581e095685dd62120","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b0095b0bcab14f44af20a99d3e86559a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9b87bed1ba754c2fbc7452bdf78b7a94","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bb6806c1889f4d21b8bc2fd62c6498c7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-23.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="BERT2Graphsage_files/figure-html/cell-19-output-23.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4d6933844a9347abb47078556a4a4543","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4e749b4d50a3411b9069d8e5a148cd3d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"865b0e23c8004b28b88f4267be18ac4a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"79a7bb31a2f54eaea023be4edf1bfa3a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"804bc5aa4a7d4d619ceaf4adb035e689","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"63f12d7b3cf14c44b149539461de2894","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0cab4fd4e57c4371b478530aa0c6b584","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5e0e68a1ea3045e384eb7763f78f4f0a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"aa10d094a6d245c4a07c5814af433ccb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ab163177ad834b208f6ee376c8b4c497","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bbf2c353015847088a2ec625eeb84d06","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e9d6c83bd27f4ecca358e54890d5e834","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2fe75fb88e9f4a2a886077ba0b70772a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"231d226ed6af4c33bdaf5f17eb499a6b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b4fd4ddcca8147a3b59302266247f022","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b1d43a75d7c048fcb48edff1ab03e7ff","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f77f20f17023425fb6b571cf74fc9dda","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6b1978ee98ef4449a4a1896d1e0e46ca","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"aee335f3f52941cda282097d1e3caf41","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"da2439142f0f475ba79c04b5f47afca3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-44.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="BERT2Graphsage_files/figure-html/cell-19-output-44.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5b7a077b5add4c86814b4afecd152e19","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2e3404381f8d4879a05d9c574bb9670a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d57dc3414ded44d0bb4d61218c1c5a27","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4eba2d9db4074dca8607bb07c12424a3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cd734559ec374dc8b5458848b3f82428","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8c03b24476994e60bdebb9d01c4247b9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f9facfa2512b43e09c2c0dc1ea015dbf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ae041da807cf46439cb6ed622e3d2bda","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4087ce5ab42942d5b2dde4153fff705c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4d357c5dc0c0475c908efa5435d80a27","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ebe2c6a0d31d47d0b0f18c5189e9fea7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"48ed7ec0df20405096fa69347b0e0790","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0eb4e72fbfc7438fac51861b09cae830","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"51580b3345884aa583aa764c9ae2bd64","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"26892d0dfa05432a965d968db4aac175","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a40dc18d6b69415f89a20c431fe6da95","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"02925d788291439d980b431b5de266bd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e71268158e8d4c2eb5285af2a81bdc88","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"52e5cf2e772547969b7f18ba29d14e8a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bc94d659ad6b4480bae9837820361c65","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-65.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="BERT2Graphsage_files/figure-html/cell-19-output-65.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"87cdd81c823941698b820c5b234c8a79","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"57aa67901b0342c491186b27941dbaed","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8a222b839d884f72a2f128eaa8917a3b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"abc08c9f1eb64396aa06a94712522ecd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"78a54a0c54cd44e09ff0b3459bb42de8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b2cb0e60cc60436dbe07a055292dd2f2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"78cdedda536c4338a4482efdc1f29d87","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"62c21e12139f47788885851ab8325cf6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9f8acbed02fd4618a73df393b8737b7b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"939ace3b906b490998491c1771b73430","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"98db96dcdcd641d6bf5c7a9ffa5d4f4f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"81cd77fc5b4c4444af288aae6246e892","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7a5fde8635e449dab279b80c162da238","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a797168b43d54a98a19ea0b552adefc6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"387535f28e944456a5c16d5784007ee2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4c965e0efec94af89da32aa5078a0793","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f38313d1e7d848feb4dcfca6af174b0b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4d781e631b9441c3a0d92b0befda4b73","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bf16cf64547443a0b8aa6665a706fec5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"eca402c038db4e33bb39b2226606f948","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-86.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="BERT2Graphsage_files/figure-html/cell-19-output-86.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fbe5f695a0fe43e1b47fea6b2619cc06","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d826b81faf3c4b2e91c89d6f68029ffd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3f0a7e73eab3418abc2fabd26eb13cf8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"310f98bd78584d1ab618b402a76dcf13","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7d837537c1064cb4970431c39fb1a831","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"54e9c5ba951f41be8d35cadbb618bb0c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"303ff29a048d4d87bb7f6a73f3503ce3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f1f3d21347de411aaf3b1141c2c57210","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c3554d392bdd420e9b2f42ae40dc807b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1be6b38ce4334e5382e7e84ef040ca30","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6710ba4ae7da41bab85d227ed629130c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fab1b7be25cc45d3845896b299dcedee","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"03b38e227e024b7b92c967018327d3b6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"107d4aeb85ce4c7d87b9068644103f75","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"343d44bfc42b409ba6f783be32ce702a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5245b80e227040f7930066a6501e1c81","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"450a727771604705916aca9148e805a6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4eccdbfbe39b4e908f9fc570ced025c5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"adf650f3c893474ba1eb839f827f959a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3e162de5bedc46b8bdcf4d11c31261d3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-107.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="BERT2Graphsage_files/figure-html/cell-19-output-107.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"314322d4f53a4386a10ffb54d2a26775","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"27aa3f100a55494b8b900360b089ec1b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"eda6ba90360a4676a96bd5fbab4379dc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"20e0373351fb4d619edb7ef7e50399a2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"63225e7f191f4486820a74ea2d102822","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bca0c3d56cf949baaa5b8aecd992fb18","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e41380cf1a2e4f1882a91b11e79a2e4e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0a228f2c38844e9fa7fed2507fe5874c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"83918c99abec4419b716f781daf265c0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d11006068ace4a448d4729aa8159fe0b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b2b1aa76f83046e0b4b0c1a3de439ac8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"504ba20879674bb2a631a967f7d3a2d0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"32c2204642ec4056a2d456549d221363","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8299a0533b0d4e4c8aabb132c2477aa4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"546032d1bb27466ea96724e0577bc038","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"083fc1b6025b4af2b9cf851ac7e36d86","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"01f1fa9c01c746558db3c3bb6f9f2101","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a7a2947155e34807b9026667657a347a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"567399f61f5e412c81705fe7bca9862e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5bd9ace97c304ecd8986236cb921ae7d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-128.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="BERT2Graphsage_files/figure-html/cell-19-output-128.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"62b442e883d34fb6b3dd821e877d012c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"79e3c43e84e241f495b87a89e1f873a9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8f9edaf12a4249e6be775f1ac847afcc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a49082ce87454baab4ff7ed39a4053d2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4c1353ed611e4131bed8128691602b3a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c47e5195be214320bbbbd9e0b9127e5b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"65d31cfc567043ff8381641f5aeeea82","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"999d1d790cb64e08bb09bdfbeef5cde4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b9fa401381bd4ad48ad9ca3b61ccde9d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"39494711cf544e0a95a50b4c1b0ead4b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f8b1edfa29ed416f8ab010337bf0b5f8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"610dd064966547b1a88849dbadde7057","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a3aa2a20f5c84c5998aa47d473f35d86","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2eb130c27e594a3982bf8a3918f2d934","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"12bb8fd12a504a68bbd2fc5158c666a6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c6176dc2e7a4445b83239adc18f485e9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"68cb77c94fbe4068830d8c31762514b4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0c036c2d8ec54433b16e1cf7e921faaf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"02a7f798dbb549f9bc123c52c8e111a3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b4affa3b680042ba821f69d5c89fe562","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-149.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="BERT2Graphsage_files/figure-html/cell-19-output-149.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b947d92796ff48528f65ed6992c694f1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cb7c9f81f0854b73aad47402b6dde3f4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"38acf8a7a55149c0889b6fa390d6355e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"98ff893c3ed84fbb898fef3755e5b0da","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"39d124877cc64d739e39bfdce6cf98fb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"12f06106e9164b90865e4de5d5f483d0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8d51e90ea9ea468bb30a02afe8d7c70c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"22635a7645bb4ea99003ddb8377525ff","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"133cd241fce4427b9994f96e3ddaad52","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"320e431ac76648eaa76323bc40b3e5bf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"38f080f1519a49af959b96b3ef7dcdb7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c1834ff6ab70443f8aacaf879c188b36","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b55c5de5ea444cf5be2a6dd4af9b2543","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c698b4ee3ca643ac8fbeebe925a0950f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"15fbfa144b304a9bbb8f44c023923629","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"09a81d97549848d79edfd8cccb54271f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"47f44b1b299144ee80f472f2ed989760","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2c38367e92224d8dad4437cbbb952874","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"82c196f9b7d845459c08001fe832b82e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"477be41832f9467eb070c5a08a6ddd6b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-170.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="BERT2Graphsage_files/figure-html/cell-19-output-170.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c1975351df4945d58ce8e29178a4318f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c4b5408f403945aa9c610d3693ff2a1d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bc2eeaed74e14fbfb2d8ec31408642e0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f43d54008ae443a3bd6691bae0c67e9f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bb7323c173474eb3808000c75fd600f3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a4fe669509cc4fdaa89bdf6d8766eb78","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"597d8907ba5c4822b1206a543a180ac7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"78c2721445334defae494006c988b31c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ed0520a4c4f54009b1de6d88738e271c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6c89c604f68945ffa1449e72dfe59e58","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"385e75a8543b47bbab8afb8cf3e31d13","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0558837443fb49b88d90d0db2260f429","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"dd26f330af824f349dcb436d9cadd070","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"93b3b31d7bba4e23ba95e098f29b7e3d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a2151876591044f4bb90ea0969205178","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4e1fe21e332c4fa08d76065757b8454e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b9b16e8351274f5d8ea5ebaf1ed3e1ea","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d47d8ac0717b4f798eea16caa8acc5ad","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f91c0913154e43a699c1d989cac48af5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f4ef907e068d4545bdc9185834dabd1e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-191.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="BERT2Graphsage_files/figure-html/cell-19-output-191.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"be4a161aef5a491090fc4d6a59ac3c14","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4491ce21787d4d18af34f3583a549db4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d5658904850346f0a8e6c2b35fd8734c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8c19cd381c504ebfb0f7df93c26125a6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"37a5f6d573e94a8da1a311921c6798b9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a5cfe1ecafaf4e29a3cd285b0ebe7dbf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9da3ae2adadf442b9d0c5354a9d860ee","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8269ce2788c9484fbc1dbe99730dba6b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"10ee952c1c6e4bacb18bf5323600c422","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3f31fc7c8d484ab58344d38c100c9e8c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"656f7a03e6bb46d696ff2fe4939ddca9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6407a426805d4ffdae2dcd84a9eae101","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a62dd2c5c2124881baa1965a72a0178d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5466fad36c2e4ebab72769f54bea2acc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cdd370db719047de8bcb07bf737bff31","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7bda7d5f7114467d8525684c2aa1afb8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"dabd8a3d86e44736a18b7971e9043b1c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e7cf4c66b2764c1295f6b46aed964ce9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9012817480e444e5956213df1248722d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"96adb3e1d75e4cfc98f3d3268fb1fcfd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-212.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="BERT2Graphsage_files/figure-html/cell-19-output-212.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4d55da6e383744a8bc34a24a6a00d99c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"959b0925bdfd4a92bf1332ca0b4cda38","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b4e750dc90444600a17897254075d488","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"89f4ecdf80c0418e9fad7224b5e86a86","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"410bc2fbaa5f4566aed0d43917913904","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bcc6f01c72004075a32c58cb353bcfc9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"daed6b481fe047c0af0067a1ba508ec3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"21bd68d2f7fb41ee9f8513ff97bda891","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3619fc197345417ebf2bc4df52e3064d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0463f6159d1a4821b53c4a243f3a32f5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ed04cd5981a44c798bcc3a36694b4046","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7a1c22d1099d495aad093c06564bbbd2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7bcf414c3ca44981b0c84d7a65688a9a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7e91d7903ef14ea3ab0d0dc196d9ccdf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"df1707d080e340faa915ab30e5528e77","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c95d030b8b5a4614ac6b4ae81c321a23","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c0607a5b3b5d445a817f4daf6bdd359e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"38ecbf963d37459caa5e40019770ef66","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ef988c5ea2c04a11a5ed6a601d675619","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2293f9b9d4694e5cba8cec5c44e19aa9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-233.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="BERT2Graphsage_files/figure-html/cell-19-output-233.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9a34af7ae4db41dd924a28227f5bcc08","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c33b90e206b348569e95d987f8ced3bc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a7768e7c18f94c619cdf03fd59423692","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7e052ed691504913afc8c63fc59811d5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"72b88aa04bdb4f2abcf075d41272781f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"14c6559cef6a4e1486484caefb5c2c30","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"24cc31eb32b34b1b9445199b03d139be","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"688b79fb54134bcca32f480513861d0f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c8e151b39b4c463abde93a6f102344ec","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ac5791f70bc14540828551c1759ddf90","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b7c11bd1644c4158a48882850c7c599d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"94b5ccd3ed8f49cb972aaf3bec0ccdd0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cc3b1f96f37741e9a0fc0f18c9c07914","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"db89b23fb6024639ada4d0ab4e64d997","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"83897f812a9645f19bbe3c20d75c81b3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"10a762465f034529b11e1159dc66cd41","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8cbbe81a2e5840588794f2d94d2474e7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f8691fe32dd7461eae5996814030b197","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0c107abd9c7a4d74abc1f5ef0d452dfb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"59728d897c524bbd97a25d037d4ab48b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-254.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="BERT2Graphsage_files/figure-html/cell-19-output-254.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"747cd3bc7c67407bb71c76bcce554e6f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"670488908bc8474591d951cc517180ae","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bba14d1984a54182a6e47725abdc82b7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2942b7bbaa584e239e1869b48f219410","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9ed7ca8611a44157925e72f0807d3032","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"90f504ec811f4f8980f1f93a225f4bbf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"884252e8b14a46a3b56ba36626112d1e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cd24fcc988c144389bf7fb480f9c5e1e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2e268f59b642451e839a7d7e7b562b91","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8f41cc1ec2324be4a836552571757d7f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ca7f11c1c7a34e20997c73a39676952d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"45af70a535724a328105abd3fdf446cf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6f1fbaf0794649e38040415ca51149ba","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b1ebe2640cba4f65882a9bbc40e74220","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5241755ce0484a75af00ae5290e95630","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b77a5eaf5b054fe3a71e9370992d7d31","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5092c246504e4e41b3463af034482065","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7bba735e049e45c090af8f84eaecdfc3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5efaf6ad805649668787eca1db48cd34","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1fdbd99346db45bd8251bc22942c9bb5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-275.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="BERT2Graphsage_files/figure-html/cell-19-output-275.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b0e642d815784dea8651747c9780c6cd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f53863f278ec42f9a2c7531481d0f68e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"18fd13bde82a4417a39bad5f45660d1d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"397b490a122f477cac09ef4227461264","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6cbc49641b4b4c53bf87e207b6a9d213","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"54d66c29df3240669ae0a1df644e2106","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c5be430cb5eb442d9f151c82d3f7f5ed","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d338a20f8f0840fa81aece5dabf80f6b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b36a763a13bd441da449cbf104c95d7c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b78bcaf2234448f7aba4b6584f19c80d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b284b907febd4a098235f31b2829206c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a7753bb628cd4d4784b08ea00e73a079","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ca71ce876bdd4e5f8c2bd8c6a3c348b1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b5406e52d5eb4eac8867cf32a1662be2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"522f16bfc49443dbaf8cd21edd5ce23f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"26aec03eeafa46bf9fcb7df133f1ee25","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b15f45dd70d14dae9dc1e754faf39739","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b89be7f3f67e495c889b0e9b4cb9e175","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ffa510b0b6c840c1ad2d2df69b82dbb7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d17a597e476e4a4b987201f56ba2163d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-296.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="BERT2Graphsage_files/figure-html/cell-19-output-296.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"97b2d6e9b94141daacef28c5b5f62dae","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e9bd52dabb614e289c1a156d40140404","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c099c02a7d674ac387e4e28429b40445","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"db3651a891a94ef1aaea0bfda53ee70d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"88ac4bf674bc48abbd0b484f02d928d6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"12f4d8de976e45159ba6df1a817ddafd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ef48978c22b34bc7b0c8df721f96b40b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c05ba8585cd54914841ef888a07a80fe","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"540bf855168f4ad385a9847d6acc2d05","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0d88ec7964034f28aefbeb19a080c801","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ddc9fa3cd6dc4385883b8685e03c2616","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6f04a1bbceba470fb378fb7bad33fe53","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ff69856a55d642349a4e76e204bf2c21","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4dee2f9d289642538f954cfcbdce9383","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5cc90be581e949abaa44ad2c82878f9f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1fe76162ab6b4b7e8f201169aa91c24c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5a781a9a71de473c8b3e3aba5a99c604","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1032b7033c9f44179ed92c5b7d2cbc81","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4d1cbe52e51746f293d14a44b42d9d03","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5e1a15e989594d26ba91500b40648017","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-317.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="BERT2Graphsage_files/figure-html/cell-19-output-317.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e23f2f4a899b4261b968b79378848e78","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a2365f9cce3a4551a0097db4b657e36d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"da81da6ed81142268bfe1e8eea4f2464","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8d75e5e9a4744c569f9a0acf2e3c147c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d25b9e3833474dd99622fde36d873c6a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"646609ba5be740f8a3428641f1829e7a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4778497b74e94faca876405eec56a4fb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c39221124b774c1ea47a3366c0301d90","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1be89bd7be844066b2e7096e92185728","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3c3adeb4924f4313b3a442b9b2992cb2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"02f671f477474bbe8b746e5e7857024e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cfeb424bfc3f4f35a5d57954a0c0b4dd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5ec73b02a7d04111a848df317f380681","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4d28a45264964c2e9e31ee61991c7588","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f0e50d8fd68c4006b674d0b189107ced","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d3e447e493374bf9b026c81f89b0bf01","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6f3a5fcd160a423dbeb8ec3e30bd0e14","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7d07644873de43d4b3965d92cde4e33e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"024af54b3993479ba75dc913fa13c463","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4f6260fc71004f06b84237128f0dadbf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-338.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="BERT2Graphsage_files/figure-html/cell-19-output-338.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6714b87888224552aad96a37811c352d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9388a06454014fa48c5b9cb6d426b677","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b90d633ccf2f4919be2a21106d0bb1cc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"54ab2681c1c94ef49ab38b9c5fc75adb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ff5d7b84ad72442a889178fe47f85403","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bc0546f542534f8c8bbe55b7fc5c2132","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0c48572c55c04e50b5c94a8f7207d3b4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cfd2adb53c6545d2bb880c1e2f537884","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"30613efa026a4c2ab143dea2796c8501","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"87b7d1a4965d4287b735e4137486c4f7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3f8e540dce3444f2a0f1c91fd9401824","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8bc7b1530c3946ccbe1368577a1bd488","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b87c9791b12d4ef9a1b99e907a59c1cf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"58a7809f25a44680948fb0d47d70e128","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ec33adf7bfc84d45bb078ebde31f1d6a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"52c63653252c420485ed71b804a7704c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"72926035ff464216affe4dbd6762c843","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"639d9fb0b0fe441596aa0672d4d966bc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2ebceedcc0754e1fb171587d22570956","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e9b80930269a4db4a9fdcbb0efcf670c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-359.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="BERT2Graphsage_files/figure-html/cell-19-output-359.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c540527bf06141bbb8f971079b086c29","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"32859681fc8b4db090a8d3452f8fbf7a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"91191a2e423c4968aeb5d7b18ce3426d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"76c118313a9d4499b5de90987f3f6df5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"97b105bb2e354fd0aaaf95b8b21c9587","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"60c95f24ae46495391c2843d7944e431","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"05fb91804659435eadfd0341eb19ae8b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d84f265517ea4f2f8df7380c224e64bd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"dfacbffa8c3a4cc883b30d42ad01a000","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ecc18ce13d7e414fbbd04f32198c48d0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"072981db23fb49779b5fd07a507735bc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b9bb079fef18468daafed0d59385425c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4ad26df72c0b495a94da643858742985","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c23f4d161763452fb0a35ddfbb2fe827","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fa5421ba55ba46e5ae4e3e92e8ced8a0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d2fb65feabea40cf9ee6cc046cb58625","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c5c967f8894b4c13814a05816ab30384","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0b6bf40dace4472e936690e9a1b8179a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"aa3348465bdf4745ad617a7d7d281af2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7f009b47f37945a08afe5610a110a7a1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-380.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="BERT2Graphsage_files/figure-html/cell-19-output-380.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2a6c659c32864b779afa43f803538864","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3951ad00da3b4b40ab7301646abb46c6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b3dc1f12575b4413b6decca1f211fa44","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f488c67dffb34fc782686ac33d04ab64","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5a0263acbf094951a45957f055b5881b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0dfeb663eef143e9ad48ec2d7818f332","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0ae7776a30274cffadfb86675511342e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5637b5a564a0458dab6a32221cc99af0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1c91b96702b9442d8169834a6064f4ff","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"eb9333c8de4b4b8993d0ff4c691812c0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d0b78238607c4bc6838cb8586d9fa328","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9af143b4235847548395f6909fd4f103","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8ee4c45d14b14d85b605e287d13f8565","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1552d14a0e254219b456e924ec517466","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d2a5260cc98d44fcb1116de8133bd99f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3f22b96dd26c4cbe99cb00a8937a5bfd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"747fc0d7f12942ecbef7840b5c1b92e6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3aa38c4af9554bf79d423415d560cf80","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8eff552e800b4868b7dd5dd2006dc6ff","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7e81d6c49cfc4f4c9dee3efea4b8aa80","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-401.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="BERT2Graphsage_files/figure-html/cell-19-output-401.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4d02c89ceae14cb1be2a0d2db5654ae2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e7b78e60bf1849bc97d294676e2f403a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ac32250275094d91b33ee5f4e7b362c2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"27e46f80957140a7917ca93403f35f8c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cd033fc85be64f149bf3eebcfc775b0f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8a97bc864393438f9d70334e5073f1b6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ea9b62027ce847a1b1c71aef0214efb1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"09907d93d32243cca4d41280c98fe1b6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9e37e1731dce4effaa600cf563e9f3e5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"dde7986795024e449148f3db76b52e8c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d62c4c12a5904adbbbc35ef5f5df3445","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f78fa8ed9e9a4c73b544df8dce2eecd2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a1bde8c190b6426784830b60d3312721","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b9d3febfa40b453b98ea0bb832c6d2cf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"26a6586a03634d9284855471ed4ca362","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c8e3ed8260584640982f6569bd571634","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1e237864c2bd4548b2eee87a5472ecea","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"200e26dbf6d146af91efcfea76e11efb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6fbf0e93b93147aba43b79760e015a63","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e878ef4bd358414d9a3c9fbba5ad563e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-422.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="BERT2Graphsage_files/figure-html/cell-19-output-422.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"193c7a58b5854726a12b5377bf5a646a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d42cb65c6db04baab6cd867711b25039","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f6c907e56bf3409c95d810ab6cf36ee3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b4460a17679047388a04bfd2bd3fdc6d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"3b42ab5e33cc42228d125657036a995e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f484ccacac24466eb534b3b9b02335dc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fe12d75c4b924167878390219be572d7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c1d6d6f63a0047da820688cf71dbf208","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e995c6abb6034519bcee997b462113cd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"906968f8c71f45979759dea274429ac8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e69077c3f6104382b6c6b055254513f8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d519ba5d34e845d5ae293ad820abb403","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5c4808b7f154444ba1d0d3e910765d69","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"aaa70147b8ee4f10bff71a2ae2c945ac","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"75c761a6593342ecb5b0362f17289481","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"157619226e104213bbf73800c7e04903","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5f22c79dbf7c4abd8754fa376daea481","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"e238144375214eae9586adacbf9e0542","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6b8d6d50cf8d4ffda16c7828a396e971","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4b02b263198f4792a7e5dc781454effd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-443.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="BERT2Graphsage_files/figure-html/cell-19-output-443.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"87c655007d1e4509b07ec828bea3d6fc","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1f36da5605b44046b5c506fe53576e2c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ded900dc7dc54da9a7839c32f6bc1627","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a75c4c4510424ebf80d8b946bd660887","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a9519cb0130d44e792f677624c965d6b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a84ba7bc807c489ba73bacdc9fe4909d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"15af9da484974a30a099d38361112fa8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"75349f4b25924344bbd84748fe5faf01","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"742ad8d074d24fe4acfb29b97ed802a5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4826eabe361b4fe79db544ed0e87de54","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5865a3566ee8442a8fdd2d2b776a840e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2706b4c6dc3d4076bcbcc35d38e55859","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9be4702d372e40838fa6c4a05088ff39","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"5a8f675a15dc47ea9ac793448f1d11f9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ee1f41a98e224164826f26218d684664","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9eee93e8c0af456c98f51a6a09991488","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"be2c141cad1044808add58a8973cc1de","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6386ad473a7d4cb2a8c7320dd2f91b78","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a98d89d937f94c5aaf52a476472379f7","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b027cfa654f748adb42e6b6b2c92cfa0","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-464.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="BERT2Graphsage_files/figure-html/cell-19-output-464.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d59b91286ea04b33821af5bd82e052e2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d94d62f6e6ff45c38b7e125b93519f7d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7b5fcd09a749459d8fee57248b0ddec3","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c698f859fe7c4a5c82e1f30e211aed48","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6c4ebaa894c7473481f39516ef7d2807","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bac4086d485d4957bb717bf6d72048e4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2cadfb227bd84e30a5b5520a5298c3de","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"586484e1d5d24673bfb1d20b732377f6","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7e2e844bbe65484fa8bd50954a65628a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fea50b117c584eb7b6963a54a966d617","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b85e587c435d4b5a8c2ccc7437b5bbf8","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"f6ab70fb7fc04aa986b6efa7f50144be","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d82cd93eacc64007995dca656737c371","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4a52ac49d0444ba3b112f97fb4cb4c38","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2c098f16d83a44e29ff1eb65654c77af","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1064cdfbda2b4984a5e3346c3d0f627b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ffff6a23fe4e4c6ca01d83fd06b3c25e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"292c297eedb843b9ad17f4a4e3c0c089","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9bcbfb77fc0f4782ae890b919720a91d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"51d0519916814948aad9d39f6a6c9132","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-485.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="BERT2Graphsage_files/figure-html/cell-19-output-485.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"2b03bcce18e04f0abdae9ffe93ef4ebd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7c82259ad93b4af7b46c1e2cfb1d39c2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1f58f8b3d89b4221b654b42249fe8973","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fa57bd91b55c4ba3818f8d24e3e88dd5","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"38096c4c68964d07b170537e8fcd8962","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b5e61e6920754d04a4d1261d0d40436f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"156f1101163b495e9c588a66a64d2899","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cbc81d04c4264c21b4b57cb78c656c9f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"7b92dfac605f443ea077a8021d53c85b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ef132c1de2c64a0fba65d97a6df6a736","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6eb8a5ff933f455e802e83be2dfdb6dd","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"285bdc52edd544689c3c9795a95c7636","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1f07ac5206d44d61b73ec5deae7bdb79","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"38896d60a4954b9fb6be7011b75aeae9","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b592f572428a49e9bf02b9191fa51060","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"aa6035aa86244f099fbe0d12b07b3976","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"58dd061d08b84b89a33da41e5ce14313","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"0becf481cb5f447d9c908f269c4c22ba","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"07f42458a5eb411588ed642504e41b46","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"66f767bc93dc429bb62cbe72e83ebe95","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-19-output-506.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="BERT2Graphsage_files/figure-html/cell-19-output-506.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b948e99559c5448ba4c2d378062c9b2c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"cd2a7a91cdb244678494c2767e7bf61b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"c917f4b456444a96bfe30fa5af60285c","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"69cda301116140429697f073565cb7a1","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"22cfb6b2d6794749aeccab7925d4163a","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a170dade2d5b4bd8b6bfbe7561f95158","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9c5b78fc7ff84f57bec73fdb626aad5e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"37f26481887d4355a8546aa6f1eef05d","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"6e40fafaee59471baa2ddea90d2b0615","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"73f509b2076a423a93924cd4feac3565","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"07a78a9ab34245e88b3f7641bb4e666e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"88f20c3fbb6f44779167517473a95829","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ee8c21831ba044d88953cc2155af4103","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"095bfb1d7db146118c519ca5a1d33598","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"84de2cf3016b49bb923ab560a784d8da","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"dfb3901ea0b741c6bb07d19f107aac43","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"8be03ff81c554616b53c1fad39750587","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"9f1b85579db840f98561caf5f928e89f","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"159a0dc9ff504504bab2440701d70134","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>torch.cuda.empty_cache()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Once the training is complete, we can load our best model and use it to see the AUC/ROC and Confussion matrix plot. Also, we can use it with validation data (comming!) to see how well this is performing.</p>
<div id="cell-49" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> GNNStack(input_dim, hidden_dim, hidden_dim, dropout,num_layers, emb<span class="op">=</span><span class="va">True</span>).to(device)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>best_graphsage_model_path      <span class="op">=</span> <span class="ss">f"GraphSage_epoch_</span><span class="sc">{</span><span class="dv">404</span><span class="sc">}</span><span class="ss">.pt"</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>best_link_predictor_model_path <span class="op">=</span>  <span class="ss">f"link_predictor_epoch_</span><span class="sc">{</span><span class="dv">404</span><span class="sc">}</span><span class="ss">.pt"</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loading best models:  </span><span class="sc">{</span>best_graphsage_model_path <span class="sc">}</span><span class="ss">  </span><span class="sc">{</span>best_link_predictor_model_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>checkpoint <span class="op">=</span> torch.load(best_graphsage_model_path)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>model.load_state_dict(checkpoint[<span class="st">'model_state_dict'</span>])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>()</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>checkpoint <span class="op">=</span> torch.load(best_link_predictor_model_path)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>link_predictor.load_state_dict(checkpoint[<span class="st">'model_state_dict'</span>])</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> checkpoint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loading best models:  GraphSage_epoch_404.pt  link_predictor_epoch_404.pt</code></pre>
</div>
</div>
<p>Run this part, to see the loss and accuracy acroos the epochs:</p>
<div id="cell-51" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">4</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">"Train Loss"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(train_loss)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">"Loss"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">"Epochs"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">"Accuracy"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(train_accuracy)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"accuracy"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">"Epochs"</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="evaluate-diferent-ppi-percentages" class="level2">
<h2 class="anchored" data-anchor-id="evaluate-diferent-ppi-percentages">Evaluate Diferent PPI Percentages</h2>
<p>Is important to see how the model behaves with different percentages of protein-protein interactions:</p>
<div id="cell-54" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="fl">0.01</span>, <span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>]:</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Evaluating Model with </span><span class="sc">{</span>i<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">% of PPI's"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    evaluate(model, link_predictor ,test_loader,device<span class="op">=</span>device,ppi_<span class="op">=</span>i,verbose<span class="op">=</span><span class="va">True</span>,show_extra_metrics<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Evaluating Model with 1.0% of PPI's
 371 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 149 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 284 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 150 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 172 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 261 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 52 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 63 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 148 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 79 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.7248 Sensitivity: 0.035 Specificity: 0.9659

Evaluating Model with 10.0% of PPI's
 3714 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 1490 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 2846 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 1502 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 1722 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 2612 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 528 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 636 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 1487 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 791 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.0496 Sensitivity: 0.6652 Specificity: 0.5561

Evaluating Model with 20.0% of PPI's
 7428 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 2981 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 5693 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 3004 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 3445 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 5224 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 1056 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 1273 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 2974 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 1583 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.1124 Sensitivity: 0.7235 Specificity: 0.6677

Evaluating Model with 30.0% of PPI's
 11142 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 4472 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 8539 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 4506 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 5168 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 7837 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 1585 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 1909 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 4461 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 2375 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.1843 Sensitivity: 0.7657 Specificity: 0.7335

Evaluating Model with 40.0% of PPI's
 14856 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 5963 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 11386 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 6008 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 6891 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 10449 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 2113 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 2546 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 5948 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 3167 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.2490 Sensitivity: 0.7996 Specificity: 0.7621

Evaluating Model with 50.0% of PPI's
 18570 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 7454 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 14233 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 7511 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 8614 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 13062 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 2642 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 3183 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 7435 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 3959 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.3517 Sensitivity: 0.8204 Specificity: 0.8012

Evaluating Model with 60.0% of PPI's
 22284 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 8944 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 17079 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 9013 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 10336 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 15674 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 3170 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 3819 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 8922 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 4750 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.4110 Sensitivity: 0.8645 Specificity: 0.8101

Evaluating Model with 70.0% of PPI's
 25998 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 10435 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 19926 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 10515 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 12059 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 18286 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 3698 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 4456 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 10409 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 5542 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.4037 Sensitivity: 0.8886 Specificity: 0.8195

Evaluating Model with 80.0% of PPI's
 29712 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 11926 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 22772 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 12017 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 13782 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 20899 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 4227 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 5092 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 11896 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 6334 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.5219 Sensitivity: 0.9028 Specificity: 0.8244

Evaluating Model with 90.0% of PPI's
 33426 Positive Protein Interactions were used to Embed a graph with 37140 ppi's
 13417 Positive Protein Interactions were used to Embed a graph with 14908 ppi's
 25619 Positive Protein Interactions were used to Embed a graph with 28466 ppi's
 13519 Positive Protein Interactions were used to Embed a graph with 15022 ppi's
 15505 Positive Protein Interactions were used to Embed a graph with 17228 ppi's
 23511 Positive Protein Interactions were used to Embed a graph with 26124 ppi's
 4755 Positive Protein Interactions were used to Embed a graph with 5284 ppi's
 5729 Positive Protein Interactions were used to Embed a graph with 6366 ppi's
 13383 Positive Protein Interactions were used to Embed a graph with 14870 ppi's
 7126 Positive Protein Interactions were used to Embed a graph with 7918 ppi's
Youdens  index: 0.6208 Sensitivity: 0.9041 Specificity: 0.8435
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="BERT2Graphsage_files/figure-html/cell-23-output-2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="BERT2Graphsage_files/figure-html/cell-23-output-3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="BERT2Graphsage_files/figure-html/cell-23-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="BERT2Graphsage_files/figure-html/cell-23-output-5.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="BERT2Graphsage_files/figure-html/cell-23-output-6.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="BERT2Graphsage_files/figure-html/cell-23-output-7.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="BERT2Graphsage_files/figure-html/cell-23-output-8.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-9.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="BERT2Graphsage_files/figure-html/cell-23-output-9.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-10.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="BERT2Graphsage_files/figure-html/cell-23-output-10.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="BERT2Graphsage_files/figure-html/cell-23-output-11.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="BERT2Graphsage_files/figure-html/cell-23-output-11.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>It’s obvious that increaings the PPI percentage the model will learn more and get better accuracy.</p>
<p>Okay! We trained a graph neural network that predict protein-protein interactions!</p>
<p>It’s important to mention two things:</p>
<ul>
<li>Big part of the code on this post is reused from the work of <a href="https://github.com/Ale9806/BERT2SAGE_Enhancing_LLMs/blob/main/FINAL/Final_ProBERT2SAGE.ipynb">Perez et al</a>.</li>
<li>Perez et al.&nbsp;also trained a DistMult based prediction model (an <strong><em>a priori</em></strong> model) that doesn’t need graph structure knowledge. I tried to implement this but, due to the small gene set (<strong>Unfolded protei binding</strong>), this model doesn’t improve larger than 5% percent of accuracy.</li>
</ul>
<p>Finally, on the next post, I will use this trained model to predict the protein-protein interactions of the proteins expressed by identified genes in a transcriptomic experiment made on <em>Coffea arabica</em>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/pipaber\.github\.io\/Portfolio\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Made with <a href="https://quarto.org/">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
<p><a href="mailto:p.palacios.bernuy@gmail.com">Contact Piero Palacios</a></p>
</div>
    <div class="nav-footer-right">
<p><a href="https://github.com/pipaber">Github Code Repo</a></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","loop":false,"closeEffect":"zoom","descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>