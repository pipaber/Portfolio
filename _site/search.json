[
  {
    "objectID": "posts/time_series/time_series_analysis.html",
    "href": "posts/time_series/time_series_analysis.html",
    "title": "Analysis of Time-series Data",
    "section": "",
    "text": "On this project, we’ll analyze the annual average temperature from Peru.\nCode\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.linear_model import LinearRegression\nfrom scipy.interpolate import interp1d\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom bokeh.io import output_notebook, show, export_png\n# from bokeh.io import output_file\nfrom bokeh.plotting import figure\nfrom itertools import chain \nfrom sklearn.metrics import mean_squared_error\nimport datetime as dt\nimport statsmodels.api as sm\nfrom statsmodels.graphics.tsaplots import plot_acf,plot_pacf\nfrom statsmodels.tsa.ar_model import AutoReg\nfrom statsmodels.tsa.arima.model import ARIMA\nimport pmdarima as pm\nimport seaborn as sns\nimport math\nimport pmdarima as pm\nimport statsmodels.api as sm\ndef mean_absolute_percentage_error(y_true, y_pred): \n     return np.mean(np.abs((y_true - y_pred) / y_true)) *100\noutput_notebook()\n\n\n    \n    \n        \n        Loading BokehJS ..."
  },
  {
    "objectID": "posts/time_series/time_series_analysis.html#removing-the-trend",
    "href": "posts/time_series/time_series_analysis.html#removing-the-trend",
    "title": "Analysis of Time-series Data",
    "section": "Removing the Trend",
    "text": "Removing the Trend\n\nLinear Trend\nFirst let’s define the functions to calculate the Akaike Information Criteria and the Bayesian Information Criteria to test the performance of our models.\n\n\nCode\nfrom scipy.stats import norm \ndef evaluate_AIC(k, residuals):\n  \"\"\"\n  Finds the AIC given the number of parameters estimated and \n  the residuals of the model. Assumes residuals are distributed \n  Gaussian with unknown variance. \n  \"\"\"\n  standard_deviation = np.std(residuals)\n  log_likelihood = norm.logpdf(residuals, 0, scale=standard_deviation)\n  return 2 * k - 2 * np.sum(log_likelihood)\n\ndef evaluate_BIC(k, residuals):\n  \"\"\"\n  Finds the AIC given the number of parameters estimated and \n  the residuals of the model. Assumes residuals are distributed \n  Gaussian with unknown variance. \n  \"\"\"\n  standard_deviation = np.std(residuals)\n  log_likelihood = norm.logpdf(residuals, 0, scale=standard_deviation)\n  return k * np.log(len(residuals)) - 2 * np.sum(log_likelihood)\n\n\nNow, we can begin fitting a linear trend to the data.\n\n\nCode\nX = subset_df[\"Year\"].values.reshape(-1,1)\ny = subset_df[\"Temp_annual_mean\"].values.reshape(-1,1)\n\n\nlinear_model = LinearRegression()\nlinear_model.fit(X, y)\n\nprint(linear_model.coef_)\n\ny_hat = linear_model.predict(X)\n\nplt.plot(X, y, label='original data')\nplt.plot(X, y_hat, 'r', label='fitted line')\nplt.legend()\n\n\n\n[[0.01386713]]\n\n\n\n\n\n\n\n\n\nAnd plot the residuals of the model.\n\n\nCode\nlinear_residuals = y - y_hat\nplt.plot(X, linear_residuals,'o')\nsns.regplot(x=X, y=linear_residuals)\n\nprint(\"MSE with linear fit:\", np.mean((linear_residuals)**2))\nprint(\"AIC:\", evaluate_AIC(1, linear_residuals))\nprint(\"BIC:\", evaluate_BIC(1, linear_residuals))\n\n\nMSE with linear fit: 0.12615193027776006\nAIC: 57.2678309969092\nBIC: 59.54449711592525\n\n\n\n\n\n\n\n\n\nThe plot shows a good distribution of the residuals.\nLet’s check the autocorrelation and partial autocorralation of the residuals.\n\n\nCode\nsm.graphics.tsa.plot_acf(linear_residuals, lags=20)\nplt.show()\nsm.graphics.tsa.plot_pacf(linear_residuals, lags=20)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIt seems there is an autocorrelation structure on the data.\n\n\nQuadratic Trend\nTo check that the linear trend is a good choice, let’sw compare it with a quadratic fit.\n\n\nCode\ndegree=2\nquadratic_model=LinearRegression()\n\nnew_x = np.hstack((X, X **2))\n\nquadratic_model.fit(new_x, y)\nquadratic = quadratic_model.predict(new_x)\n\nprint(quadratic_model.coef_)\n\ny_hat_quad = quadratic_model.predict(new_x)\n\nplt.plot(X, y, label='original data')\nplt.plot(X, y_hat_quad, 'r', label='fitted line')\nplt.legend()\n\n\n[[ 5.74495264e-01 -1.41109523e-04]]\n\n\n\n\n\n\n\n\n\nThe residuals:\n\n\nCode\nquadratic_residuals = y - y_hat_quad\nplt.plot(X, quadratic_residuals,'o')\nsns.regplot(x=X, y=quadratic_residuals)\n\nprint(\"MSE with linear fit:\", np.mean((quadratic_residuals)**2))\nprint(\"AIC:\", evaluate_AIC(2, quadratic_residuals))\nprint(\"BIC:\", evaluate_BIC(2, quadratic_residuals))\n\n\nMSE with linear fit: 0.12318196679493859\nAIC: 57.55248071646069\nBIC: 62.105812954492805\n\n\n\n\n\n\n\n\n\nAnd the autocorrelation plots.\n\n\nCode\nsm.graphics.tsa.plot_acf(quadratic_residuals, lags=20)\nplt.show()\nsm.graphics.tsa.plot_pacf(quadratic_residuals, lags=20)\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThese plots (ACF and PACF) shows that there might be a autocorrelation of order 16 (AR(16)) and possibly a moving average of order 13. Let’s make a grid search over possible values to corroborate this.\n\n\nCode\ndef grid_search_ARIMA(data, AR_range, MA_range, verbose=False):\n  min_aic = np.inf \n  min_bic = np.inf\n  min_aic_index = None\n  min_bic_index = None \n  aic_matrix = np.zeros((len(AR_range), len(MA_range)))\n  bic_matrix = np.zeros((len(AR_range), len(MA_range)))\n  for AR_order in AR_range:\n    for MA_order in MA_range:\n      arma = ARIMA(data, order=(AR_order, 0, MA_order)).fit()\n      aic_matrix[AR_order, MA_order] = arma.aic\n      bic_matrix[AR_order, MA_order] = arma.bic\n      if arma.aic &lt; min_aic:\n        min_aic = arma.aic\n        min_aic_index = (AR_order, 0, MA_order)\n      if arma.bic &lt; min_bic:\n        min_bic = arma.bic\n        min_bic_index = (AR_order, 0, MA_order)\n  if verbose:\n    print(\"Minimizing AIC order: \", min_aic_index)\n    print(\"Minimizing BIC order: \", min_bic_index )\n    print(\"matrix of AIC\", aic_matrix)\n    print(\"Matrix of BIC\", bic_matrix)\n  return min_aic_index, min_bic_index, aic_matrix, bic_matrix\n\n\nLuckily, statsmodels give us the BIC and AIC scores for each models we are building. We are using these scores to get the best model in our grid search.\n\n\nCode\nmin_aic_index, min_bic_index, _, _ = grid_search_ARIMA(linear_residuals, range(20), range(20), verbose=True)\nif min_aic_index == min_bic_index:\n  arma = ARIMA(linear_residuals, order=min_bic_index).fit()\n  print(arma.summary())\n  arma_predictions = arma.predict()\n  arma_residuals = linear_residuals - arma_predictions\n  arma_residuals = arma_residuals # Fitting AR 1 model means removing one observation\n  plt.plot(linear_residuals, label='Residuals from fitted quadratic line')\n  plt.plot(arma_predictions, 'r', label='fitted ARMA process')\n  plt.legend()\n  plt.show()\n  plt.plot(arma_residuals, 'o')\n  plt.show()\n  print(\"Automatic selection finds model with AR {0}, MA {2}\".format(*min_aic_index))\n  print(\"MSE with selected model:\", np.mean(arma_residuals**2))\nelse:\n  print(\"AIC, BIC do not agree.\")\n\n\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:978: UserWarning: Non-invertible starting MA parameters found. Using zeros as starting parameters.\n  warn('Non-invertible starting MA parameters found.'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:966: UserWarning: Non-stationary starting autoregressive parameters found. Using zeros as starting parameters.\n  warn('Non-stationary starting autoregressive parameters'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\n\n\nMinimizing AIC order:  (2, 0, 9)\nMinimizing BIC order:  (0, 0, 0)\nmatrix of AIC [[59.26783104 58.54992334 56.88970575 57.79945966 59.13858623 61.06132125\n  60.10357216 56.70724639 58.53031492 58.79141029 56.50215466 53.83056416\n  55.53360818 55.23182903 56.25011347 58.29607542 59.22370895 60.69622205\n  62.22647076 64.27980123]\n [60.01838137 59.01196539 54.78314438 58.68975059 58.21367941 58.11925325\n  59.0577748  59.45027904 60.73655131 59.9252463  57.17792233 55.7365912\n  57.5279835  56.6732098  58.58560271 59.49982214 61.03576455 62.8378866\n  64.5385872  66.80960379]\n [55.60204822 57.44397806 55.93590971 55.28516924 59.26120688 56.7676285\n  56.48409178 57.10386856 56.64832604 52.86203264 54.153882   54.80353584\n  54.92519604 57.89801211 59.59621413 61.05672236 62.98633782 64.98255721\n  64.98545754 68.24167112]\n [57.3687478  59.32047137 60.25882172 56.45016306 54.39221592 54.65960306\n  64.22394424 60.57746518 57.70426024 54.70458015 55.95799305 56.65596753\n  57.6468255  58.81023372 60.48193877 61.72053194 65.92771418 67.04341717\n  70.63721548 71.18084068]\n [59.14942574 60.16696732 55.43512106 54.60174117 59.66358505 56.90480476\n  59.81984521 61.72126301 53.78122065 54.47597726 56.43000237 58.33943936\n  59.79851906 60.74759539 61.9397838  62.61877092 67.76229664 69.2277279\n  72.87708691 72.62363139]\n [60.40981264 62.39919653 59.42642447 61.54330408 57.78042654 58.96114785\n  61.09524713 61.63167538 53.60862951 54.66052224 55.9339392  60.1296563\n  62.18164813 62.99282536 66.0525596  65.26549479 69.14330159 70.87240071\n  68.02871147 72.67504957]\n [62.40170224 64.39927888 60.62995123 63.6825648  59.7051804  61.33200669\n  59.13415    62.02401831 57.66308719 61.11610053 60.06519047 60.26112098\n  64.19789296 61.2653695  64.85471283 65.67339349 69.7437752  72.95251941\n  69.57430322 74.94677503]\n [64.34447628 60.05935422 62.3969647  63.67303358 64.07209862 65.60416731\n  62.05504141 64.51656351 66.05892528 59.65529841 61.98584232 61.35293391\n  65.47289344 64.66384057 64.41897783 62.29931871 69.36109345 72.72596842\n  68.78138574 69.50693126]\n [64.41545455 61.71415914 63.54795097 65.66333692 60.10808786 59.90569828\n  62.10370484 58.32770199 61.4240911  59.83238655 63.13851866 64.06893123\n  62.06925577 64.08994125 66.73659766 69.73560144 72.76526793 74.67639407\n  72.32997535 72.5167611 ]\n [58.88763152 60.62032348 56.32174956 58.37109165 57.18127799 57.9979968\n  60.13371869 61.8217613  62.45246858 63.26705539 63.28433601 65.33991341\n  64.15416778 65.80591849 70.40735139 71.09551673 73.70837078 76.31432766\n  74.15964268 74.54904043]\n [60.46185714 62.33316031 57.97652193 59.98767802 60.01699452 59.91525829\n  62.02879216 62.3272774  61.43014887 63.45995718 64.57083238 66.79380038\n  66.72756485 62.78569633 65.79729765 69.1037027  74.05271602 73.91032018\n  68.89454402 75.9429185 ]\n [61.97041927 63.91206891 59.64344611 61.37400935 59.57250674 61.58339273\n  62.7480419  63.38369221 63.97563916 64.35159438 64.63662196 68.0292894\n  69.88978561 65.25591315 65.13319861 67.43781895 75.88506935 75.93701685\n  75.14617187 76.36974229]\n [63.63597058 62.35808653 60.84634222 63.04798246 61.54304906 63.55419996\n  64.79509909 62.54784339 65.39007171 65.64030002 65.31843543 70.37120629\n  70.72790305 68.9481488  72.08035365 75.70498209 72.73480547 75.58563942\n  73.68754741 84.29162461]\n [62.98285503 64.80495154 65.32919463 60.45838337 62.96135175 62.08647299\n  64.51344513 64.89266037 66.59345037 67.44881901 66.7480505  66.31208872\n  70.37463005 72.42160464 72.37227087 76.39744907 77.08760943 75.30260452\n  75.91255923 76.75954076]\n [64.76611924 66.75592971 64.61713126 62.71140589 65.36156186 67.48855684\n  65.42719093 67.81803452 68.75615495 69.4207174  69.759826   70.60916283\n  72.37711488 74.19570454 73.67777429 78.21254447 77.36334509 79.6251962\n  77.72553906 78.9407086 ]\n [66.66293554 67.77980308 65.4544313  64.58883831 67.92109901 66.55639664\n  69.36610887 70.43391218 71.42742349 70.20057968 70.55349007 73.33025119\n  74.52506171 71.74668773 73.83554345 78.81700438 75.63752456 84.31020079\n  78.81331696 80.25713868]\n [64.05594172 65.94136223 67.58710883 69.04508423 65.47736499 71.29129912\n  69.14330891 69.09748835 69.53539203 69.88838457 71.5360232  73.17185656\n  72.45100046 72.30233633 78.24445035 75.79644228 82.82074378 79.51804671\n  79.82388504 79.81846245]\n [65.88340344 67.31991573 69.24121591 71.03278703 68.52191482 70.5365999\n  70.43184559 70.42099772 71.33343091 71.80401553 73.80889981 74.70363714\n  72.4465451  75.79010158 80.5398399  77.62198717 84.90464036 81.8517004\n  81.86401746 80.84358572]\n [67.46843461 68.93356711 71.14867163 71.50327634 69.79037073 71.63167747\n  70.42909044 72.42562339 72.59689936 72.7441992  73.6218613  75.96098587\n  78.51198994 79.27065894 82.11453555 78.47673277 86.52803398 82.67852269\n  83.09122525 84.83274228]\n [68.49571987 70.38710021 72.13463923 74.21073296 69.51714758 70.5919664\n  74.10239936 74.12004659 74.02198301 74.31395149 75.73698092 78.07651132\n  80.45214899 78.70575615 83.66879418 80.77171565 82.83606246 84.96232135\n  85.25326334 87.06597314]]\nMatrix of BIC [[ 63.82116328  65.3799217   65.99637023  69.18279025  72.79858294\n   76.99798408  78.31690112  77.19724146  81.29697612  83.8347376\n   83.82214809  83.4272237   87.40693385  89.38182081  92.67677138\n   96.99939945 100.20369909 103.95287831 107.75979314 112.08978973]\n [ 66.84837973  68.11862987  66.16647497  72.3497473   74.15034224\n   76.3325822   79.54776987  82.21694023  85.77987862  87.24523973\n   86.77458187  87.60991686  91.67797528  93.09986771  97.28892673\n  100.47981228 104.29242081 108.37120898 112.3485757  116.8962584 ]\n [ 64.7087127   68.82730865  69.59590642  71.22183207  77.47453583\n   77.25762357  79.25075297  82.14719587  83.96831946  82.45869219\n   86.02720766  88.95352763  91.35185395  96.60133613 100.57620427\n  104.31337862 108.5196602  112.79254571 115.07211216 120.60499185]\n [ 68.75207839  72.98046809  76.19548456  74.66349201  74.88221099\n   77.42626425  89.26727155  87.89745861  87.30091979  86.57790582\n   90.10798483  93.08262544  96.35014952  99.79022387 103.73859503\n  107.25385432 113.73770268 117.13007179 123.00053622 125.82082754]\n [ 72.80942245  76.10363015  73.64845002  75.09173625  82.43024624\n   81.94813207  87.13983863  91.31792256  85.65454631  88.62596904\n   92.85666027  97.04276338 100.7785092  104.00425165 107.47310618\n  110.42875942 117.84895126 121.59104863 127.51707377 129.54028437]\n [ 76.34647547  80.61252548  79.91641954  84.30996527  82.82375385\n   86.28114128  90.69190667  93.50500105  87.7586213   91.08718014\n   94.63726322 101.10964645 105.43830439 108.52614774 113.8625481\n  115.35214941 121.50662232 125.51238756 124.94536444 131.86836866]\n [ 80.61503119  84.88927395  83.39661242  88.72589211  87.02517383\n   90.92866623  91.00747567  96.17401009  94.08974509  99.81942455\n  101.04518061 103.51777724 109.73121534 109.075358   114.94136745\n  118.03671422 124.38376205 129.86917238 128.76762232 136.41676025]\n [ 84.83447135  82.82601541  87.44029201  90.993027    93.66875817\n   97.47749297  96.2050332  100.94322142 104.7622493  100.63528855\n  105.24249858 106.88625629 113.28288194 114.75049518 116.78229856\n  116.93930556 126.27774643 131.91928751 130.25137096 133.25358259]\n [ 87.18211574  86.75748645  90.8679444   95.25999647  91.98141352\n   94.05569006  98.53036274  97.03102601 102.40408124 103.08904281\n  108.67184104 111.87891973 112.15591039 116.45326198 121.37658451\n  126.65225441 131.95858702 136.14637929 136.07662668 138.54007855]\n [ 83.93095883  87.94031691  85.91840911  90.24441732  91.33126978\n   94.4246547   98.83704271 102.80175144 105.70912484 108.80037777\n  111.09432451 115.42656803 116.51748852 120.44590535 127.32400437\n  130.28883582 135.17835599 140.060979   140.18296014 142.849024  ]\n [ 87.78185057  91.92981986  89.8498476   94.13766981  96.44365243\n   98.61858231 103.00878231 105.58393366 106.96347125 111.26994568\n  114.657487   119.15712111 121.36755171 119.70234931 124.99061675\n  130.57368792 137.79936735 139.93363763 137.19452759 146.51956819]\n [ 91.56707882  95.78539457  93.7934379   97.80066725  98.27583076\n  102.56338287 106.00469816 108.91701459 111.78562766 114.43824899\n  116.99994269 122.66927626 126.80643859 124.44923224 126.60318382\n  131.18447028 141.9083868  144.23700042 145.72282155 149.2230581 ]\n [ 95.50929625  96.50807831  97.27300013 101.75130648 102.5230392\n  106.81085622 110.32842147 110.35783189 115.47672633 118.00362076\n  119.95842229 127.28785927 129.92122214 130.41813401 135.82700499\n  141.72829954 141.03478904 146.16228911 146.54086321 159.42160654]\n [ 97.13284681 101.23160944 104.03251865 101.43837351 106.21800801\n  107.61979537 112.32343363 114.97931498 118.95677111 122.08880587\n  123.66470348 125.50540782 131.84461527 136.16825597 138.39558832\n  144.69743264 147.66425912 148.15592033 151.04254115 154.1661888 ]\n [101.19277714 105.45925373 105.5971214  105.96806216 110.89488424\n  115.29854534 115.51384555 120.18135525 123.39614181 126.33737037\n  128.9531451  132.07914804 136.12376621 140.21902199 141.97775786\n  148.78919416 150.2166609  154.75517812 155.1321871  158.62402277]\n [105.36625956 108.75979323 108.71108756 110.12216069 115.73108751\n  116.64305126 121.72942961 125.07389904 128.34407646 129.39389877\n  132.02347528 137.07690252 140.54837916 140.0466713  144.41219314\n  151.67032019 150.76750649 161.71684884 158.49663112 162.21711897]\n [105.03593186 109.19801849 113.12043121 116.85507273 115.56401961\n  123.65461985 123.78329577 126.01414133 128.72871113 131.35836978\n  135.28267454 139.19517401 140.75098403 142.87898602 151.09776615\n  150.92642421 160.22739182 159.20136088 161.78386532 164.05510885]\n [109.1400597  112.85323811 117.05120441 121.11944165 120.88523556\n  125.17658676 127.34849856 129.61431681 132.80341612 135.55066687\n  139.83221727 143.00362071 143.02319479 148.64341738 155.66982183\n  155.02863522 164.58795452 163.81168069 166.10066386 167.35689825]\n [113.00175699 116.74355561 121.23532625 123.86659708 124.43035759\n  128.54833044 129.62240953 133.89560861 136.34355069 138.76751665\n  141.92184487 146.53763555 151.36530575 154.40064086 159.52118359\n  158.16004693 168.48801427 166.91516909 169.60453777 173.62272092]\n [116.30570837 120.47375483 124.49795997 128.85071981 126.43380055\n  129.78528549 135.57238458 137.86669792 140.04530046 142.61393506\n  146.31363061 150.92982713 155.58213092 156.1124042  163.35210835\n  162.73169593 167.07270886 171.47563387 174.04324199 178.1326179 ]]\nAIC, BIC do not agree.\n\n\nWe see that the grid search output an ARMA(2,9) model. Let’s work with this model and form forecasts.\nTo evaluate the model we will use a rolling window cross-validation. This will help us view how the model improve as we include more time series data. The window we are gonna use is 20 years and we’ll forecast 20 years.\n\n\nCode\nwindow_size = 20\n\nfor i in range(20,72,window_size):\n    \n    train_temp, test_temp = quadratic_residuals[:i], quadratic_residuals[i:i+window_size]\n    train_date, test_date = X[:i], X[i:i+window_size]\n    arma = ARIMA(train_temp, order=min_aic_index).fit()\n    # print(arma.summary())\n    fig, ax = plt.subplots(figsize=(15, 5))\n    fcast = arma.get_forecast(len(test_temp)).summary_frame()\n\n    arma_predictions = arma.predict()\n    ax.plot(X, quadratic_residuals, label='annual mean T°C, converted to stationary time series')\n    predicted_values = arma_predictions.reshape(-1,1)\n    ax.plot(train_date, predicted_values, 'r', label='fitted line')\n    forecast_means = fcast['mean'].values.reshape(-1,1)\n    test_set_mse = np.mean((forecast_means.reshape(test_temp.shape) - test_temp)**2)\n    ax.plot(test_date, forecast_means, 'k--', label='mean forecast')\n    ax.fill_between(test_date.flatten(), fcast['mean_ci_lower'], fcast['mean_ci_upper'], color='k', alpha=0.1);\n    plt.legend();\n    print(\"Test set mean squared error: \", test_set_mse)\n\n\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:866: UserWarning: Too few observations to estimate starting parameters for ARMA and trend. All parameters except for variances will be set to zeros.\n  warn('Too few observations to estimate starting parameters%s.'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:966: UserWarning: Non-stationary starting autoregressive parameters found. Using zeros as starting parameters.\n  warn('Non-stationary starting autoregressive parameters'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:978: UserWarning: Non-invertible starting MA parameters found. Using zeros as starting parameters.\n  warn('Non-invertible starting MA parameters found.'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:978: UserWarning: Non-invertible starting MA parameters found. Using zeros as starting parameters.\n  warn('Non-invertible starting MA parameters found.'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\n\n\nTest set mean squared error:  0.20590924950605077\nTest set mean squared error:  0.09063865739126532\nTest set mean squared error:  0.039150953597273795\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn the first plot, we can see that only using 20 values for training, the forecast converge to the mean of the series. And, as we continue including data, the forcast improve.\nLet’s see if using an external variable (in this case the annual mean precipitation) improve our model.\n\n\nCode\nwindow_size = 20\n\nfor i in range(20,72,window_size):\n    \n    train_temp, test_temp = quadratic_residuals[:i], quadratic_residuals[i:i+window_size]\n    train_date, test_date = X[:i], X[i:i+window_size]\n\n    train_prec, test_prec = subset_df[\"Prec_annual_mean\"].values.reshape(-1,1)[:i], subset_df[\"Prec_annual_mean\"].values.reshape(-1,1)[i:i+window_size]\n\n\n    arma = ARIMA(train_temp, order=min_aic_index, exog=train_prec).fit()\n    # print(arma.summary())\n    fig, ax = plt.subplots(figsize=(15, 5))\n    fcast = arma.get_forecast(len(test_temp), exog=test_prec).summary_frame()\n\n    arma_predictions = arma.predict()\n    ax.plot(X, quadratic_residuals, label='annual mean T°C, converted to stationary time series')\n    predicted_values = arma_predictions.reshape(-1,1)\n    ax.plot(train_date, predicted_values, 'r', label='fitted line')\n    forecast_means = fcast['mean'].values.reshape(-1,1)\n    test_set_mse = np.mean((forecast_means.reshape(test_temp.shape) - test_temp)**2)\n    ax.plot(test_date, forecast_means, 'k--', label='mean forecast')\n    ax.fill_between(test_date.flatten(), fcast['mean_ci_lower'], fcast['mean_ci_upper'], color='k', alpha=0.1);\n    plt.legend();\n    print(\"Test set mean squared error: \", test_set_mse)\n\n\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:866: UserWarning: Too few observations to estimate starting parameters for ARMA and trend. All parameters except for variances will be set to zeros.\n  warn('Too few observations to estimate starting parameters%s.'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:966: UserWarning: Non-stationary starting autoregressive parameters found. Using zeros as starting parameters.\n  warn('Non-stationary starting autoregressive parameters'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:978: UserWarning: Non-invertible starting MA parameters found. Using zeros as starting parameters.\n  warn('Non-invertible starting MA parameters found.'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\tsa\\statespace\\sarimax.py:978: UserWarning: Non-invertible starting MA parameters found. Using zeros as starting parameters.\n  warn('Non-invertible starting MA parameters found.'\nc:\\Users\\LENOVO\\miniconda3\\envs\\piero\\lib\\site-packages\\statsmodels\\base\\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals\n  warnings.warn(\"Maximum Likelihood optimization failed to \"\n\n\nTest set mean squared error:  0.18613318748268368\nTest set mean squared error:  0.11609711371821685\nTest set mean squared error:  0.07317563428347647\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can see that including the precipitation doesn’t improve the predictions of temperature on this ARMA(2,9) model. This analysis use the autoregressive models to get forecasts on time series data but, nowadays this methods can be extenden with deep learning models like recurrent neural networks or transformers to have better predictions. Also, is possible to make a temporal-spatial analysis using gaussian processes plus deep learning models."
  },
  {
    "objectID": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html",
    "href": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html",
    "title": "Analysis of Hyper-parameters on Single Cell RNA-Seq Data",
    "section": "",
    "text": "Code\nimport numpy as np\nimport pandas as pd\nfrom sklearn.decomposition import PCA\nimport matplotlib.pyplot as plt\nfrom sklearn.manifold import MDS\nfrom sklearn.manifold import TSNE\nfrom sklearn.cluster import KMeans\nfrom sklearn.mixture import GaussianMixture\nfrom sklearn.metrics import silhouette_score, silhouette_samples\nfrom sklearn.linear_model import LogisticRegression, LogisticRegressionCV\nfrom sklearn.metrics import silhouette_score, silhouette_samples\nimport scanpy as sc\nfrom sklearn.model_selection import train_test_split\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff"
  },
  {
    "objectID": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html#getting-the-data",
    "href": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html#getting-the-data",
    "title": "Analysis of Hyper-parameters on Single Cell RNA-Seq Data",
    "section": "Getting the Data",
    "text": "Getting the Data\nWe will analyze three types of hyper-parameters: Perplexity on t-SNE, number of clusters chosen from an unsupervised method and how these affect the quality of the selected features and how the number of PC’s affect the t-SNE.\nTo performs these three tasks we are gonna work with real data. Specifically, we’re gonna use scRNA-Seq data from a brain sample (GSM6900730). The data is available on this link.\nIn our case, let’s do a basic web scrapping code to get the data.\n\n\nCode\n# download the data and load it for the posterior analysis\nimport urllib.parse\nimport requests\nimport urllib\nfrom bs4 import BeautifulSoup\nimport os\nfrom ftplib import FTP\n\nurl = \"https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM6900730\"\n\nresponse = requests.get(url)\n\nsoup = BeautifulSoup(response.text, 'html.parser')\n\ntable = soup.find('table')\nlinks = table.find_all('a')\n\ndownload_dir = os.getcwd()\n\nfor link in links:\n    # Get the URL of the link\n    link_url = link.get('href')\n    # Check if the link contains 'ftp'\n    if link_url and 'ftp' in link_url:\n        # Parse the FTP URL\n        link_url = urllib.parse.unquote(link_url)\n        parsed_url = urllib.parse.urlparse(link_url)\n        hostname = parsed_url.hostname\n        path = parsed_url.path\n        \n        # Connect to the FTP server\n        ftp = FTP(hostname)\n        ftp.login()\n        ftp.cwd(os.path.dirname(path))\n    \n        # Extract the file name from the path\n        file_name = os.path.basename(path)\n        local_file_path = os.path.join(download_dir, file_name)\n        \n        with open(local_file_path, \"wb\") as local_file:\n            ftp.retrbinary(f\"RETR {file_name}\", local_file.write)\n    \n        ftp.quit()\n        print(f\"Downloaded {file_name}\")\n        \n\n\nDownloaded GSM6900730_JLE16_B1_barcodes.tsv.gz\nDownloaded GSM6900730_JLE16_B1_features.tsv.gz\nDownloaded GSM6900730_JLE16_B1_matrix.mtx.gz\n\n\nNow, let’s load the data (is a sparse matrix) with scanpy:\n\n\nCode\nscdata = sc.read_10x_mtx('D:/Data Analysis Statistical Modeling and Computation in Applications/data/scrnaseq data/',\n                         var_names = 'gene_symbols',\n                         cache=False)\n\nX_sc = scdata.X.toarray()\nprint(X_sc.shape)\n\n\n(5154, 36601)\n\n\nOk, now we are gonna tranform the data with (log(x+1)) due to the presence of genes with extremely high magnitudes of expression in only a few cells.\n\n\nCode\nX_sc_transformed = np.log2(X_sc + 1)\n\n\nWe can use the principal components analysis to get the top components that explains the 85% variability of the data.\n\n\nCode\n# PCA\n\npca = PCA()\npca_axes = pca.fit_transform(X_sc_transformed)\n\n\ncsum = np.cumsum(pca.explained_variance_ratio_)\nplt.plot(np.arange(0,X_sc_transformed.shape[0]),csum)\nplt.xlabel('Component #')\nplt.ylabel('% of Variance Explained')\nplt.title('% Variance explained by # Components')\nplt.show()\n\nprint(f'Variance explained 85%: {np.where(csum &gt;= 0.85)[0][0]}')\n\n\n\n\n\n\n\n\n\nVariance explained 85%: 1758\n\n\nLet’s save the number of components on a variable.\n\n\nCode\ntop_pca_components = np.where(csum &gt;= 0.85)[0][0]"
  },
  {
    "objectID": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html#analysis-of-perplexities",
    "href": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html#analysis-of-perplexities",
    "title": "Analysis of Hyper-parameters on Single Cell RNA-Seq Data",
    "section": "Analysis of Perplexities",
    "text": "Analysis of Perplexities\nFor the first part of the analysis, we are gonna analyze the following perplexities: 10,20,30,40,50 and see how this change the output of the t-SNE analysis.\n\n\nCode\n# let's write a helper function for the tsne\n\ndef tsne_plotter(data=None,per=40):\n\n    tsne = TSNE(n_components=2, perplexity=per)\n\n    x_tsne = tsne.fit_transform(data)\n\n    ax.scatter(x_tsne[:, 0], x_tsne[:, 1])\n    ax.set_xlabel('tSNE 1')\n    ax.set_ylabel('tSNE 2')\n    ax.set_title(f't-SNE Plot for log2\\nTransformed Data, Perplexity:{per}')\n\n\n\n\nCode\nperplexities = [10,20,30,40,50]\n\nnum_plots = len(perplexities)\nnum_rows = 2\nnum_cols = 3\nfig, axes = plt.subplots(num_rows, num_cols, figsize=(10,8))\n\nfor i,perplexity in enumerate(perplexities):\n\n    row = i // num_cols\n    col = i % num_cols\n    ax = axes[row, col]\n\n    tsne_plotter(pca_axes[:,0:50], per= perplexity)\n\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\nWe can see that increasing the perplexity values make the clusters more defined. This is in consonance with the definition of the perplexity parameter which says: “The perplexity is related to the number of nearest neighbors that is used in other manifold learning algorithms. Larger datasets usually require a larger perplexity. Consider selecting a value between 5 and 50. Different values can result in significantly different results. The perplexity must be less than the number of samples”. Also, we can notice that from the perplexity value 30 to 50 there are more defined clusters; specifically, for perplexity 50 we see six more defined clusters so, this is the perplexity value chosen for the following analyses."
  },
  {
    "objectID": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html#number-of-clusters-chosen-from-an-unsupervised-method",
    "href": "posts/Naive_scRNA-Seq_analysis/naive_scrnaseq_analysis.html#number-of-clusters-chosen-from-an-unsupervised-method",
    "title": "Analysis of Hyper-parameters on Single Cell RNA-Seq Data",
    "section": "Number of Clusters Chosen from an Unsupervised Method",
    "text": "Number of Clusters Chosen from an Unsupervised Method\nFor this part of the analysis on the scRNA-Seq data, we are gonna use the Gaussian Mixture algorithm to get predictec clusters on the data. Then, using these clusters as “labels” we can perform a logistic regression and see how the test score changes when we change the number of clusters.\nFor this part, we are gonna use the first 2256 principal components with the objective of a precise analysis.\n\n\nCode\nnp.where(csum &gt;= 0.9)[0][0]\n\n\n2256\n\n\nWith 2256 PC’s we achieve 90% of explained variability.\nNow, let’s perform the clustering with the GMM model from 2 to 20 clusters. Also, let’s plot the BIC (Bayesian Information Criterion) and the Silhouette plot to see how many clusters we can select.\n\n\nCode\n## Clustering elbow plot GMM\n\nn_components_range = range(2, 21)\nbic_scores = []\n\nfor n_components in n_components_range:\n    gmm = GaussianMixture(n_components=n_components, random_state=0, init_params='kmeans')\n    gmm.fit(pca_axes[:,0:2256])\n    # print(f'# comp: {n_components}')\n    bic_scores.append(gmm.bic(pca_axes[:,0:2256]))\n\nplt.plot(n_components_range, bic_scores, marker='o', linestyle='-')\nplt.xlabel('Number of Components')\nplt.ylabel('BIC Score')\nplt.title('Elbow Plot for Gaussian Mixture Model')\nplt.xticks(n_components_range)\nplt.grid(True)\n\nplt.show()\n\n\n\n\n\n\n\n\n\nThe BIC score tells us that between 4 and 5 clusters can be a good choice.\n\n\nCode\n## Silhouette plot\n#\nn_components_range = range(2, 21)  # Start from 2 components (minimum required for silhouette score)\nsilhouette_scores = []\n\nfor n_components in n_components_range:\n    gmm = GaussianMixture(n_components=n_components, random_state=0, init_params='kmeans')\n    gmm.fit(pca_axes[:, 0:2256])\n    # print(f'# comp: {n_components}')\n    labels = gmm.predict(pca_axes[:, 0:2256])\n    silhouette_avg = silhouette_score(pca_axes[:, 0:2256], labels)\n    silhouette_scores.append(silhouette_avg)\n\nplt.plot(n_components_range, silhouette_scores, marker='o', linestyle='-')\nplt.xlabel('Number of Components')\nplt.ylabel('Silhouette Score')\nplt.title('Silhouette Score Plot for Gaussian Mixture Model')\nplt.xticks(n_components_range)\nplt.grid(True)\nplt.show()\n\n\n\n\n\n\n\n\n\nThe silhouette plot shows that 4, 8 and 9 can be good choices for number of clusters.\nLet’s work with 4, 5, 8 and 9 clusters andd see how these perform.\n\nClusters Analysis\nFirst, let’s write a helper function to plot the t-SNE and to manage some hyper-parameters.\n\n\nCode\ndef tsne_plotter_pca(n_clusters:int, pca_dim:int, perplexity:int = 50):\n\n    gmm = GaussianMixture(n_components=n_clusters, random_state=0, init_params=\"kmeans\")\n    clusters_gmm = gmm.fit_predict(pca_axes[:,0:pca_dim])\n\n    tsne = TSNE(n_components=2, perplexity=perplexity)\n\n    x_tsne = tsne.fit_transform(pca_axes[:,0:pca_dim])\n\n    plt.scatter(x_tsne[:,0], x_tsne[:,1], c=clusters_gmm)\n    plt.xlabel('tSNE 1')\n    plt.ylabel('tSNE 2')\n    plt.title(f\"t-SNE Plot for log2 Transformed Data with GMM\\nwith {pca_dim} PC's, {n_clusters} clusters and perplexity: {perplexity}\")\n    plt.axis('equal')\n    plt.show()\n\n    return clusters_gmm\n\n\n\n\nCode\nres_train = {}\nres_test = {}\n\n\n\nNumber of Clusters: 4Number of Clusters: 5Number of Clusters: 8Number of Clusters: 9\n\n\n\n\nCode\nnp.random.seed(123)\nclust = 4\n\nclusters_gmm = tsne_plotter_pca(n_clusters=clust,\n                    pca_dim=2256,\n                    perplexity=50)    \n    \nX_train, X_test, y_train, y_test = train_test_split(X_sc_transformed, clusters_gmm, test_size=0.2, random_state=42)\n    \nlog_reg = LogisticRegressionCV(cv=10,Cs=[0.01,0.1,1,10],penalty=\"l1\",solver=\"liblinear\",multi_class=\"ovr\")\n\nlog_reg.fit(X_train,y_train)\n\nres_train[\"Cluster \"+str(clust)] = log_reg.score(X_train,y_train)\nres_test[\"Cluster \"+str(clust)] = log_reg.score(X_test,y_test)\n\nprint(f\"Train score: {log_reg.score(X_train,y_train)}\")\nprint(f\"Test score: {log_reg.score(X_test,y_test)}\")\n\n\n\n\n\n\n\n\n\nTrain score: 1.0\nTest score: 0.9903006789524733\n\n\n\n\n\n\nCode\nnp.random.seed(123)\nclust = 5\n\nclusters_gmm = tsne_plotter_pca(n_clusters=clust,\n                    pca_dim=2256,\n                    perplexity=50)    \n    \nX_train, X_test, y_train, y_test = train_test_split(X_sc_transformed, clusters_gmm, test_size=0.2, random_state=42)\n    \nlog_reg = LogisticRegressionCV(cv=10,Cs=[0.01,0.1,1,10],penalty=\"l1\",solver=\"liblinear\",multi_class=\"ovr\")\n\nlog_reg.fit(X_train,y_train)\n\nres_train[\"Cluster \"+str(clust)] = log_reg.score(X_train,y_train)\nres_test[\"Cluster \"+str(clust)] = log_reg.score(X_test,y_test)\n\nprint(f\"Train score: {log_reg.score(X_train,y_train)}\")\nprint(f\"Test score: {log_reg.score(X_test,y_test)}\")\n\n\n\n\n\n\n\n\n\nTrain score: 0.9997574581615328\nTest score: 0.9408341416100873\n\n\n\n\n\n\nCode\nnp.random.seed(123)\nclust = 8\n\nclusters_gmm = tsne_plotter_pca(n_clusters=clust,\n                    pca_dim=2256,\n                    perplexity=50)    \n    \nX_train, X_test, y_train, y_test = train_test_split(X_sc_transformed, clusters_gmm, test_size=0.2, random_state=42)\n    \nlog_reg = LogisticRegressionCV(cv=10,Cs=[0.01,0.1,1,10],penalty=\"l1\",solver=\"liblinear\",multi_class=\"ovr\")\n\nlog_reg.fit(X_train,y_train)\n\nres_train[\"Cluster \"+str(clust)] = log_reg.score(X_train,y_train)\nres_test[\"Cluster \"+str(clust)] = log_reg.score(X_test,y_test)\n\nprint(f\"Train score: {log_reg.score(X_train,y_train)}\")\nprint(f\"Test score: {log_reg.score(X_test,y_test)}\")\n\n\n\n\n\n\n\n\n\nTrain score: 0.9997574581615328\nTest score: 0.9369544131910766\n\n\n\n\n\n\nCode\nnp.random.seed(123)\nclust = 9\n\nclusters_gmm = tsne_plotter_pca(n_clusters=clust,\n                    pca_dim=2256,\n                    perplexity=50)    \n    \nX_train, X_test, y_train, y_test = train_test_split(X_sc_transformed, clusters_gmm, test_size=0.2, random_state=42)\n    \nlog_reg = LogisticRegressionCV(cv=10,Cs=[0.01,0.1,1,10],penalty=\"l1\",solver=\"liblinear\",multi_class=\"ovr\")\n\nlog_reg.fit(X_train,y_train)\n\nres_train[\"Cluster \"+str(clust)] = log_reg.score(X_train,y_train)\nres_test[\"Cluster \"+str(clust)] = log_reg.score(X_test,y_test)\n\nprint(f\"Train score: {log_reg.score(X_train,y_train)}\")\nprint(f\"Test score: {log_reg.score(X_test,y_test)}\")\n\n\n\n\n\n\n\n\n\nTrain score: 0.9980596652922629\nTest score: 0.933074684772066\n\n\n\n\n\n\n\nCode\nplt.plot([4,5,8,9], list(res_train.values()),c=\"r\",label=\"Train\")\nplt.plot([4,5,8,9], list(res_test.values()),c=\"b\", label=\"Test\")\nplt.legend()\nplt.show()\n\n\n\n\n\n\n\n\n\nWe can see that the best train and test score achieved was using 4 clusters.\nNow, working only with four clusters we can see the effect on the clustering choosing different number of PC’s to build the t-SNE plot.\n\nEffect of PC’s on t-SNE\nWe cann choose the number of PC’s based on percentage of variance explained. LEt’s work with three values: 50, 70 and 90.\n\n\nCode\npercentages_to_test = [0.5, 0.7, 0.9]\n\npcs_to_test = [np.where(csum &gt;= i)[0][0] for i in percentages_to_test]\n\npcs_to_test\n\n\n[90, 811, 2256]\n\n\n\n\nCode\nnp.random.seed(123)\n\nfor pcas in pcs_to_test:\n    \n    tsne_plotter_pca(n_clusters=4, pca_dim=pcas, perplexity=50)\n    \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn practice, the analysis of scRNA-Seq data involves additional steps before and after the dimention reduction. For example, filtering and normalizing, validate the clusters with especific genes (this is because cell types have a specific expression of certain genes and we can identify these cell types with the gene expression related to the cluster) and do downstream analysis like differential gene expression per cell type, gene-set analysis per cell type and more advanced analysis like cell-cell communiation analysis."
  },
  {
    "objectID": "bioinformatics.html",
    "href": "bioinformatics.html",
    "title": "Bioinformatics Projects",
    "section": "",
    "text": "The analysis of RNA-Seq data involves two distinct parts. The first one needs the use of servers or HPC (high performance computers) and has to do with quality control. pre-processing, alignment-mapping (usually with the STAR software) and counting (can be done using RSEM software). The second one is called downstream analysis and this part involves differential gene expression, gene sets analysis, etc. To see how to do the downstream analysis click here\n\n\n\n\n\n\nNetwork analysis of genes and ontologies\n\n\n\n\n\n\n\n\n\n\nMethylated DNA between Cancer and Normal\n\n\n\n\n\nEpigenetics is the study of how your behaviors and environment can cause changes that affect the way your genes work. Unlike genetic changes, epigenetic changes are reversible and do not change your DNA sequence, but they can change how your body reads a DNA sequence (CDC,2024). To learn how to analyze 450k Illumina Arrays and Whole Genome Bisulfite Sequencing data click here\n\n\n\n\n\nIn recent years the integration of Omics data has become important to understand the biological procesess more broadly. To learn how to use the GWAS Catalog with ChIP-Seq data or how to retrieve and analyze data from The Cancer Genome Atlas (TCGA) click here\n\n\n\n\n\n\nNumber of predited mutation effect per gene\n\n\n\n\n\n\n\n\n\n\nKEGG\n\n\n\n\n\nAn example of a proper use of interactive plots on a RNA-Seq data report can be founded here.\n\nThis repository doesn’t have any code, is only to showcase what is possible using Quarto and Bioconductor\n\n\n\n\n\n\nNetwork analysis of genes and ontologies\nMethylated DNA between Cancer and Normal\nNumber of predited mutation effect per gene\nKEGG"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Piero Palacios",
    "section": "",
    "text": "Hi! My name is Piero, and I’m a Biologist (with main formation in biotechnology) from Peru. I have specializations in data analysis and bioinformatics from Harvard University and MIT. Also, I love writing reproducible interactive reports using Quarto as a hobby.\nWithin my bioinformatic experience you can find RNA-Seq, Methyl-Seq, WGBS-Seq, Illumina Methylation Array and Multi-omics analyses. Also, I have experience on machine learning (OLS, ridge and lasso regression, SVM, Kernels, collaborative filtering, network analysis, high-dimensional reduction, etc) and deep learning models (Feed forward NN, Recurrent NN, Convolutional NN, Graph NN, Transformers, etc)."
  },
  {
    "objectID": "posts/Regression_and_Gradient_Descent/regression_and_gradient_descent.html",
    "href": "posts/Regression_and_Gradient_Descent/regression_and_gradient_descent.html",
    "title": "Likelihood Ratio Test, Regression and Gradient Descent",
    "section": "",
    "text": "Code\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport scipy as sc\nimport seaborn as sns\n\n\nThe file gamma-ray.csv contains a small quantity of data collected from the Compton Gamma Ray Observatory, a satellite launched by NASA in 1991 (http://cossc.gsfc.nasa.gov/). For each of 100 sequential time intervals of variable lengths (given in seconds), the number of gamma rays originating in a particular area of the sky was recorded.\nFor this analysis, we would like to check the assumption that the emission rate is constant.\nFirst, let’s check the distribution of the number of gamma rays\n\n\nCode\ndf = pd.read_csv(\"gamma-ray.csv\", sep=\",\")\n\nsns.set_theme(style=\"darkgrid\")\nsns.displot(df,x=\"count\")\n\n\n\n\n\n\n\n\n\nThe number of these gamma rays is discrete and non-negative. We can assume that the gamma rays emerge independently of one another, and at constant rate in each time interval. Based on this assumption, a Poisson model is a good model assumption. Each observation \\(G_i\\) follows a poisson distribution with rate \\(\\lambda_i\\) times the time interval \\(t_i\\).\n\\[G_i \\thicksim Poisson(\\lambda_i * t_i)\\]\nTHe hypothesis that we wanna test is that the emission rate is constat so:\n\\(H_0: \\lambda_0 = \\lambda_1 = ... = \\lambda_{99}\\)\nAnd the alternative hypothesis is that the emisison rates are different:\n\\(H_A: \\lambda_i \\neq \\lambda_j\\) for some i and j\nThe most plausible parameter for \\(\\lambda\\) under the null hypothesis is the maximun likelihood estimator (MLE).\nGiven the poisson distribution, the derivation goes as follows:\n\\[f(G_0,G_1,...,G_{99} | \\lambda) = \\prod_{i=0}^{99} \\frac{e^{-\\lambda*t_i}*(\\lambda*t_i)^{G_i}}{G_i!}\\]\n\\[ln(f) = -\\lambda \\sum_{i=0}^{99} t_i + ln(\\lambda) \\sum_{i=0}^{99} G_i + ln(\\prod_{i=0}^{99} t_i^{G_i})) - ln(\\prod_{i=0}^{99} G_i!)\\]\nThen, we derivate w.r.t parameter \\(\\lambda\\) and set the derivative to 0 to find the optimal \\(\\lambda\\).\n\\[0 = -\\sum_{i=0}^{99}t_i + \\sum_{i=0}^{99} \\frac{G_i}{\\lambda}\\]\n\\[\\hat{\\lambda} = \\frac{\\sum_{i=0}^{99} G_i}{\\sum_{i=0}^{99} t_i}\\]\n\n\nCode\nlambda_null = df[\"count\"].sum() / df[\"seconds\"].sum()\n\nlambda_null\n\n\n0.0038808514969907496\n\n\nSimilarly, we can calculate a plausible value for the alternative hypothesis with MLE.\n\\[ln(f) = -\\sum_{i=0}^{99} \\lambda_i*t_i + \\sum_{i=0}^{99} G_i*ln(\\lambda_i) + ln(\\prod_{i=0}^{99} G_i*ln(t_i)) - ln(\\prod_{i=0}^{99} G_i!)\\]\nWE take the partial derivative w.r.t each parameter \\(\\lambda_i\\) to find the optimal \\(\\lambda_i\\)\n\\[0 = -t_i + \\frac{G_i}{\\lambda_i}\\]\n\\[\\hat{\\lambda_i} = \\frac{G_i}{t_i}\\]\n\n\nCode\nlambdas_alt = df[\"count\"]/df[\"seconds\"]\n\nlambdas_alt\n\n\n0     0.000000\n1     0.000000\n2     0.000000\n3     0.000000\n4     0.009804\n        ...   \n95    0.025840\n96    0.000000\n97    0.000000\n98    0.000000\n99    0.000000\nLength: 100, dtype: float64\n\n\nNow to test these hypotheses, we are gonna use the likelihood ratio test:\n\\[\\Lambda(x) = -2ln(\\frac{argmax f(G_0,G_1,...,G_{99}| \\lambda)}{argmax f(G_0,G_1,...,G_{99}| \\lambda_0,...,\\lambda_{99})})\\]\nwhich asymptotic distribution \\(X_{100-1 = 99}^{2}\\)\n\n\nCode\nlh_null = sc.stats.poisson.pmf(k=df[\"count\"], mu=lambda_null)\n\nlh_alt = sc.stats.poisson.pmf(k=df[\"count\"], mu=lambdas_alt)\n\nllh_test = -2*np.log(lh_null.prod() / lh_alt.prod())\n\nllh_test\n\n\n104.33272117042188\n\n\nWe can see the distribution of the chi-squared pdf at 99 degrees of freedom\n\n\nCode\nplot_Xs = np.arange(50,150,0.1)\nplt.plot(plot_Xs, sc.stats.chi2.pdf(plot_Xs, 99))\nplt.show()\n\n\n\n\n\n\n\n\n\nAnd see the value that give a p-value of 0.05\n\n\nCode\n# We can calculate the Lambda that would give a p-value of 0.05 by using the inverse survival function\nsc.stats.chi2.isf(0.05, 99)\n\n\n123.22522145336181\n\n\nCalculating our p-value:\n\n\nCode\npvalue = sc.stats.chi2.sf(llh_test, 99)\nprint(pvalue)\n\n\n0.337398546433923\n\n\nWe can conclude that we cannot reject our null hypothesis, emission rate of gamma rays appear to be constant."
  },
  {
    "objectID": "posts/Regression_and_Gradient_Descent/regression_and_gradient_descent.html#likelihood-ratio-test",
    "href": "posts/Regression_and_Gradient_Descent/regression_and_gradient_descent.html#likelihood-ratio-test",
    "title": "Likelihood Ratio Test, Regression and Gradient Descent",
    "section": "",
    "text": "Code\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport scipy as sc\nimport seaborn as sns\n\n\nThe file gamma-ray.csv contains a small quantity of data collected from the Compton Gamma Ray Observatory, a satellite launched by NASA in 1991 (http://cossc.gsfc.nasa.gov/). For each of 100 sequential time intervals of variable lengths (given in seconds), the number of gamma rays originating in a particular area of the sky was recorded.\nFor this analysis, we would like to check the assumption that the emission rate is constant.\nFirst, let’s check the distribution of the number of gamma rays\n\n\nCode\ndf = pd.read_csv(\"gamma-ray.csv\", sep=\",\")\n\nsns.set_theme(style=\"darkgrid\")\nsns.displot(df,x=\"count\")\n\n\n\n\n\n\n\n\n\nThe number of these gamma rays is discrete and non-negative. We can assume that the gamma rays emerge independently of one another, and at constant rate in each time interval. Based on this assumption, a Poisson model is a good model assumption. Each observation \\(G_i\\) follows a poisson distribution with rate \\(\\lambda_i\\) times the time interval \\(t_i\\).\n\\[G_i \\thicksim Poisson(\\lambda_i * t_i)\\]\nTHe hypothesis that we wanna test is that the emission rate is constat so:\n\\(H_0: \\lambda_0 = \\lambda_1 = ... = \\lambda_{99}\\)\nAnd the alternative hypothesis is that the emisison rates are different:\n\\(H_A: \\lambda_i \\neq \\lambda_j\\) for some i and j\nThe most plausible parameter for \\(\\lambda\\) under the null hypothesis is the maximun likelihood estimator (MLE).\nGiven the poisson distribution, the derivation goes as follows:\n\\[f(G_0,G_1,...,G_{99} | \\lambda) = \\prod_{i=0}^{99} \\frac{e^{-\\lambda*t_i}*(\\lambda*t_i)^{G_i}}{G_i!}\\]\n\\[ln(f) = -\\lambda \\sum_{i=0}^{99} t_i + ln(\\lambda) \\sum_{i=0}^{99} G_i + ln(\\prod_{i=0}^{99} t_i^{G_i})) - ln(\\prod_{i=0}^{99} G_i!)\\]\nThen, we derivate w.r.t parameter \\(\\lambda\\) and set the derivative to 0 to find the optimal \\(\\lambda\\).\n\\[0 = -\\sum_{i=0}^{99}t_i + \\sum_{i=0}^{99} \\frac{G_i}{\\lambda}\\]\n\\[\\hat{\\lambda} = \\frac{\\sum_{i=0}^{99} G_i}{\\sum_{i=0}^{99} t_i}\\]\n\n\nCode\nlambda_null = df[\"count\"].sum() / df[\"seconds\"].sum()\n\nlambda_null\n\n\n0.0038808514969907496\n\n\nSimilarly, we can calculate a plausible value for the alternative hypothesis with MLE.\n\\[ln(f) = -\\sum_{i=0}^{99} \\lambda_i*t_i + \\sum_{i=0}^{99} G_i*ln(\\lambda_i) + ln(\\prod_{i=0}^{99} G_i*ln(t_i)) - ln(\\prod_{i=0}^{99} G_i!)\\]\nWE take the partial derivative w.r.t each parameter \\(\\lambda_i\\) to find the optimal \\(\\lambda_i\\)\n\\[0 = -t_i + \\frac{G_i}{\\lambda_i}\\]\n\\[\\hat{\\lambda_i} = \\frac{G_i}{t_i}\\]\n\n\nCode\nlambdas_alt = df[\"count\"]/df[\"seconds\"]\n\nlambdas_alt\n\n\n0     0.000000\n1     0.000000\n2     0.000000\n3     0.000000\n4     0.009804\n        ...   \n95    0.025840\n96    0.000000\n97    0.000000\n98    0.000000\n99    0.000000\nLength: 100, dtype: float64\n\n\nNow to test these hypotheses, we are gonna use the likelihood ratio test:\n\\[\\Lambda(x) = -2ln(\\frac{argmax f(G_0,G_1,...,G_{99}| \\lambda)}{argmax f(G_0,G_1,...,G_{99}| \\lambda_0,...,\\lambda_{99})})\\]\nwhich asymptotic distribution \\(X_{100-1 = 99}^{2}\\)\n\n\nCode\nlh_null = sc.stats.poisson.pmf(k=df[\"count\"], mu=lambda_null)\n\nlh_alt = sc.stats.poisson.pmf(k=df[\"count\"], mu=lambdas_alt)\n\nllh_test = -2*np.log(lh_null.prod() / lh_alt.prod())\n\nllh_test\n\n\n104.33272117042188\n\n\nWe can see the distribution of the chi-squared pdf at 99 degrees of freedom\n\n\nCode\nplot_Xs = np.arange(50,150,0.1)\nplt.plot(plot_Xs, sc.stats.chi2.pdf(plot_Xs, 99))\nplt.show()\n\n\n\n\n\n\n\n\n\nAnd see the value that give a p-value of 0.05\n\n\nCode\n# We can calculate the Lambda that would give a p-value of 0.05 by using the inverse survival function\nsc.stats.chi2.isf(0.05, 99)\n\n\n123.22522145336181\n\n\nCalculating our p-value:\n\n\nCode\npvalue = sc.stats.chi2.sf(llh_test, 99)\nprint(pvalue)\n\n\n0.337398546433923\n\n\nWe can conclude that we cannot reject our null hypothesis, emission rate of gamma rays appear to be constant."
  },
  {
    "objectID": "posts/Regression_and_Gradient_Descent/regression_and_gradient_descent.html#regression-and-gradient-descent",
    "href": "posts/Regression_and_Gradient_Descent/regression_and_gradient_descent.html#regression-and-gradient-descent",
    "title": "Likelihood Ratio Test, Regression and Gradient Descent",
    "section": "Regression and Gradient Descent",
    "text": "Regression and Gradient Descent\n\nRegression\nWe are gonna use a dataset from General Motors about mortality. This data is from 59 US cities where it was studied the contribution of air pollution to mortality.\nThe dependen variable is the age adjusted mortality (Mortality). Also, the data includes variables measuring climate characteristics (JanTemp, JulyTemp, RelHum, Rain), demographic characteristics of the cities (Educ, Dens, NonWhite, WhiteCollar, Pop, House, Income), and variables recording the pollution potential of three diferent air pollutants (HC, NOx, SO2).\nLet’s load the data:\n\n\nCode\ndf = pd.read_csv(\"mortality.csv\", sep=\",\")\ndf.head()\n\n\n\n\n\n\n\n\n\nCity\nMortality\nJanTemp\nJulyTemp\nRelHum\nRain\nEduc\nDens\nNonWhite\nWhiteCollar\nPop\nHouse\nIncome\nHC\nNOx\nSO2\n\n\n\n\n0\nAkron, OH\n921.87\n27\n71\n59\n36\n11.4\n3243\n8.8\n42.6\n660328\n3.34\n29560\n21\n15\n59\n\n\n1\nAlbany-Schenectady-Troy, NY\n997.87\n23\n72\n57\n35\n11.0\n4281\n3.5\n50.7\n835880\n3.14\n31458\n8\n10\n39\n\n\n2\nAllentown, Bethlehem,PA-NJ\n962.35\n29\n74\n54\n44\n9.8\n4260\n0.8\n39.4\n635481\n3.21\n31856\n6\n6\n33\n\n\n3\nAtlanta, GA\n982.29\n45\n79\n56\n47\n11.1\n3125\n27.1\n50.2\n2138231\n3.41\n32452\n18\n8\n24\n\n\n4\nBaltimore, MD\n1071.29\n35\n77\n55\n43\n9.6\n6441\n24.4\n43.7\n2199531\n3.44\n32368\n43\n38\n206\n\n\n\n\n\n\n\nLet’s write two helper function that adds the intercept to the data and perform the ordinary least squares estimation based on the formula:\n\\[\\hat{\\beta}=(X^{T}X)^{-1}X^{T}y\\]\n\n\nCode\ndef add_intercept(X: np.array):\n  return np.concatenate((np.ones_like(X[:,:1]), X), axis=1)\n\ndef OLS(X: np.array, y: np.array):\n  return np.linalg.inv(X.T.dot(X)).dot(X.T.dot(y))\n\n\nAlso we need to declare the matrix X and the dependent variable y and convert them to numpy objects.\n\n\nCode\ny = df[\"Mortality\"]\nX = df.loc[:,\"JanTemp\":\"SO2\"]\n\n# Now lets add the intercept to X\n\nX = X.to_numpy()\ny = y.to_numpy()\n\n\nNow, can calculate the betas:\n\n\nCode\nbetas = OLS(add_intercept(X), y)\n\nbetas\n\n\narray([ 1.40003471e+03, -1.44112034e+00, -2.95025005e+00,  1.36009551e-01,\n        9.69507928e-01, -1.10466624e+01,  4.71706516e-03,  5.30271368e+00,\n       -1.49231882e+00,  3.40228581e-06, -3.80416445e+01, -4.25186359e-04,\n       -6.71247478e-01,  1.17850768e+00,  8.45829777e-02])\n\n\nGreat! This was an easy way to compute the OLS regression. We also can do the same with sklearn:\n\n\nCode\nfrom sklearn.linear_model import LinearRegression\n\nreg = LinearRegression()\n\nreg.fit(add_intercept(X),y)\n\nprint(reg.intercept_, reg.coef_)\n\n\n1400.0347123466809 [ 0.00000000e+00 -1.44112034e+00 -2.95025005e+00  1.36009551e-01\n  9.69507928e-01 -1.10466624e+01  4.71706516e-03  5.30271368e+00\n -1.49231882e+00  3.40228581e-06 -3.80416445e+01 -4.25186359e-04\n -6.71247478e-01  1.17850768e+00  8.45829777e-02]\n\n\n\n\nGradient Descent\nWe also can do the regression task via optimization with the gradient descent algorithm. Let’s write some helper functions that will helps us to do the gradient descent algorithm.\n\n\nCode\ndef loss_fn(beta, X, y):\n  # (y - X beta)^T (y - X beta)\n  return np.sum(np.square(y - X.dot(beta)))\n\ndef loss_grad(beta, X, y):\n  # -2*(y - X beta)^T X\n  return -2*(y - X.dot(beta)).T.dot(X)\n\ndef gradient_step(beta, step_size, X, y):\n  loss, grads = loss_fn(beta, X, y), loss_grad(beta, X, y)\n  \n  beta = beta - step_size * grads.T\n  return loss, beta\n\ndef gradient_descent(X, y, step_size, precision, max_iter=10000, warn_max_iter=True):\n  beta = np.zeros_like(X[0])\n  \n  losses = [] # Array for recording the value of the loss over the iterations.\n  graceful = False\n  for _ in range(max_iter):\n    beta_last = beta # Save last values of beta for later stopping criterion\n    loss, beta = gradient_step(beta, step_size, X, y)\n    losses.append(loss)\n    # Use the euclidean norm of the difference between the new beta and the old beta as a stopping criteria\n    if np.sqrt(np.sum(np.square((beta - beta_last)))) &lt; precision:\n      graceful = True\n      break\n  if not graceful and warn_max_iter:\n    print(\"Reached max iterations.\")\n  return beta, np.array(losses)\n\n\nBefore applying the gradient descent, we need to standardize the data because the loss explote due to some outliers. &gt; You can try it without the standardization\n\n\nCode\n# Standardize the data\n\nX_scaled = (X - X.mean(axis=0))/X.std(axis=0, ddof=1)\nY_scaled = (y - y.mean())/y.std(ddof=1)\nX_inter = add_intercept(X_scaled)\n\n# Apply the gradient descent\n\nbeta_gd, losses = gradient_descent(X_inter, Y_scaled, 0.001, 1e-8, max_iter=10000)\nprint(\"BetaHat = {}\".format(beta_gd))\nprint(\"Final loss value = {}\".format(losses[-1]))\nplt.plot(range(len(losses)), losses)\nplt.title(\"Iteration vs Loss\")\nplt.show()\n\n# As a sanity check, we can also do the matrix inversion with OLS\nprint(\"Matrix inverse BetaHat = {}\".format(OLS(X_inter, Y_scaled)))\n\n\n\nReached max iterations.\nBetaHat = [ 9.99200722e-19 -2.34387032e-01 -2.17491727e-01  1.17191047e-02\n  1.79800652e-01 -1.50530629e-01  1.08943031e-01  7.64357603e-01\n -1.21223518e-01  8.40179286e-02 -1.11464155e-01 -3.04603568e-02\n -9.95161696e-01  8.80002697e-01  8.62630571e-02]\nFinal loss value = 13.809259921735789\nMatrix inverse BetaHat = [ 3.21984155e-17 -2.34377091e-01 -2.17496828e-01  1.17238925e-02\n  1.79754504e-01 -1.50544513e-01  1.08945825e-01  7.64348559e-01\n -1.21202349e-01  8.40325965e-02 -1.11479218e-01 -3.04687337e-02\n -9.96190618e-01  8.81043305e-01  8.61146149e-02]\n\n\n\n\n\n\n\n\n\nNote that the betas changed because we standardized the data, thats why at the end we are checking with the OLS function."
  },
  {
    "objectID": "projects.html",
    "href": "projects.html",
    "title": "Data Science Projects",
    "section": "",
    "text": "Analysis of Hyper-parameters on Single Cell RNA-Seq Data\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLikelihood Ratio Test, Regression and Gradient Descent\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAnalysis of Time-series Data\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  }
]